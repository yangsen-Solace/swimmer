/*
==============================================================================
    Solace Corporation
    SOLACE CORPORATION MESSAGING API FOR JAVASCRIPT
    SolclientJS
==============================================================================
    7.2.1.43 - Release
    20170829-1148
------------------------------------------------------------------------------
 Copyright 2009-2016 Solace Corporation. All rights reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy of
 this software and associated documentation files (the "Software"), to use and
 copy the Software, and to permit persons to whom the Software is furnished to
 do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in all
 copies or substantial portions of the Software.

 UNLESS STATED ELSEWHERE BETWEEN YOU AND SOLACE CORPORATION, THE SOFTWARE IS
 PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
 BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
 PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
 BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF
 CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
 SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 http://www.Solace.com

------------------------------------------------------------------------------
*/
if(typeof window.solace==="undefined")var solace={};
(function(a){var h=function(){var b=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,i=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[\-+]\d{4})?)\b/g,k=/[^\-+\dA-Z]/g,m=function(o,s){o=String(o);for(s=s||2;o.length<s;)o="0"+o;return o};return function(o,s,d){var j=h;if(arguments.length===1&&Object.prototype.toString.call(o)==="[object String]"&&!/\d/.test(o)){s=o;o=undefined}o=o?new Date(o):new Date;if(isNaN(o))throw new SyntaxError("invalid date");
s=String(j.masks[s]||s||j.masks["default"]);if(s.slice(0,4)==="UTC:"){s=s.slice(4);d=true}var e=d?"getUTC":"get",f=o[e+"Date"](),l=o[e+"Day"](),c=o[e+"Month"](),g=o[e+"FullYear"](),n=o[e+"Hours"](),p=o[e+"Minutes"](),q=o[e+"Seconds"]();e=o[e+"Milliseconds"]();var u=d?0:o.getTimezoneOffset(),t={d:f,dd:m(f),ddd:j.i18n.dayNames[l],dddd:j.i18n.dayNames[l+7],m:c+1,mm:m(c+1),mmm:j.i18n.monthNames[c],mmmm:j.i18n.monthNames[c+12],yy:String(g).slice(2),yyyy:g,h:n%12||12,hh:m(n%12||12),H:n,HH:m(n),M:p,MM:m(p),
s:q,ss:m(q),l:m(e,3),L:m(e>99?Math.round(e/10):e),t:n<12?"a":"p",tt:n<12?"am":"pm",T:n<12?"A":"P",TT:n<12?"AM":"PM",Z:d?"UTC":(String(o).match(i)||[""]).pop().replace(k,""),o:(u>0?"-":"+")+m(Math.floor(Math.abs(u)/60)*100+Math.abs(u)%60,4),S:["th","st","nd","rd"][f%10>3?0:(f%100-f%10!==10)*f%10]};return s.replace(b,function(r){return t.hasOwnProperty(r)?t[r]:r.slice(1,r.length-1)})}}();h.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",
fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};h.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August",
"September","October","November","December"]};Date.prototype.format=function(b,i){return h(this,b,i)};if(!Array.prototype.indexOf)Array.prototype.indexOf=function(b,i){for(var k=i||0;k<this.length;k++)if(this[k]===b)return k;return-1};if(!Array.prototype.map)Array.prototype.map=function(b,i){for(var k=[],m=0,o=this.length;m<o;m++)if(m in this)k[m]=b.call(i,this[m],m,this);return k};a.Convert=function(){var b=String.fromCharCode(0,0,0),i=String.fromCharCode(0,0);return{int8ToStr:function(k){return String.fromCharCode(k&
255)},int16ToStr:function(k){return String.fromCharCode(k>>8&255)+String.fromCharCode(k&255)},int24ToStr:function(k){return String.fromCharCode(k>>16&255)+String.fromCharCode(k>>8&255)+String.fromCharCode(k&255)},int32ToStr:function(k){return k>=0&&k<256?b+String.fromCharCode(k):k>=0&&k<65536?i+String.fromCharCode(k>>8)+String.fromCharCode(k&255):String.fromCharCode(k>>24&255)+String.fromCharCode(k>>16&255)+String.fromCharCode(k>>8&255)+String.fromCharCode(k&255)},byteArrayToStr:function(k){var m=
k.length;if(m<8192)return String.fromCharCode.apply(null,k);else{for(var o=0,s="";o<m;){s+=String.fromCharCode.apply(null,k.slice(o,o+8192));o+=8192}return s}},strToByteArray:function(k){for(var m=[],o=0;o<k.length;o++)m[o]=k.charCodeAt(o);return m},strToHexArray:function(k){return Array.prototype.map.call(k.split(""),function(m){return m.charCodeAt(0).toString(16)})},strToInt8:function(k){return k.charCodeAt(0)&255},strToInt16:function(k){return(k.charCodeAt(0)<<8)+k.charCodeAt(1)},strToInt24:function(k){return(k.charCodeAt(0)<<
16)+(k.charCodeAt(1)<<8)+k.charCodeAt(2)},strToInt32:function(k){return(k.charCodeAt(0)<<24)+(k.charCodeAt(1)<<16)+(k.charCodeAt(2)<<8)+k.charCodeAt(3)},strToUInt32:function(k){return k.charCodeAt(0)*16777216+(k.charCodeAt(1)<<16)+(k.charCodeAt(2)<<8)+k.charCodeAt(3)}}}();a.Base64=function(){var b=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,99,-1,-1,99,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,99,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,
3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];return{encode:function(i){var k="",m,o,s,d,j,e,f=0;do{m=i.charCodeAt(f++);o=i.charCodeAt(f++);s=i.charCodeAt(f++);d=m>>2;m=(m&3)<<4|o>>4;j=(o&15)<<2|s>>6;e=s&63;if(isNaN(o))j=e=64;else if(isNaN(s))e=64;k=k+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(j)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)}while(f<
i.length);return k},decode:function(i){var k="",m,o,s,d,j,e=0;do{for(;b[i.charCodeAt(e)]>64;)e++;m=b[i.charCodeAt(e++)];o=b[i.charCodeAt(e++)];d=b[i.charCodeAt(e++)];j=b[i.charCodeAt(e++)];if(m<0||o<0||d<0||j<0)throw new a.TransportError("Invalid base64 character in data stream",a.TransportSessionEventCode.DATA_DECODE_ERROR);m=m<<2|o>>4;o=(o&15)<<4|d>>2;s=(d&3)<<6|j;k+=String.fromCharCode(m);if(d!==64)k+=String.fromCharCode(o);if(j!==64)k+=String.fromCharCode(s)}while(e<i.length-3);return k}}}();
if(window.atob&&window.btoa){a.base64_encode=function(b){return window.btoa(b)};a.base64_decode=function(b){return window.atob(b)}}else{a.base64_encode=a.Base64.encode;a.base64_decode=a.Base64.decode}a.ObjectUtil=function(){var b=function(){try{if(Object.defineProperty){var i=function(o,s,d){Object.defineProperty(o,s,{configurable:false,enumerable:true,writable:false,value:d});return o},k=i({},"testProp",false);if(typeof k.testProp==="undefined"||k.testProp!==false)throw Error("Property definition failed");
return i}}catch(m){}return function(o,s,d){o[s]=d;return o}}();return b({},"defineReadOnlyProperty",b)}();a.TopicUtil=function(){return{toSafeChars:function(b){return b=b.replace(/[^a-zA-Z0-9_\/.]/g,"")},validateTopic:function(b){if(typeof b!=="string")return"topicName must be a string.";var i=b.length;if(i<1)return"Topic too short (must be >= 1 character).";else if(i>250)return"Topic too long (must be <= 250 characters).";for(var k=0;k<i;k++){var m=b.charAt(k);if(m==="/"){if(k===0||k===i-1||b.charAt(k-
1)==="/")return"Topic has empty level."}else if(m==="*"&&k<i-1)if(b.charAt(k+1)!=="/")return"Topic has illegal wildcard."}return null},isWildcarded:function(b){var i=b.length;if(b===">")return true;else if(i>=2&&b.charAt(i-2)==="/"&&b.charAt(i-1)===">")return true;else if(b.indexOf("*",0)!==-1)return true;return false}}}();a.EnumUtil=function(){return{name:function(b,i){for(var k in b)if(b.hasOwnProperty(k))if(i===b[k])return k;return null}}}();a.StringBuffer=function(){this.buffer=[];arguments.length===
1&&this.buffer.push(arguments[0])};a.StringBuffer.prototype.append=function(b){typeof b!=="undefined"&&this.buffer.push(b);return this};a.StringBuffer.prototype.toString=function(){return this.buffer.join("")};a.StringUtil=function(){function b(i,k,m,o){if(typeof i==="string")if(i.length<k){var s=" ";if(typeof o==="string"&&o.length===1)s=o;o=new a.StringBuffer;for(var d=0;d<k-i.length;d++)o.append(s);switch(m){case 0:return o.toString()+i;case 1:return i+o.toString()}}return i}return{padLeft:function(i,
k,m){return b(i,k,0,m)},padRight:function(i,k,m){return b(i,k,1,m)},notEmpty:function(i){return typeof i!=="undefined"&&i!==null&&i.length>0},formatDumpBytes:function(i,k,m){if(!this.notEmpty(i))return null;for(var o=[],s=[],d=[],j=0,e=function(){for(var g=[],n=0;n<256;n++)g[n]=n<33||n>126?".":String.fromCharCode(n);return g}(),f=0,l=i.length;f<l;f++){var c=i.charCodeAt(f);d.push(this.padLeft(c.toString(16),2,"0"));d.push(" ");s.push(e[c]||".");j++;j===8&&d.push("   ");if(j===16||f===i.length-1){m>
0&&o.push(this.padRight("",m," "));o.push(this.padRight(d.join(""),54," "));k&&o.push(s.join(""));o.push("\n");d=[];s=[];j=0}}return o.join("")}}}();a.Version=function(){var b={};a.ObjectUtil.defineReadOnlyProperty(b,"version","7.2.1.43");a.ObjectUtil.defineReadOnlyProperty(b,"date","20170829-1148");a.ObjectUtil.defineReadOnlyProperty(b,"mode","Release");a.ObjectUtil.defineReadOnlyProperty(b,"summary",["SolclientJS",b.version,b.mode,b.date].join(", "));a.ObjectUtil.defineReadOnlyProperty(b,
"toString",function(){return b.summary});return b}();a.makeIterator=function(b,i,k){if(i===undefined)i=0;if(k===undefined)k=b.length;return{deref:function(){return b[i]},incr:function(){++i},end:function(){return i>=k}}};a.extend=function(b,i){function k(){}k.prototype=b.prototype;i.prototype=new k;i.prototype.constructor=i}})(solace);
var detected_console=typeof this.global!=="undefined"&&this.global?this.global.console:typeof this.window!=="undefined"&&this.window?typeof this.window.console!=="undefined"?this.window.console:null:null;
(function(a,h){a.ErrorSubcode={UNKNOWN_ERROR:999,SESSION_NOT_CONNECTED:2,INVALID_SESSION_OPERATION:3,TIMEOUT:4,MESSAGE_VPN_NOT_ALLOWED:5,MESSAGE_VPN_UNAVAILABLE:6,CLIENT_USERNAME_IS_SHUTDOWN:7,DYNAMIC_CLIENTS_NOT_ALLOWED:8,CLIENT_NAME_ALREADY_IN_USE:9,CLIENT_NAME_INVALID:10,CLIENT_DELETE_IN_PROGRESS:11,TOO_MANY_CLIENTS:12,LOGIN_FAILURE:13,INVALID_VIRTUAL_ADDRESS:14,CLIENT_ACL_DENIED:15,SUBSCRIPTION_ACL_DENIED:16,PUBLISH_ACL_DENIED:17,PARAMETER_OUT_OF_RANGE:18,PARAMETER_CONFLICT:19,PARAMETER_INVALID_TYPE:20,
INTERNAL_ERROR:21,INSUFFICIENT_SPACE:22,OUT_OF_RESOURCES:23,PROTOCOL_ERROR:24,COMMUNICATION_ERROR:25,KEEP_ALIVE_FAILURE:26,TOPIC_MISSING:28,INVALID_TOPIC_SYNTAX:31,MESSAGE_TOO_LARGE:32,XML_PARSE_ERROR:33,SUBSCRIPTION_ALREADY_PRESENT:34,SUBSCRIPTION_NOT_FOUND:35,SUBSCRIPTION_INVALID:36,SUBSCRIPTION_ERROR_OTHER:37,SUBSCRIPTION_TOO_MANY:38,SUBSCRIPTION_ATTRIBUTES_CONFLICT:39,NO_LOCAL_NOT_SUPPORTED:40,DATA_ERROR_OTHER:42,CREATE_XHR_FAILED:43,INTERNAL_CONNECTION_ERROR:44,DATA_DECODE_ERROR:45,INACTIVITY_TIMEOUT:46,
UNKNOWN_TRANSPORT_SESSION_ID:47,AD_MESSAGING_NOT_SUPPORTED:48,CREATE_WEBSOCKET_FAILED:49,REPLICATION_IS_STANDBY:50};a.TransportSessionEventCode={UP_NOTICE:1,DESTROYED_NOTICE:2,CONNECTING:3,CAN_ACCEPT_DATA:4,DATA_DECODE_ERROR:5,PARSE_FAILURE:6,CONNECTION_ERROR:7,NOTIFY_GOT_TOKEN:8};a.SessionEventCode={UP_NOTICE:1,DOWN_ERROR:2,CONNECT_FAILED_ERROR:3,CONNECTING:4,REJECTED_MESSAGE_ERROR:5,SUBSCRIPTION_ERROR:6,SUBSCRIPTION_OK:7,VIRTUALROUTER_NAME_CHANGED:8,REQUEST_ABORTED:9,REQUEST_TIMEOUT:10,PROPERTY_UPDATE_OK:11,
PROPERTY_UPDATE_ERROR:12,REAPPLY_SUBSCRIPTION_ERROR:13,CAN_ACCEPT_DATA:14,DISCONNECTED:15,LOGIN_FAILURE:16,P2P_SUB_ERROR:17,PARSE_FAILURE:18,DATA_DECODE_ERROR:19,KEEP_ALIVE_ERROR:20,INTERNAL_ERROR:21};a.SessionEventCodeDescription=function(){var b=[],i;for(i in a.SessionEventCode)if(a.SessionEventCode.hasOwnProperty(i))b[a.SessionEventCode[i]]=i;return b}();a.InternalSessionStateDescription=function(){var b=[];b[0]="NEW";b[1]="DISCONNECTED";b[2]="WAITING_FOR_TRANSPORT_UP";b[3]="TRANSPORT_SESSION_UP";
b[4]="WAITING_FOR_LOGIN";b[5]="LOGIN_COMPLETE";b[6]="WAITING_FOR_P2PINBOX_REG";b[7]="P2PINBOX_REG_COMPLETE";b[8]="CONNECTED";b[9]="SESSION_ERROR";b[10]="DISCONNECTING";b[11]="REAPPLYING_SUBSCRIPTIONS";return b}();a.SessionOperationDescription=function(){var b=[];b[0]="CONNECT";b[1]="DISCONNECT";b[2]="LOGIN";b[3]="P2PINBOXREG";b[4]="CTRL";b[5]="SEND";b[6]="REAPPLY_SUBSCRIPTIONS";b[7]="QUERY_OPERATION";return b}();a.TransportReturnCodeDescription=function(){var b=[];b[0]="OK";b[1]="FAIL";b[2]="NO_SPACE";
b[3]="DATA_DECODE_ERROR";b[4]="INVALID_STATE_FOR_OPERATION";b[5]="CONNECTION_ERROR";return b}();a.SessionState={NEW:0,CONNECTING:1,CONNECTED:2,SESSION_ERROR:3,DISCONNECTING:4,DISCONNECTED:5};a.TransportProtocol={HTTP_BASE64:"HTTP_BASE64",HTTP_BINARY:"HTTP_BINARY",HTTP_BINARY_STREAMING:"HTTP_BINARY_STREAMING",WS_BINARY:"WS_BINARY"};a.TransportFamily={HTTP:"HTTP",HTTPS:"HTTPS",WS:"WS",WSS:"WSS"};a.NotImplementedError=function(b){this.name="NotImplementedError";this.message=b||""};a.NotImplementedError.prototype=
Error();a.NotImplementedError.prototype.toString=function(){var b=new a.StringBuffer(this.name);b.append(": ");b.append("message=").append(this.message||"");return b.toString()};a.OperationError=function(b,i,k){this.name="OperationError";this.message=b||"";this.subcode=i;this.reason=k};a.OperationError.prototype=Error();a.OperationError.prototype.toString=function(){var b=new a.StringBuffer;b.append(this.name).append(": ");if(this.name==="OperationError"){b.append("message=").append(this.message||
"").append(", ");b.append("subcode=").append(this.subcode||"").append(", ");b.append("reason=").append(this.reason||"")}else b.append("message=").append(this.message||"");return b.toString()};a.TransportError=function(b,i){this.name="TransportError";this.message=b||"";this.subcode=i};a.TransportError.prototype=Error();a.TransportError.prototype.toString=function(){var b=new a.StringBuffer(this.name);b.append(": ");if(this.name==="TransportError"){b.append("message=").append(this.message||"").append(", ");
b.append("subcode=").append(this.subcode||"")}else b.append("message=").append(this.message||"");return b.toString()};a.SessionProperties=function(){this.virtualRouterName=this.vpnNameInUse=this.vpnName=this.applicationDescription=this.clientName=this.userName=this.password=this.url="";this.connectTimeoutInMsecs=3E4;this.readTimeoutInMsecs=1E4;this.sendBufferMaxSize=65536;this.maxWebPayload=1048576;this.bufferedAmountQueryIntervalInMsecs=100;this.includeSenderId=this.generateReceiveTimestamps=this.generateSendTimestamps=
false;this.keepAliveIntervalInMsecs=3E3;this.keepAliveIntervalsLimit=3;this.userIdentification=this.p2pInboxBase=this.p2pInboxInUse="";this.generateSequenceNumber=false;this.subscriberNetworkPriority=this.subscriberLocalPriority=1;this.ignoreSubscriptionNotFoundError=this.ignoreDuplicateSubscriptionError=true;this.noLocal=this.reapplySubscriptions=false;this.transportProtocolInUse=this.transportProtocol=null;this.transportDowngradeTimeoutInMsecs=1E4;this.transportContentType="text/plain";this.authenticationScheme=
a.AuthenticationScheme.AUTHENTICATION_SCHEME_BASIC};a.SessionProperties.prototype.toString=function(){var b=new a.StringBuffer("\n"),i=true,k;for(k in this)if(this.hasOwnProperty(k))if(k!=="password")if(i){b.append(" {").append(k).append(", ").append(this[k]).append("}");i=false}else b.append(",\n ").append("{").append(k).append(", ").append(this[k]).append(" }");return b.toString()};a.SessionProperties.prototype.clone=function(){var b=new a.SessionProperties,i;for(i in this)if(this.hasOwnProperty(i))b[i]=
this[i];return b};a.SessionProperties.prototype.sol_validate=function(){function b(e){return typeof j[e]!=="undefined"&&j[e]!==null&&(typeof j[e]!=="string"||j[e].length>0)}function i(e){if(typeof j[e]==="undefined"||j[e]===null||j[e]==="")throw new a.OperationError("SessionProperties validation: Property '"+e+"' cannot be empty.",a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);}function k(e,f){if(b(e)&&typeof j[e]==="string"&&j[e].length>f)throw new a.OperationError("SessionProperties validation: Property '"+
e+"' exceeded max length "+f,a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);}function m(e,f,l){if(b(e)&&typeof j[e]==="number"&&(j[e]<f||j[e]>l))throw new a.OperationError("SessionProperties validation: Property '"+e+"' out of range ["+f+"; "+l+"].",a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);}function o(e,f){if(b(e)&&typeof j[e]!==f)throw new a.OperationError("SessionProperties validation: Property '"+e+"' should be type "+f,a.ErrorSubcode.PARAMETER_INVALID_TYPE);}function s(e,f,l){var c=j[e];if(a.EnumUtil.name(a[f],
c)===null&&!(l&&c===null))throw new a.OperationError("SessionProperties validation: Property '"+e+"' must be a member of solace."+f);}function d(e){for(var f=1,l=arguments.length;f<l;f++){var c=arguments[f];switch(c.length){case 1:c[0](e);break;case 2:c[0](e,c[1]);break;case 3:c[0](e,c[1],c[2])}}}var j=this;d("url",[i],[o,"string"]);d("userName",[i],[o,"string"],[k,32]);d("password",[o,"string"],[k,128]);d("clientName",[o,"string"],[k,160],[function(e){if(b(e)&&typeof j[e]==="string"){var f=a.smf.ClientCtrlMessage.validateClientName(j[e]);
if(f)throw new a.OperationError("SessionProperties validation: Property '"+e+"' :"+f,a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);}}]);d("applicationDescription",[o,"string"],[k,254]);d("vpnName",[o,"string"],[k,32]);d("connectTimeoutInMsecs",[o,"number"],[m,1,Number.MAX_VALUE]);d("readTimeoutInMsecs",[o,"number"],[m,1,Number.MAX_VALUE]);d("sendBufferMaxSize",[o,"number"],[m,1,Number.MAX_VALUE]);d("maxWebPayload",[o,"number"],[m,100,Number.MAX_VALUE]);d("bufferedAmountQueryIntervalInMsecs",[o,"number"],
[m,4,Number.MAX_VALUE]);d("generateSendTimestamps",[o,"boolean"]);d("generateReceiveTimestamps",[o,"boolean"]);d("includeSenderId",[o,"boolean"]);d("keepAliveIntervalInMsecs",[o,"number"],[m,100,Number.MAX_VALUE]);d("keepAliveIntervalsLimit",[o,"number"],[m,3,Number.MAX_VALUE]);d("generateSequenceNumber",[o,"boolean"]);d("subscriberLocalPriority",[o,"number"],[m,1,4]);d("subscriberNetworkPriority",[o,"number"],[m,1,4]);d("ignoreDuplicateSubscriptionError",[o,"boolean"]);d("ignoreSubscriptionNotFoundError",
[o,"boolean"]);d("reapplySubscriptions",[o,"boolean"]);d("noLocal",[o,"boolean"]);d("transportProtocol",[s,"TransportProtocol",true]);d("transportDowngradeTimeoutInMsecs",[o,"number"],[m,1,Number.MAX_VALUE]);d("authenticationScheme",[s,"AuthenticationScheme",false])};a.MessageRxCBInfo=function(b,i){this.messageRxCBFunction=b;this.userObject=i};a.SessionEventCBInfo=function(b,i){this.userObject=i;this.sessionEventCBFunction=b};a.SessionEvent=function(b,i,k,m,o,s){this.sessionEventCode=b;this.infoStr=
i;this.responseCode=k;this.errorSubCode=m;this.correlationKey=o;this.reason=s};a.SessionEvent.prototype.toString=function(){var b=new a.StringBuffer("Session event: ");b.append("sessionEventCode=").append(a.SessionEventCodeDescription[this.sessionEventCode]).append(", ");b.append("infoStr=").append(this.infoStr||"").append(", ");b.append("responseCode=").append(this.responseCode||"").append(", ");b.append("errorSubCode=").append(this.errorSubCode||"").append(", ");b.append("correlationKey=").append(this.correlationKey||
"").append(", ");b.append("reason=(").append(this.reason||"").append(")");return b.toString()};a.AuthenticationScheme={AUTHENTICATION_SCHEME_BASIC:"AUTHENTICATION_SCHEME_BASIC",AUTHENTICATION_SCHEME_CLIENT_CERTIFICATE:"AUTHENTICATION_SCHEME_CLIENT_CERTIFICATE"};a.DestinationType={TOPIC:0};a.DestinationTypeDescription=function(){var b=[],i;for(i in a.DestinationType)if(a.DestinationType.hasOwnProperty(i))b[a.DestinationType[i]]=i;return b}();a.Destination=function(b){this.m_name=b;this.m_type=a.DestinationType.TOPIC;
this.m_temporary=false};a.Destination.prototype.isTemporary=function(){return this.m_temporary};a.Destination.prototype.getType=function(){return this.m_type};a.Destination.prototype.getName=function(){return this.m_name};a.Destination.prototype.toString=function(){return this.getName()||"[object Destination]"};a.Topic=function(b){this.m_name=b;this.m_type=a.DestinationType.TOPIC;this.m_temporary=false};a.Topic.prototype=new a.Destination;a.Topic.prototype.getKey=function(){return this.m_name};a.MessageCacheStatus=
{LIVE:0,CACHED:1,SUSPECT:2};a.Message=function(){this.m_binaryMetaChunk=this.m_userData=this.m_xmlMetadata=this.m_xmlContent=this.m_binaryAttachment=null;this.m_redelivered=this.m_elidingEligible=this.m_discardIndication=false;this.m_deliveryMode=a.MessageDeliveryModeType.DIRECT;this.m_deliverToOne=false;this.m_destination=null;this.m_userCos=a.MessageUserCosType.COS1;this.m_correlationId=this.m_applicationMessageType=this.m_applicationMessageId=null;this.m_replyMessage=false;this.m_senderTimestamp=
this.m_senderId=this.m_replyTo=null;this.m_autoSenderTimestamp=false;this.m_sequenceNumber=null;this.m_autoSequenceNumber=false;this.m_receiverTimestamp=this.m_structuredContainer=this.m_userPropertyMap=null;this.m_messageType=a.MessageType.BINARY;this.m_cacheStatus=a.MessageCacheStatus.LIVE;this.m_smfHeader=this.m_cacheRequestId=null};a.Message.prototype.getType=function(){return this.m_messageType};a.Message.prototype.setApplicationMessageId=function(b){if(b!==null&&typeof b!=="string")throw new a.OperationError("Invalid message parameter, expected string.",
a.ErrorSubcode.PARAMETER_INVALID_TYPE);this.m_applicationMessageId=b};a.Message.prototype.getApplicationMessageId=function(){return this.m_applicationMessageId};a.Message.prototype.setApplicationMessageType=function(b){if(b!==null&&typeof b!=="string")throw new a.OperationError("Invalid message parameter, expected string.",a.ErrorSubcode.PARAMETER_INVALID_TYPE);this.m_applicationMessageType=b};a.Message.prototype.getApplicationMessageType=function(){return this.m_applicationMessageType};a.Message.prototype.getBinaryAttachment=
function(){return this.m_binaryAttachment};a.Message.prototype.setBinaryAttachment=function(b){if(b!==null&&typeof b!=="string")throw new a.OperationError("Invalid message parameter, expected string.",a.ErrorSubcode.PARAMETER_INVALID_TYPE);this.m_binaryAttachment=b};a.Message.prototype.getCacheRequestId=function(){return this.m_cacheRequestId};a.Message.prototype.setCacheRequestID=function(b){this.m_cacheRequestId=b};a.Message.prototype.getCorrelationId=function(){return this.m_correlationId};a.Message.prototype.setCorrelationId=
function(b){if(b!==null&&typeof b!=="string")throw new a.OperationError("Invalid message parameter, expected string.",a.ErrorSubcode.PARAMETER_INVALID_TYPE);this.m_correlationId=b};a.Message.prototype.setDeliverToOne=function(b){this.m_deliverToOne=b};a.Message.prototype.isDeliverToOne=function(){return this.m_deliverToOne};a.Message.prototype.getDeliveryMode=function(){return this.m_deliveryMode};a.Message.prototype.setDeliveryMode=function(b){this.m_deliveryMode=b};a.Message.prototype.getDestination=
function(){return this.m_destination};a.Message.prototype.setDestination=function(b){this.m_destination=b};a.Message.prototype.isDiscardIndication=function(){return this.m_discardIndication};a.Message.prototype.setDiscardIndication=function(b){this.m_discardIndication=b};a.Message.prototype.isElidingEligible=function(){return this.m_elidingEligible};a.Message.prototype.setElidingEligible=function(b){this.m_elidingEligible=b};a.Message.prototype.getCacheStatus=function(){return this.m_cacheStatus};
a.Message.prototype.setCacheStatus=function(b){this.m_cacheStatus=b};a.Message.prototype.isReplyMessage=function(){return this.m_replyMessage};a.Message.prototype.isRedelivered=function(){return this.m_redelivered};a.Message.prototype.setAsReplyMessage=function(b){this.m_replyMessage=b};a.Message.prototype.getReceiverTimestamp=function(){return this.m_receiverTimestamp};a.Message.prototype.getReplyTo=function(){return this.m_replyTo};a.Message.prototype.setReplyTo=function(b){this.m_replyTo=b};a.Message.prototype.getSenderId=
function(){return this.m_senderId};a.Message.prototype.setSenderId=function(b){if(b!==null&&typeof b!=="string")throw new a.OperationError("Invalid message parameter, expected string.",a.ErrorSubcode.PARAMETER_INVALID_TYPE);this.m_senderId=b};a.Message.prototype.getSenderTimestamp=function(){return this.m_senderTimestamp};a.Message.prototype.setSenderTimestamp=function(b){this.m_senderTimestamp=b};a.Message.prototype.getSequenceNumber=function(){return this.m_sequenceNumber};a.Message.prototype.setSequenceNumber=
function(b){this.m_sequenceNumber=b;this.m_autoSequenceNumber=false};a.Message.prototype.getUserCos=function(){return this.m_userCos};a.Message.prototype.setUserCos=function(b){this.m_userCos=b};a.Message.prototype.getUserData=function(){return this.m_userData};a.Message.prototype.setUserData=function(b){if(b!==null&&typeof b!=="string")throw new a.OperationError("Invalid message parameter, expected string.",a.ErrorSubcode.PARAMETER_INVALID_TYPE);this.m_userData=b};a.Message.prototype.getXmlContent=
function(){return this.m_xmlContent};a.Message.prototype.getXmlContentDecoded=function(){return decodeURIComponent(escape(this.m_xmlContent))};a.Message.prototype.setXmlContent=function(b){if(b!==null&&typeof b!=="string")throw new a.OperationError("Invalid message parameter, expected string.",a.ErrorSubcode.PARAMETER_INVALID_TYPE);this.m_xmlContent=unescape(encodeURIComponent(b))};a.Message.prototype.setXmlContentInternal=function(b){if(b!==null&&typeof b!=="string")throw new a.OperationError("Invalid message parameter, expected string.",
a.ErrorSubcode.PARAMETER_INVALID_TYPE);this.m_xmlContent=b};a.Message.prototype.setXmlMetadata=function(b){if(b!==null&&typeof b!=="string")throw new a.OperationError("Invalid message parameter, expected string.",a.ErrorSubcode.PARAMETER_INVALID_TYPE);this.m_xmlMetadata=b};a.Message.prototype.getXmlMetadata=function(){return this.m_xmlMetadata};a.Message.prototype.getBinaryMetadataChunk=function(){return this.m_binaryMetaChunk};a.Message.prototype.setBinaryMetadataChunk=function(b){this.m_binaryMetaChunk=
b};a.Message.prototype.getSmfHeader=function(){return this.m_smfHeader};a.Message.prototype.setHasAutoSequenceNumber=function(b){this.m_autoSequenceNumber=b};a.Message.prototype.hasAutoSequenceNumber=function(){return this.m_autoSequenceNumber};a.Message.prototype.setHasAutoSenderTimestamp=function(b){this.m_autoSenderTimestamp=b};a.Message.prototype.hasAutoSenderTimestamp=function(){return this.m_autoSenderTimestamp};a.Message.prototype.getUserPropertyMap=function(){return this.m_userPropertyMap};
a.Message.prototype.setUserPropertyMap=function(b){this.m_userPropertyMap=b};a.Message.prototype.setSdtContainer=function(b){if(b===null){this.m_structuredContainer=null;this.m_messageType=a.MessageType.BINARY;this.setBinaryAttachment(null)}else{a.Util.checkParamInstanceOf(b,a.SDTField,"solace.SDTField");switch(b.getType()){case a.SDTFieldType.MAP:this.m_messageType=a.MessageType.MAP;break;case a.SDTFieldType.STREAM:this.m_messageType=a.MessageType.STREAM;break;case a.SDTFieldType.STRING:this.m_messageType=
a.MessageType.TEXT;break;default:throw new a.OperationError("Invalid parameter, SDTField Type of MAP, STREAM, or STRING.",a.ErrorSubcode.PARAMETER_INVALID_TYPE);}this.m_structuredContainer=b}};a.Message.prototype.getSdtContainer=function(){var b=this.getType();if((b===a.MessageType.MAP||b===a.MessageType.STREAM||b===a.MessageType.TEXT)&&this.getBinaryAttachment()!==null&&this.getBinaryAttachment().length>0){b=null;if(!(b=a.sdt.Codec.parseSdt(this.getBinaryAttachment(),0)))return null;return this.m_structuredContainer=
b}return null};a.Message.prototype.dump=function(b){if(typeof b==="undefined")return a.MessageDumpUtil.dump(this,a.MessageDumpFlag.MSGDUMP_FULL);else if(typeof b!=="undefined"&&b!==null&&typeof b==="number")if(b===a.MessageDumpFlag.MSGDUMP_BRIEF||b===a.MessageDumpFlag.MSGDUMP_FULL)return a.MessageDumpUtil.dump(this,b);else throw new a.OperationError("Invalid parameter value for dump flags.",a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);else throw new a.OperationError("Invalid parameter type for dump flags.",
a.ErrorSubcode.PARAMETER_INVALID_TYPE);};a.MessageUserCosType={COS1:0,COS2:1,COS3:2};a.MessageUserCosTypeDescription=function(){var b=[];b[a.MessageUserCosType.COS1]="COS1";b[a.MessageUserCosType.COS2]="COS2";b[a.MessageUserCosType.COS3]="COS3";return b}();a.MessageType={BINARY:0,MAP:1,STREAM:2,TEXT:3};a.MessageTypeDescription=function(){var b=[];b[a.MessageType.BINARY]="Binary";b[a.MessageType.MAP]="Map";b[a.MessageType.STREAM]="Stream";b[a.MessageType.TEXT]="Text";return b}();a.MessageDeliveryModeType=
{DIRECT:0,PERSISTENT:1,NON_PERSISTENT:2};a.MessageDeliveryModeTypeDescription=function(){var b=[];b[a.MessageDeliveryModeType.DIRECT]="DIRECT";b[a.MessageDeliveryModeType.PERSISTENT]="PERSISTENT";b[a.MessageDeliveryModeType.NON_PERSISTENT]="NON_PERSISTENT";return b}();a.MutableSessionProperty={CLIENT_NAME:1,CLIENT_DESCRIPTION:2};a.MessageDumpFlag={MSGDUMP_BRIEF:0,MSGDUMP_FULL:1};a.StatType={TX_TOTAL_DATA_BYTES:0,TX_TOTAL_DATA_MSGS:1,TX_DIRECT_BYTES:2,TX_DIRECT_MSGS:3,TX_CONTROL_BYTES:4,TX_CONTROL_MSGS:5,
TX_REQUEST_SENT:6,TX_REQUEST_TIMEOUT:7,RX_TOTAL_DATA_BYTES:8,RX_TOTAL_DATA_MSGS:9,RX_DIRECT_BYTES:10,RX_DIRECT_MSGS:11,RX_CONTROL_BYTES:12,RX_CONTROL_MSGS:13,RX_DISCARD_MSG_INDICATION:14,RX_REPLY_MSG_RECVED:15,RX_REPLY_MSG_DISCARD:16,RX_DISCARD_SMF_UNKNOWN_ELEMENT:17,CACHE_REQUEST_SENT:18,CACHE_REQUEST_OK_RESPONSE:19,CACHE_REQUEST_FAIL_RESPONSE:20,CACHE_REQUEST_FULFILL_DISCARD_RESPONSE:21,RX_CACHE_MSG:22,CACHE_REQUEST_INCOMPLETE_RESPONSE:23,CACHE_REQUEST_LIVE_DATA_FULFILL:24};a.SessionStatistics=
function(){this.m_statsMap=[];for(var b in a.StatType)if(a.StatType.hasOwnProperty(b))this.m_statsMap[a.StatType[b]]=0};a.SessionStatistics.prototype.resetStats=function(){for(var b=0,i=this.m_statsMap.length;b<i;b++)if(typeof this.m_statsMap[b]!=="undefined")this.m_statsMap[b]=0};a.SessionStatistics.prototype.incStat=function(b,i){this.m_statsMap[b]+=i!==undefined?i:1};a.SessionStatistics.prototype.getStat=function(b){return this.m_statsMap[b]};a.CapabilityType={PEER_SOFTWARE_VERSION:0,PEER_SOFTWARE_DATE:1,
PEER_PLATFORM:2,PEER_PORT_SPEED:3,PEER_PORT_TYPE:4,MAX_DIRECT_MSG_SIZE:5,PEER_ROUTER_NAME:6,MESSAGE_ELIDING:7,NO_LOCAL:8};a.CapabilityTypeDescription=function(){var b=[];b[a.CapabilityType.PEER_SOFTWARE_VERSION]="PEER_SOFTWARE_VERSION";b[a.CapabilityType.PEER_SOFTWARE_DATE]="PEER_SOFTWARE_DATE";b[a.CapabilityType.PEER_PLATFORM]="PEER_PLATFORM";b[a.CapabilityType.PEER_PORT_SPEED]="PEER_PORT_SPEED";b[a.CapabilityType.PEER_PORT_TYPE]="PEER_PORT_TYPE";b[a.CapabilityType.MAX_DIRECT_MSG_SIZE]="MAX_DIRECT_MSG_SIZE";
b[a.CapabilityType.PEER_ROUTER_NAME]="PEER_ROUTER_NAME";b[a.CapabilityType.MESSAGE_ELIDING]="MESSAGE_ELIDING";b[a.CapabilityType.NO_LOCAL]="NO_LOCAL";return b}();a.LogLevel={FATAL:0,ERROR:1,WARN:2,INFO:3,DEBUG:4,TRACE:5};a.SolclientFactoryProperties=function(){this.logLevel=a.LogLevel.ERROR;this.logger=null};a.LogImpl=function(b,i,k,m,o,s){this.trace=b;this.debug=i;this.info=k;this.warn=m;this.error=o;this.fatal=s};a.ConsoleLogImpl=function(){var b=function(){},i=b,k=b,m=b,o=b,s=b,d=b;if(h){i=!!Function.prototype.bind;
k=typeof h.log==="object";s=i?Function.prototype.bind:function(j){var e=Array.prototype.slice.call(arguments,1),f=this,l=function(){},c=function(){return f.apply(this instanceof Function&&j?this:j,e.concat(Array.prototype.slice.call(arguments)))};l.prototype=this.prototype;c.prototype=new l;return c};if(!i&&k)d=s=o=m=k=i=b=function(){Function.prototype.call.call(h.log,h,Array.prototype.slice.call(arguments))};else{i=k=h.log&&typeof h.log!=="undefined"?s.call(h.log,h):h.debug&&typeof h.debug==="function"?
s.call(h.debug,h):b;m=h.info&&typeof h.info!=="undefined"?s.call(h.info,h):k;o=h.warn&&typeof h.warn!=="undefined"?s.call(h.warn,h):m;d=s=h.error&&typeof h.error!=="undefined"?s.call(h.error,h):o}}a.LogImpl.call(this,i,k,m,o,s,d)};a.ConsoleLogImpl.prototype=Object.create?Object.create(a.LogImpl):new a.LogImpl;a.SolclientFactory=function(){var b=0,i=a.LogLevel.ERROR,k=new a.ConsoleLogImpl;return{createSession:function(m,o,s){return new a.Session(m,o,s)},createTopic:function(m){return new a.Topic(m)},
init:function(m){if(b===0){if(typeof m!=="undefined"&&m!==null&&m instanceof a.SolclientFactoryProperties){if(m.logLevel<a.LogLevel.FATAL||m.logLevel>a.LogLevel.TRACE)throw new a.OperationError("Invalid log level",a.ErrorSubcode.PARAMETER_OUT_OF_RANGE,null);i=m.logLevel}a.logger=m&&m.logger||new a.ConsoleLogImpl;if(!(k&&k.trace&&typeof k.trace==="function"&&k.debug&&typeof k.debug==="function"&&k.info&&typeof k.info==="function"&&k.warn&&typeof k.warn==="function"&&k.error&&typeof k.error==="function"&&
k.fatal&&typeof k.fatal==="function"))throw new a.OperationError("Invalid logger (trace, debug, info, warn, error and fatal methods required)",a.ErrorSubcode.PARAMETER_INVALID_TYPE,null);b++}},getLogLevel:function(){return i},setLogLevel:function(m){if(m<a.LogLevel.FATAL||m>a.LogLevel.TRACE)throw new a.OperationError("Invalid log level",a.ErrorSubcode.PARAMETER_OUT_OF_RANGE,null);i=m},createMessage:function(){return new a.Message}}}();a.P2PUtil={getP2PInboxTopic:function(b){return b+"/#"},getP2PTopicSubscription:function(b){return b+
"/>"}};a.GlobalContext=function(){function b(i,k){for(var m=k-i.length;m>0;m--)i="0"+i;return i}return{RandId:function(){var i=(Math.random()*Math.pow(2,32)).toFixed(0);return b(i+"",10)}(),sessionCounter:0,NextSessionCounter:function(){this.sessionCounter++;return b(this.sessionCounter+"",4)},idCounter:0,NextId:function(){this.idCounter++;return this.idCounter},GenerateClientName:function(){var i="solclientjs",k="";if(typeof navigator.product!=="undefined"){i=a.TopicUtil.toSafeChars(navigator.product);
i=i.length>0?i:"solclientjs"}k=a.TopicUtil.toSafeChars(navigator.platform);return k=i+"/"+k+"/"+this.RandId+"/"+this.NextSessionCounter()},GenerateUserIdentification:function(){var i="solclientjs",k="";if(typeof navigator.product!=="undefined"){i=a.TopicUtil.toSafeChars(navigator.product);i=i.length>0?i:"solclientjs"}k=a.TopicUtil.toSafeChars(navigator.platform);return k=i+"/"+k+"/"+this.RandId},GenerateClientDescription:function(){var i="solclientjs / "+navigator.userAgent;if(i.length>254)i=i.substr(0,
254);return i}}}();a.Util=function(){return{checkParamTypeOf:function(b,i,k){if(typeof b!==i)throw new a.OperationError("Invalid parameter type for "+(k||"")+", expected a "+i,a.ErrorSubcode.PARAMETER_INVALID_TYPE);},checkParamInstanceOf:function(b,i,k){if(!(b instanceof i))throw new a.OperationError("Invalid parameter, expected a "+k,a.ErrorSubcode.PARAMETER_INVALID_TYPE);},nullTerminate:function(b){if(b===null)return null;return b.charCodeAt(b.length-1)===0?b:b+String.fromCharCode(0)},stripNullTerminate:function(b){if(b===
null)return null;return b.charCodeAt(b.length-1)===0?b.substr(0,b.length-1):b},hexdump:function(b){for(var i=[],k=[],m=0,o=function(){for(var l=[],c=0;c<256;c++)l[c]=c<33||c>126?".":String.fromCharCode(c);return l}(),s=function(l){return l===8||l===16?"  ":" "},d=function(l,c){for(;l.length<c;l=" "+l);return l},j=0,e=b.length;j<e;j++){var f=b.charCodeAt(j);i.push(d(f.toString(16),2));k.push(o[f]||".");m++;i.push(s(m));if(j===b.length-1)for(;m<16;)i.push("  "+s(++m));if(m===16){i.push(k.join(""));
i.push("\n");m=0;k=[]}}return i.join("")},debugParseSmfStream:function(b){if(b!==null)for(var i=0;i<b.length;){var k=a.smf.Codec.decodeCompoundMessage(b,i);if(k&&k.getSmfHeader()){k=k.getSmfHeader();i+=k.m_messageLength}else break}},TimingBucket:function(b,i){this.name=b;this.buckets=[];this.log=function(k){if(!(typeof k==="undefined"||isNaN(k))){k=Math.floor(k/i)*i;this.buckets[k]=this.buckets[k]||0;this.buckets[k]++}};this.bucketCount=function(){for(var k=0,m=0;m<this.buckets.length;m++)k+=this.buckets[m]||
0;return k};this.toString=function(){var k=[],m;for(m in this.buckets)this.buckets.hasOwnProperty(m)&&k.push(m+": "+this.buckets[m]);return"{"+k.join(", ")+"}"}},each:function(b,i){var k;if(typeof(k=b.length)==="undefined")for(var m in b){if(b.hasOwnProperty(m))if(i(b[m],m)===false)break}else for(m=0;m<k;m++)if(i(b[m],m)===false)break},formatHexString:function(b){function i(o){if(typeof o!=="number")return"";o=o.toString(16);return o.length<2?"0"+o:o}var k="";if(typeof b==="number")return i(b);else if(typeof b===
"object"&&b instanceof Array){for(var m=0;m<b.length;m++)k+=i(b[m]);return k}else if(typeof b==="string"){for(m=0;m<b.length;m++)k+=i(b.charCodeAt(m));return k}else return null},strFmt:function(b){var i=1,k=arguments;return b.replace(/\{\d+\}/g,function(m){var o=k[i++];return typeof o==="undefined"?m:o+""})}}}();a.MessageDumpStandardProvider=function(){return{fpDestination:function(b){b=b.getDestination();return b!==null&&b instanceof a.Destination?["Destination",true,a.DestinationTypeDescription[b.getType()]+
" '"+b.getName()+"'",null]:["Destination",false,"",null]},fpSenderId:function(b){return["SenderId",typeof b.getSenderId()!=="undefined"&&b.getSenderId()!==null,b.getSenderId(),null]},fpAppMsgType:function(b){return["AppMessageType",typeof b.getApplicationMessageType()!=="undefined"&&b.getApplicationMessageType()!==null,b.getApplicationMessageType(),null]},fpAppMsgId:function(b){return["AppMessageID",typeof b.getApplicationMessageId()!=="undefined"&&b.getApplicationMessageId()!==null,b.getApplicationMessageId(),
null]},fpSequenceNumber:function(b){b=b.getSequenceNumber();return typeof b==="number"?["SequenceNumber",true,b,null]:["SequenceNumber",false,"",null]},fpCorrelationId:function(b){return["CorrelationId",typeof b.getCorrelationId()!=="undefined"&&b.getCorrelationId()!==null,b.getCorrelationId(),null]},fpSendTimestamp:function(b){b=b.getSenderTimestamp();return typeof b==="number"?["SendTimestamp",true,b+" ("+a.MessageDumpUtil.formatDate(b)+")",null]:["SendTimestamp",false,"",null]},fpRcvTimestamp:function(b){b=
b.getReceiverTimestamp();return typeof b==="number"?["RcvTimestamp",true,b+" ("+a.MessageDumpUtil.formatDate(b)+")",null]:["RcvTimestamp",false,"",null]},fpClassOfService:function(b){return typeof b.getUserCos()==="number"?["Class Of Service",true,a.MessageUserCosTypeDescription[b.getUserCos()],null]:["Class Of Service",false,"",null]},fpDeliveryMode:function(b){return typeof b.getDeliveryMode()==="number"?["DeliveryMode",true,a.MessageDeliveryModeTypeDescription[b.getDeliveryMode()],null]:["DeliveryMode",
false,"",null]},fpMessageRedelivered:function(b){return["Message Re-delivered",b.isRedelivered(),"",null]},fpDiscardIndication:function(b){return["Discard Indication",b.isDiscardIndication(),"",null]},fpReplyMessage:function(b){return["Reply Message",b.isReplyMessage(),"",null]},fpReplyTo:function(b){b=b.getReplyTo();return b!==null&&b instanceof a.Destination?["ReplyTo",true,a.DestinationTypeDescription[b.getType()]+" '"+b.getName()+"'",null]:["ReplyTo",false,"",null]},fpDeliverToOne:function(b){return["Deliver To One",
b.isDeliverToOne(),"",null]},fpElidingEligible:function(b){return["Eliding Eligible",b.isElidingEligible(),"",null]},fpUserData:function(b){return a.StringUtil.notEmpty(b.getUserData())?["User Data",true,"len="+b.getUserData().length,a.StringUtil.formatDumpBytes(b.getUserData(),true,2)]:["User Data",false,"",null]},fpUserPropertyMap:function(b,i){var k=b.getUserPropertyMap();if(k!==null&&k instanceof a.SDTMapContainer){var m=k.getKeys().length+" entries",o=null;if(i===a.MessageDumpFlag.MSGDUMP_FULL)try{o=
a.MessageDumpUtil.printMap(k,2)}catch(s){o="Error"}return["User Property Map",true,m,o]}else return["User Property Map",false,"",null]},fpSdtStream:function(b,i){var k=b.getSdtContainer();if(k!==null&&k.getType()===a.SDTFieldType.STREAM){var m=a.MessageDumpUtil.countItems(k.getValue())+" entries",o=null;if(i===a.MessageDumpFlag.MSGDUMP_FULL)try{o=a.MessageDumpUtil.printStream(k.getValue(),2)}catch(s){o="Error"}return["SDT Stream",true,m,o]}else return["SDT Stream",false,"",null]},fpSdtMap:function(b,
i){var k=b.getSdtContainer();if(k!==null&&k.getType()===a.SDTFieldType.MAP){var m=k.getValue().getKeys().length+" entries",o=null;if(i===a.MessageDumpFlag.MSGDUMP_FULL)try{o=a.MessageDumpUtil.printMap(k.getValue(),2)}catch(s){o="Error"}return["SDT Map",true,m,o]}else return["SDT Map",false,"",null]},fpBinaryAttachment:function(b,i){var k=b.getBinaryAttachment();if(a.StringUtil.notEmpty(k)){var m="len="+k.length,o=null;if(i===a.MessageDumpFlag.MSGDUMP_FULL)o=a.StringUtil.formatDumpBytes(k,true,2);
return["Binary Attachment",true,m,o]}else return["Binary Attachment",false,"",null]},fpXmlContent:function(b,i){var k=b.getXmlContent();if(a.StringUtil.notEmpty(k)){var m="len="+k.length,o=null;if(i===a.MessageDumpFlag.MSGDUMP_FULL)o=a.StringUtil.formatDumpBytes(k,true,2);return["XML",true,m,o]}else return["XML",false,"",null]},fpXmlMetadata:function(b,i){var k=b.getXmlMetadata();if(a.StringUtil.notEmpty(k)){var m="len="+k.length,o=null;if(i===a.MessageDumpFlag.MSGDUMP_FULL)o=a.StringUtil.formatDumpBytes(k,
true,2);return["XML Metadata",true,m,o]}else return["XML Metadata",false,"",null]}}}();a.MessageDumpUtil=function(){var b=a.MessageDumpStandardProvider,i=[],k;for(k in b)b.hasOwnProperty(k)&&i.push(b[k]);return{getOutOfRangeValue:function(m){return"<out of range>\n"+a.StringUtil.formatDumpBytes(m)},getValue:function(m){var o=null;try{return o=m.getValue()}catch(s){if(s instanceof a.SDTUnsupportedValueError){if(s.getSubcode()===a.SDTValueErrorSubcode.VALUE_OUTSIDE_SUPPORTED_RANGE)return this.getOutOfRangeValue(s.getSourceData())}else if(s instanceof
a.OperationError&&s.subcode===a.ErrorSubcode.PARAMETER_INVALID_TYPE)return"<invalid type>";throw s;}},printMap:function(m,o){if(typeof m==="undefined"||m===null||!(m instanceof a.SDTMapContainer))return null;for(var s=new a.StringBuffer,d=a.StringUtil.padRight("",o," "),j=m.getKeys().sort(),e=0;e<j.length;e++){var f=j[e],l=m.getField(f),c=null,g=null;if(l.getType()!==null)c=l.getType();g=this.getValue(l);l=null;switch(c){case a.SDTFieldType.MAP:l="\n";l+=this.printMap(g,o+2);break;case a.SDTFieldType.STREAM:l=
"\n";l+=this.printStream(g,o+2);break;case a.SDTFieldType.BYTEARRAY:l=a.StringUtil.formatDumpBytes(g,false,0);if(l!==null&&l.charAt(l.length-1)==="\n")l=l.substring(0,l.length-1);break;case a.SDTFieldType.DESTINATION:l=a.DestinationTypeDescription[g.getType()]+" '"+g.getName()+"'";break;default:l=g!==null?g.toString():null}s.append(d);s.append("Key '").append(f).append("' (").append(a.SDTFieldTypeDescription[c]).append("): ").append(l);e<j.length-1&&s.append("\n")}return s.toString()},printStream:function(m,
o){if(typeof m==="undefined"||m===null||!(m instanceof a.SDTStreamContainer))return null;m.rewind();for(var s=new a.StringBuffer,d=a.StringUtil.padRight("",o," ");m.hasNext();){var j=m.getNext(),e=null,f=null;if(j.getType()!==null)e=j.getType();f=this.getValue(j);j=null;switch(e){case a.SDTFieldType.MAP:j="\n";j+=this.printMap(f,o+2);break;case a.SDTFieldType.STREAM:j="\n";j+=this.printStream(f,o+2);break;case a.SDTFieldType.BYTEARRAY:j=a.StringUtil.formatDumpBytes(f,false,0);if(j!==null&&j.charAt(j.length-
1)==="\n")j=j.substring(0,j.length-1);break;case a.SDTFieldType.DESTINATION:j=a.DestinationTypeDescription[f.getType()]+" '"+f.getName()+"'";break;default:j=f!==null?f.toString():null}s.append(d);s.append("(").append(a.SDTFieldTypeDescription[e]).append("): ").append(j);m.hasNext()&&s.append("\n")}m.rewind();return s.toString()},countItems:function(m){if(typeof m==="undefined"||m===null||!(m instanceof a.SDTStreamContainer))return 0;m.rewind();for(var o=0;m.hasNext();){m.getNext();o++}m.rewind();
return o},formatDate:function(m){return(new Date(m)).format("ddd mmm dd yyyy HH:MM:ss Z",true)},dump:function(m,o,s,d){var j,e,f,l=new a.StringBuffer,c="\n",g=40;if(typeof s!=="undefined"&&s!==null&&typeof s==="string")c=s;if(typeof d!=="undefined"&&d!==null&&typeof d==="number")g=d;s=false;for(d=0;d<i.length;d++){j=i[d](m,o);if(e=j[1]){e=j[0];f=j[2];j=j[3];s&&l.append(c);if(f===null||f.length===0)l.append(e);else{l.append(a.StringUtil.padRight(e+":",g," "));l.append(f)}if(j!==null&&(o&a.MessageDumpFlag.MSGDUMP_FULL)>
0){l.append("\n");j.indexOf("  ")!==0&&l.append("  ");l.append(j);j.substring(j.length-2)!=="\n"&&d<i.length-1&&l.append("\n")}s=true}}return l.toString()}}}()})(solace,detected_console);
(function(a){function h(){var s=null;if(typeof window.XMLHttpRequest!=="undefined"&&window.XMLHttpRequest)s=new XMLHttpRequest;else if(typeof window.ActiveXObject!=="undefined"&&window.ActiveXObject)for(var d=["Microsoft.XMLHttp","MSXML2.XMLHttp","MSXML2.XMLHttp.5.0","MSXML2.XMLHttp.4.0","MSXML2.XMLHttp.3.0"],j=0;j<d.length;j++)try{s=new ActiveXObject(d[j]);break}catch(e){}if(typeof s==="undefined"||s===null)throw new a.TransportError("Failed to create an XMLHttpRequest",a.ErrorSubcode.CREATE_XHR_FAILED);
return s}function b(s,d,j,e,f,l){this.Options={url:s.match(/^(http|ws)(s?):/i)?s:window&&window.location&&window.location.origin?window.location.origin+(s.charAt(0)!=="/"?"/":"")+s:s,contentType:l,base64Enc:d,streamProgressEvents:j};this.m_streamProgressBytes=0;this.m_xhr=null;this.m_rxDataCb=e;this.m_connErrorCb=f;this.m_reqActive=false;this.m_REQCOUNTER=0;this.m_REQBASE=Math.floor(Math.random()*1E3);this.m_xhr=h();this.stats={WaitedToken:new a.Util.TimingBucket("WaitedToken",100),HadToken:new a.Util.TimingBucket("HadToken",
100),ReturnedToken:new a.Util.TimingBucket("ReturnedToken",100),toString:function(){var c="";a.Util.each([this.WaitedToken,this.HadToken,this.ReturnedToken],function(g){if(g&&g.bucketCount()>0)c+=g.name+">> "+g.toString()+"\n"});return c}};this.recStat=function(){}}function i(s,d,j){if(d!==null)d=a.base64_encode(d);s.setRequestHeader("Content-Type",j+"; charset=x-user-defined");s.send(d)}function k(s,d,j){s.overrideMimeType&&s.overrideMimeType(j+"; charset=x-user-defined");s.setRequestHeader("Content-Type",
j+"; charset=x-user-defined");o(s,d,j)}a.HttpConnection=b;var m=function(){var s="";if(navigator)s=navigator.userAgent||"";if(window.XMLHttpRequest&&window.XMLHttpRequest.prototype.sendAsBinary)return"firefox";else if(window.XMLHttpRequest&&window.Uint8Array&&window.ProgressEvent&&"overrideMimeType"in new XMLHttpRequest){if(s.match(/chrome/i))return"chrome";if(s.match(/OS 4(_\d)+ like Mac OS X/i))return null;return"xhr2"}else{if(window.XMLHttpRequest&&window.Uint8Array&&window.ProgressEvent&&"responseType"in
new XMLHttpRequest)if(s.match(/msie/i))return"msie10";return null}};b.browserSupportsXhrBinary=function(){return!!m()};b.browserSupportsStreamingResponse=function(){return typeof XMLHttpRequest!=="undefined"&&"onprogress"in new XMLHttpRequest};var o=null;(function(){var s=m();o=s==="firefox"?function(d,j){d.sendAsBinary(j)}:s==="xhr2"||s==="chrome"||s==="msie10"?function(d,j){var e=new ArrayBuffer(j.length);e=new Uint8Array(e,0);for(var f=0,l=j.length;f<l;f++)e[f]=j.charCodeAt(f);if(s==="chrome")d.send(e);
else if(s==="msie10"){d.responseType="arraybuffer";d.send(e)}else d.send(e.buffer)}:function(d,j,e){i(d,j,e)}})();b.prototype.send=function(s,d){d=typeof d==="undefined"?0:d;if(d>0){this.m_xhr.abort();this.m_xhr=h()}this.m_xhr.open("POST",this.Options.url,true);var j=this;this.m_streamProgressBytes=0;this.m_xhr.onreadystatechange=function(){j.xhrStateChange(s,d)};this.m_reqActive=true;this.Options.base64Enc?i(this.m_xhr,s,this.Options.contentType):k(this.m_xhr,s,this.Options.contentType);this.recStat("SendMsg")};
b.prototype.arrayBufferToString=function(s){if(s){var d=s.byteLength;s=new Uint8Array(s);if(d<32768)return String.fromCharCode.apply(null,s);else{for(var j=0,e="";j<d;){e+=String.fromCharCode.apply(null,s.subarray(j,j+32768));j+=32768}return e}}else return""};b.prototype.xhrStateChange=function(s,d){var j=this.m_xhr.readyState;if(this.Options.streamProgressEvents&&j===3||j===4)if(this.m_reqActive)if(this.m_xhr.status===200||this.m_xhr.status===304){var e=null;e=this.m_xhr.responseType&&this.m_xhr.responseType===
"arraybuffer"?this.arrayBufferToString(this.m_xhr.response):this.m_xhr.responseText;e=e.substring(this.m_streamProgressBytes,e.length);this.m_streamProgressBytes+=e.length;if(!(e.length===0&&j===3)){if(this.Options.base64Enc)try{e=a.base64_decode(e)}catch(f){this.m_rxDataCb(3,e);return}else{for(var l=[],c=0;c<e.length;c++)l.push(String.fromCharCode(e.charCodeAt(c)&255));e=l.join("")}if(j===4)this.m_reqActive=false;this.m_rxDataCb(0,e);j===4&&e.length>0&&this.m_rxDataCb(0,"")}}else{j=this.m_xhr.status;
e=this.m_xhr.statusText;l="";l=this.m_xhr.responseType&&this.m_xhr.responseType==="arraybuffer"?this.arrayBufferToString(this.m_xhr.response):this.m_xhr.responseText||"";c=l.length;if(d===0&&this.m_reqActive&&j!==400&&l.length===0)this.send(s,d+1);else{this.m_reqActive=false;this.m_connErrorCb(j,"HTTP request failed: status="+j+" statusText="+e+", responseText length="+c+", XHR errorCode="+(this.m_xhr.m_error?this.m_xhr.m_error.code:""))}}};b.prototype.isUsingBase64=function(){return this.Options.base64Enc};
b.prototype.abort=function(){this.m_reqActive=false;this.m_xhr&&this.m_xhr.abort&&this.m_xhr.abort()}})(solace);
(function(a){function h(i){return new a.OperationError("Invalid SDT type:value combination, expected value type "+i,a.ErrorSubcode.PARAMETER_INVALID_TYPE)}function b(i,k){var m=[];m[a.SDTFieldType.BOOL]="boolean";m[a.SDTFieldType.UINT8]="number";m[a.SDTFieldType.INT8]="number";m[a.SDTFieldType.UINT16]="number";m[a.SDTFieldType.INT16]="number";m[a.SDTFieldType.UINT32]="number";m[a.SDTFieldType.INT32]="number";m[a.SDTFieldType.UINT64]="number";m[a.SDTFieldType.INT64]="number";m[a.SDTFieldType.WCHAR]=
"string";m[a.SDTFieldType.STRING]="string";m[a.SDTFieldType.BYTEARRAY]="string";m[a.SDTFieldType.FLOATTYPE]="number";m[a.SDTFieldType.DOUBLETYPE]="number";if(m[i])if(typeof k!==m[i])return h(m[i]);if(i===a.SDTFieldType.MAP&&!(k instanceof a.SDTMapContainer))return h("solace.SDTMapContainer");else if(i===a.SDTFieldType.STREAM&&!(k instanceof a.SDTStreamContainer))return h("solace.SDTStreamContainer");else if(i===a.SDTFieldType.DESTINATION&&!(k instanceof a.Destination))return h("solace.Destination");
return null}a.SDTValueErrorSubcode={VALUE_OUTSIDE_SUPPORTED_RANGE:1};a.SDTUnsupportedValueError=function(i,k,m){this.name="SDTUnsupportedValueError";this.message=i||"";this.subcode=k;this.sourceData=m||""};a.SDTUnsupportedValueError.prototype=Error();a.SDTUnsupportedValueError.prototype.toString=function(){var i=new a.StringBuffer(this.name);i.append(": ");if(this.name==="SDTUnsupportedValueError"){i.append("message=").append(this.message||"").append(", ");i.append("subcode=").append(this.subcode||
"").append(", ");i.append("sourceData=").append(a.StringUtil.formatDumpBytes(this.sourceData,false,0))}else i.append("message=").append(this.message||"");return i.toString()};a.SDTUnsupportedValueError.prototype.getSubcode=function(){return this.subcode};a.SDTUnsupportedValueError.prototype.getSourceData=function(){return this.sourceData};a.SDTField=function(){this.m_type=a.SDTFieldType.NULLTYPE;this.m_error=this.m_value=null};a.SDTField.create=function(i,k,m){var o=b(i,k),s=new a.SDTField;s.m_type=
i;s.m_value=k;s.m_error=m?m:o?o:null;return s};a.SDTField.prototype.getType=function(){return this.m_type};a.SDTField.prototype.getValue=function(){if(this.m_error)throw this.m_error;return this.m_value};a.SDTField.prototype.toString=function(){return"[SDTField type:"+this.m_type+" value:"+this.m_value+" error:"+this.m_error+"]"};a.SDTFieldType={BOOL:0,UINT8:1,INT8:2,UINT16:3,INT16:4,UINT32:5,INT32:6,UINT64:7,INT64:8,WCHAR:9,STRING:10,BYTEARRAY:11,FLOATTYPE:12,DOUBLETYPE:13,MAP:14,STREAM:15,DESTINATION:16,
NULLTYPE:17,UNKNOWN:18,SMF_MESSAGE:19};a.SDTFieldTypeDescription=function(){var i=[],k;for(k in a.SDTFieldType)if(a.SDTFieldType.hasOwnProperty(k))i[a.SDTFieldType[k]]=k;return i}();a.SDTMapContainer=function(){this.m_map=[]};a.SDTMapContainer.prototype.getKeys=function(){var i=[],k;for(k in this.m_map)this.m_map.hasOwnProperty(k)&&i.push(k);return i};a.SDTMapContainer.prototype.getField=function(i){return this.m_map[i]};a.SDTMapContainer.prototype.deleteField=function(i){delete this.m_map[i]};a.SDTMapContainer.prototype.addField=
function(i,k){if(k instanceof a.SDTField)this.m_map[i]=k;else if(arguments.length>=3)this.m_map[arguments[0]]=a.SDTField.create(arguments[1],arguments[2])};a.SDTStreamContainer=function(){this.m_stream=[];this.m_writable=true;this.m_readPt=0};a.SDTStreamContainer.prototype.hasNext=function(){return this.m_stream.length>this.m_readPt};a.SDTStreamContainer.prototype.getNext=function(){return this.m_readPt<this.m_stream.length?this.m_stream[this.m_readPt++]:undefined};a.SDTStreamContainer.prototype.rewind=
function(){this.m_readPt=0};a.SDTStreamContainer.prototype.addField=function(i){if(this.m_writable)if(i instanceof a.SDTField)this.m_stream.push(i);else arguments.length>=2&&this.m_stream.push(a.SDTField.create(arguments[0],arguments[1]))};a.sdt=a.sdt||{};a.sdt.Codec=function(){function i(q){switch(q.length){case 1:return a.Convert.strToInt8(q);case 2:return a.Convert.strToInt16(q);case 3:return a.Convert.strToInt24(q);case 4:return a.Convert.strToInt32(q);default:return false}}function k(q){for(var u=
[],t=0;t<6;t++){var r=q%256;q=Math.floor(q/256);u.push(String.fromCharCode(r))}u.reverse();return u.join("")}function m(q,u){var t=false,r=0;switch(u.length){case 1:r=a.Convert.strToInt8(u);if(q){if(t=(r&128)!==0)r-=256;return f(a.SDTFieldType.INT8,r)}else return f(a.SDTFieldType.UINT8,r);case 2:r=a.Convert.strToInt16(u);if(q){if(t=(r&32768)!==0)r-=65536;return f(a.SDTFieldType.INT16,r)}else return f(a.SDTFieldType.UINT16,r);case 4:r=a.Convert.strToInt32(u);if(q)return f(a.SDTFieldType.INT32,r);else{t=
u.charCodeAt(0);var v=u.charCodeAt(1);r=u.charCodeAt(2);var w=u.charCodeAt(3);r=t*16777216+v*65536+r*256+w;return f(a.SDTFieldType.UINT32,r)}case 8:t=u.substr(0,8);v=[];for(r=t.length-1;r>=0;r--){w=t.charCodeAt(r)&255;for(var x=0;x<8;x++){v.push(w%2?1:0);w>>=1}}v.reverse();r=v.join("");v=null;t=q&&r.substr(0,1)==="1";w=parseInt(r.substr(1,15),2);if(!t&&w!==0||t&&w!==32767)v=new a.SDTUnsupportedValueError("Value is not supported",a.SDTValueErrorSubcode.VALUE_OUTSIDE_SUPPORTED_RANGE,u);r=parseInt(r.substr(16,
48),2);if(q){if(t)r-=Math.pow(2,48);return f(a.SDTFieldType.INT64,r,v)}else return f(a.SDTFieldType.UINT64,r,v)}return null}function o(q,u){var t=u,r=a.Convert.strToInt8(q.substr(t,1)),v=(r&252)>>2;r=(r&3)+1;t++;var w=i(q.substr(t,r));t+=r;return[v,w,w-(1+r),t-u]}function s(q,u){var t=o(q,u);if(!t)return null;var r=u+t[3],v=0,w=t[2];switch(t[0]){case e.Null:return f(a.SDTFieldType.NULLTYPE,null);case e.Boolean:v=a.Convert.strToInt8(q.substr(r,1));return f(a.SDTFieldType.BOOL,v!==0);case e.Integer:return m(true,
q.substr(r,w));case e.UnsignedInteger:return m(false,q.substr(r,w));case e.Float:a:{r=q.substr(r,w);switch(r.length){case 4:r=f(a.SDTFieldType.FLOATTYPE,l.fromIEEE754Single(r));break a;case 8:r=f(a.SDTFieldType.DOUBLETYPE,l.fromIEEE754Double(r));break a;default:r=f(a.SDTFieldType.UNKNOWN,r)}}return r;case e.Char:v=a.Convert.strToInt16(q.substr(r,2));return f(a.SDTFieldType.WCHAR,String.fromCharCode(v));case e.ByteArray:return f(a.SDTFieldType.BYTEARRAY,q.substr(r,w));case e.String:t=f;v=a.SDTFieldType.STRING;
r=q.substr(r,w-1);r=decodeURIComponent(escape(r));return t(v,r);case e.Destination:if(a.Convert.strToInt8(q.substr(r,1))!==0)return null;r=q.substr(r+1,w-2);return f(a.SDTFieldType.DESTINATION,new a.Topic(r));case e.SMFMessage:return f(a.SDTFieldType.SMF_MESSAGE,q.substr(r,w));case e.Map:return c(q,r,w);case e.Stream:return g(q,r,w);default:return f(a.SDTFieldType.UNKNOWN,q.substr(r,w))}}function d(q,u){var t=q<<2&255,r=null;if(q===e.Map||q===e.Stream){r=a.Convert.int32ToStr(u+5);t|=3}else if(u+2<=
255){r=a.Convert.int8ToStr(u+2);t|=0}else if(u+3<=65535){r=a.Convert.int16ToStr(u+3);t|=1}else{r=a.Convert.int32ToStr(u+5);t|=3}return a.Convert.int8ToStr(t)+r}function j(q,u){if(!(q instanceof a.SDTField))return false;var t=null,r=q.getValue(),v=0,w=0;switch(q.getType()){case a.SDTFieldType.BOOL:v=e.Boolean;t=a.Convert.int8ToStr(r?1:0);break;case a.SDTFieldType.UINT8:v=e.UnsignedInteger;t=a.Convert.int8ToStr(r);break;case a.SDTFieldType.INT8:v=e.Integer;t=a.Convert.int8ToStr(r);break;case a.SDTFieldType.UINT16:v=
e.UnsignedInteger;t=a.Convert.int16ToStr(r);break;case a.SDTFieldType.INT16:v=e.Integer;t=a.Convert.int16ToStr(r);break;case a.SDTFieldType.UINT32:v=e.UnsignedInteger;t=a.Convert.int32ToStr(r);break;case a.SDTFieldType.INT32:v=e.Integer;t=a.Convert.int32ToStr(r);break;case a.SDTFieldType.UINT64:v=e.UnsignedInteger;t=String.fromCharCode(0)+String.fromCharCode(0)+k(r);break;case a.SDTFieldType.INT64:v=e.Integer;if(r>=0)t=String.fromCharCode(0)+String.fromCharCode(0)+k(r);else{t=Math.pow(2,48)+r;t=String.fromCharCode(255)+
String.fromCharCode(255)+k(t)}break;case a.SDTFieldType.WCHAR:v=e.Char;w=r.charCodeAt(0);t=a.Convert.int16ToStr(w);break;case a.SDTFieldType.STRING:v=e.String;t=a.Util.nullTerminate(unescape(encodeURIComponent(r)));break;case a.SDTFieldType.BYTEARRAY:v=e.ByteArray;t=r;break;case a.SDTFieldType.FLOATTYPE:v=e.Float;t=l.toIEEE754Single(r);break;case a.SDTFieldType.DOUBLETYPE:v=e.Float;t=l.toIEEE754Double(r);break;case a.SDTFieldType.MAP:v=e.Map;t=n(r);break;case a.SDTFieldType.STREAM:v=e.Stream;t=p(r);
break;case a.SDTFieldType.DESTINATION:v=e.Destination;if(r instanceof a.Topic){t=a.Convert.int8ToStr(0);t+=a.Util.nullTerminate(r.getName())}break;case a.SDTFieldType.NULLTYPE:v=e.Null;t="";break;case a.SDTFieldType.UNKNOWN:t=null}if(t!==null){v=d(v,t.length);u.push(v);u.push(t)}}var e={Null:0,Boolean:1,Integer:2,UnsignedInteger:3,Float:4,Char:5,ByteArray:6,String:7,Destination:8,SMFMessage:9,Map:10,Stream:11},f=a.SDTField.create,l={toIEEE754:function(q,u,t){var r=(1<<u-1)-1,v,w;if(isNaN(q)){w=(1<<
r)-1;r=1;v=0}else if(q===Infinity||q===-Infinity){w=(1<<r)-1;r=0;v=q<0?1:0}else if(q===0){r=w=0;v=1/q===-Infinity?1:0}else{v=q<0;q=Math.abs(q);if(q>=Math.pow(2,1-r)){var x=Math.min(Math.floor(Math.log(q)/Math.LN2),r);w=x+r;r=q*Math.pow(2,t-x)-Math.pow(2,t)}else{w=0;r=q/Math.pow(2,1-r-t)}}q=[];for(t=t;t;t-=1){q.push(r%2?1:0);r=Math.floor(r/2)}for(t=u;t;t-=1){q.push(w%2?1:0);w=Math.floor(w/2)}q.push(v?1:0);q.reverse();u=q.join("");for(v=[];u.length;){v.push(parseInt(u.substring(0,8),2));u=u.substring(8)}return v},
fromIEEE754:function(q,u,t){for(var r=[],v=q.length;v;v-=1)for(var w=q[v-1],x=8;x;x-=1){r.push(w%2?1:0);w>>=1}r.reverse();w=r.join("");q=(1<<u-1)-1;r=parseInt(w.substring(0,1),2)?-1:1;v=parseInt(w.substring(1,1+u),2);w=parseInt(w.substring(1+u),2);return v===(1<<u)-1?w!==0?NaN:r*Infinity:v>0?r*Math.pow(2,v-q)*(1+w/Math.pow(2,t)):w!==0?r*Math.pow(2,-(q-1))*(w/Math.pow(2,t)):r*0},strToByteArr:function(q){for(var u=[],t=0;t<q.length;t++)u.push(q.charCodeAt(t)&255);return u},byteArrToStr:function(q){for(var u=
[],t=0;t<q.length;t++)u.push(String.fromCharCode(q[t]&255));return u.join("")},fromIEEE754Double:function(q){return this.fromIEEE754(this.strToByteArr(q),11,52)},toIEEE754Double:function(q){return this.byteArrToStr(this.toIEEE754(q,11,52))},fromIEEE754Single:function(q){return this.fromIEEE754(this.strToByteArr(q),8,23)},toIEEE754Single:function(q){return this.byteArrToStr(this.toIEEE754(q,8,23))}},c=null,g=null,n=null,p=null;n=function(q){var u=[];if(!(q instanceof a.SDTMapContainer))return null;
for(var t=q.getKeys(),r=null,v=null,w=null,x=0;x<t.length;x++)if(r=q.getField(t[x])){w=a.Util.nullTerminate(t[x]);v=d(e.String,w.length);v+=w;u.push(v);j(r,u)}return u.join("")};p=function(q){var u=[];if(!(q instanceof a.SDTStreamContainer))return null;for(var t=null;q.hasNext();)(t=q.getNext())&&j(t,u);return u.join("")};c=function(q,u,t){for(var r=u,v=new a.SDTMapContainer;r<u+t;){var w=o(q,r);r+=w[3];if(w[0]!==e.String)return f(a.SDTFieldType.MAP,null);var x=q.substr(r,w[2]-1);r+=w[2];w=o(q,r);
var B=s(q,r);r+=w[1];B&&v.addField(x,B)}return f(a.SDTFieldType.MAP,v)};g=function(q,u,t){for(var r=new a.SDTStreamContainer,v=u;v<u+t;){var w=o(q,v),x=s(q,v);v+=w[1];x&&r.addField(x)}return f(a.SDTFieldType.STREAM,r)};return{parseSdt:s,encodeSdt:function(q){var u=[];j(q,u);return u.join("")},IEEE754LIB:l}}()})(solace);
(function(a){var h=a.ErrorSubcode,b=a.SessionEventCode,i=a.TransportSessionEventCode,k=a.GlobalContext,m=a.P2PUtil,o=a.TopicUtil,s=a.StringUtil,d=a.Util,j=a.StatType,e=a.MutableSessionProperty,f=a.SessionState,l=a.Util.strFmt;a.Session=function(c,g,n){if(!c)throw new a.OperationError("Session properties cannot be null",h.PARAMETER_OUT_OF_RANGE);c.sol_validate();this.m_sessionProperties=c.clone();this.resetTransportProtocolHandler();this.m_transportProtocolHandler.validateProperties();if(!(g instanceof
a.MessageRxCBInfo))throw new a.OperationError("Invalid parameter type for messageCallbackInfo",h.PARAMETER_INVALID_TYPE);if(!(n instanceof a.SessionEventCBInfo))throw new a.OperationError("Invalid parameter type for eventCallbackInfo",h.PARAMETER_INVALID_TYPE);this.m_messageCallbackInfo=g;this.m_eventCallbackInfo=n;if(!s.notEmpty(this.m_sessionProperties.clientName))this.m_sessionProperties.clientName=a.GlobalContext.GenerateClientName();this.m_sessionProperties.userIdentification=a.GlobalContext.GenerateUserIdentification();
if(!s.notEmpty(this.m_sessionProperties.applicationDescription))this.m_sessionProperties.applicationDescription=a.GlobalContext.GenerateClientDescription();this.m_sessionState=0;this.m_sessionStatistics=new a.SessionStatistics;this.m_keepAliveTimer=this.m_sessionId=null;this.m_keepAliveCounter=0;this.m_outstandingCtrlReqs={};this.m_outstandingDataReqs={};this.m_newSession=true;this.m_disposed=this.m_inReconnect=false;this.m_smfClient=null;this.m_kaStats={lastMsgWritten:0,lastBytesWritten:0};this.m_subscriptionCacheKeys=
this.m_subscriptionCache=this.m_capabilities=null;this.m_subscriptionCacheCount=0;if(this.m_sessionProperties.reapplySubscriptions)this.m_subscriptionCache={};this.m_seqNum=1;this.m_lastKnownGoodTransport=null};a.Session.prototype.connect=function(){this.beginConnect(this.m_lastKnownGoodTransport)};a.Session.prototype.connectInternal=function(){try{this.beginConnect(null)}catch(c){this.m_inReconnect=false;this.changeState(9);this.sendEvent(new a.SessionEvent(b.CONNECT_FAILED_ERROR,"Downgrade connect failed.",
null,c.subcode?c.subcode:h.UNKNOWN_ERROR,null,c))}};a.Session.prototype.beginConnect=function(c){var g=this.allowOperation(0);if(g)throw new a.OperationError(g,h.INVALID_SESSION_OPERATION,null);if(this.m_newSession)this.m_newSession=false;else{this.cleanupSession();this.m_inReconnect=true}this.m_connectTimer||this.setConnectTimer();var n=this;this.m_kaStats={lastMsgWritten:0,lastBytesWritten:0};g=this.m_sessionProperties.clone();c&&this.m_transportProtocolHandler.setProtocol(c);g.transportProtocol=
this.m_transportProtocolHandler.getTransportProtocol();if(!this.m_transportProtocolHandler.shouldRetry())g.transportDowngradeTimeoutInMsecs=0;this.m_smfClient=new a.SMFClient(g,function(u){n.handleSmfMessage(u)},function(u){n.handleSmfParseError(u)},function(u){n.handleTransportEvent(u)},n);this.changeState(2);this.sendEvent(new a.SessionEvent(b.CONNECTING,l("Establishing connection (transport:{0})",this.m_transportProtocolHandler),null,null,null,null));try{var p=this.m_smfClient.connect();if(p!==
0){this.clearConnectTimer();throw new a.OperationError("Cannot establish transport session",h.INTERNAL_CONNECTION_ERROR,a.TransportReturnCodeDescription[p]);}}catch(q){this.clearConnectTimer();throw new a.OperationError("Cannot establish transport session",h.INTERNAL_CONNECTION_ERROR,q);}};a.Session.prototype.setConnectTimer=function(){this.clearConnectTimer();var c=this;this.m_connectTimer=setTimeout(function(){c.handleConnectTimeout()},this.m_sessionProperties.connectTimeoutInMsecs)};a.Session.prototype.clearConnectTimer=
function(){if(this.m_connectTimer){clearTimeout(this.m_connectTimer);this.m_connectTimer=null}};a.Session.prototype.handleConnectTimeout=function(){this.m_inReconnect=false;this.disconnectInternal()};a.Session.prototype.resetTransportProtocolHandler=function(){this.m_transportProtocolHandler=new a.TransportProtocolHandler(this.m_sessionProperties)};a.Session.prototype.disconnect=function(){this.disconnectInternal()};a.Session.prototype.disconnectInternal=function(){var c=this.allowOperation(1);if(c)throw new a.OperationError(c,
h.INVALID_SESSION_OPERATION,null);if(this.m_sessionState!==1&&this.m_sessionState!==10)this.m_sessionState=10;this.clearConnectTimer();this.cleanupSession();this.resetTransportProtocolHandler();this.destroyTransportSession()};a.Session.prototype.dispose=function(){try{if(!this.m_disposed){if(this.allowOperation(1)===null){this.m_inReconnect=false;this.disconnectInternal()}this.m_capabilities=null;this.m_sessionStatistics&&this.m_sessionStatistics.resetStats();this.m_sessionStatistics=null;if(this.m_subscriptionCache)for(var c in this.m_subscriptionCache)this.m_subscriptionCache.hasOwnProperty(c)&&
this.removeFromSubscriptionCache(c);this.m_subscriptionCache=null;this.clearSubscriptionCacheKeys();this.m_subscriptionCacheCount=0;this.m_outstandingDataReqs=this.m_outstandingCtrlReqs=null;this.m_disposed=true}}catch(g){}};a.Session.prototype.subscribe=function(c,g,n,p){var q=this.allowOperation(4);if(q)throw new a.OperationError(q,h.INVALID_SESSION_OPERATION,null);if(!(c instanceof a.Topic))throw new a.OperationError("Invalid parameter type for topic.",h.PARAMETER_INVALID_TYPE);if(q=o.validateTopic(c.getName()))throw new a.OperationError(q,
h.INVALID_TOPIC_SYNTAX,null);if(typeof g!=="undefined"&&g!==null&&typeof g!=="boolean")throw new a.OperationError("Invalid parameter type for requestConfirmation.",h.PARAMETER_INVALID_TYPE);if(typeof p!=="undefined"&&p!==null)if(typeof p!=="number")throw new a.OperationError("Invalid parameter type for requestTimeout.",h.PARAMETER_INVALID_TYPE);else if(p<=0)throw new a.OperationError("Request timeout must be greater than 0.",h.PARAMETER_OUT_OF_RANGE);var u=this;this.subscriptionUpdate(c,g,n,p,2,function(t,
r){u.handleSubscriptionUpdateResponse(t,r)})};a.Session.prototype.unsubscribe=function(c,g,n,p){var q=this.allowOperation(4);if(q)throw new a.OperationError(q,h.INVALID_SESSION_OPERATION,null);if(!(c instanceof a.Topic))throw new a.OperationError("Invalid parameter type for topic.",h.PARAMETER_INVALID_TYPE);if(q=o.validateTopic(c.getName()))throw new a.OperationError(q,h.INVALID_TOPIC_SYNTAX,null);if(typeof g!=="undefined"&&g!==null&&typeof g!=="boolean")throw new a.OperationError("Invalid parameter type for requestConfirmation.",
h.PARAMETER_INVALID_TYPE);if(typeof p!=="undefined"&&p!==null)if(typeof p!=="number")throw new a.OperationError("Invalid parameter type for requestTimeout",h.PARAMETER_INVALID_TYPE);else if(p<=0)throw new a.OperationError("Request timeout must be greater than 0.",h.PARAMETER_OUT_OF_RANGE);var u=this;this.subscriptionUpdate(c,g,n,p,3,function(t,r){u.handleSubscriptionUpdateResponse(t,r)})};a.Session.prototype.updateProperty=function(c,g,n,p){var q=this.allowOperation(4);if(q)throw new a.OperationError(q,
h.INVALID_SESSION_OPERATION,null);q=false;for(var u in e)if(e.hasOwnProperty(u))if(e[u]===c)q=true;if(!q)throw new a.OperationError("Invalid parameter value for mutableSessionProperty.",h.PARAMETER_OUT_OF_RANGE);if(typeof n!=="undefined"&&n!==null)if(typeof n!=="number")throw new a.OperationError("Invalid parameter type for requestTimeout.",h.PARAMETER_INVALID_TYPE);else if(n<=0)throw new a.OperationError("Request timeout must be greater than 0.",h.PARAMETER_OUT_OF_RANGE);u=[];u[e.CLIENT_DESCRIPTION]=
6;u[e.CLIENT_NAME]=5;var t=this.m_smfClient.nextCorrelationTag();q=a.smf.ClientCtrlMessage.getUpdate(c,g,t);var r=this,v,w=b.PROPERTY_UPDATE_OK,x=b.PROPERTY_UPDATE_ERROR,B=this.m_smfClient.send(q);if(B!==0){this.changeState(9);v=B===2?new a.SessionEvent(x,"Property update failed - no space in transport",null,h.INSUFFICIENT_SPACE,null,null):new a.SessionEvent(x,"Property update failed",null,h.INVALID_SESSION_OPERATION,null,null);this.sendEvent(v)}else{this.updateTxStats(q);this.enqueueOutstandingCtrlReq(t,
function(){r.handleOperationTimeout(t,"Update request timeout")},n||this.m_sessionProperties.readTimeoutInMsecs,u[c]||0,p,function(C){var A=C.getResponse();if(A.ResponseCode===200)if(c===e.CLIENT_DESCRIPTION){r.m_sessionProperties.applicationDescription=g;v=new a.SessionEvent(w,A.ResponseString,A.ResponseCode,0,p,null);r.sendEvent(v)}else{if(c===e.CLIENT_NAME){A=m.getP2PTopicSubscription(r.m_sessionProperties.p2pInboxBase);var D=m.getP2PTopicSubscription(C.getP2PTopicValue()),E=function(y){y=y.getResponse();
if(y.ResponseCode===200){r.m_sessionProperties.p2pInboxBase=C.getP2PTopicValue()||"";r.m_sessionProperties.p2pInboxInUse=m.getP2PInboxTopic(r.m_sessionProperties.p2pInboxBase);r.m_sessionProperties.clientName=g;v=new a.SessionEvent(w,y.ResponseString,y.ResponseCode,0,p,null)}else{var z=a.ErrorResponseSubCodeMapper.getErrorSubCode(y.ResponseCode,y.ResponseString);v=z===h.SUBSCRIPTION_ALREADY_PRESENT&&r.m_sessionProperties.ignoreDuplicateSubscriptionError?new a.SessionEvent(w,y.ResponseString,y.ResponseCode,
0,p,null):z===h.SUBSCRIPTION_ALREADY_PRESENT||z===h.SUBSCRIPTION_ATTRIBUTES_CONFLICT||z===h.SUBSCRIPTION_INVALID||z===h.SUBSCRIPTION_ACL_DENIED||z===h.SUBSCRIPTION_TOO_MANY?new a.SessionEvent(x,y.ResponseString,y.ResponseCode,z,p,null):new a.SessionEvent(x,y.ResponseString,y.ResponseCode,h.SUBSCRIPTION_ERROR_OTHER,p,null)}r.sendEvent(v)};r.sendUpdateP2PInboxReg(false,A,p,function(y){y=y.getResponse();if(y.ResponseCode===200)r.sendUpdateP2PInboxReg(true,D,p,E);else{var z=a.ErrorResponseSubCodeMapper.getErrorSubCode(y.ResponseCode,
y.ResponseString);if(z===h.SUBSCRIPTION_NOT_FOUND&&r.m_sessionProperties.ignoreSubscriptionNotFoundError)r.sendUpdateP2PInboxReg(true,D,p,E);else{v=z===h.SUBSCRIPTION_ATTRIBUTES_CONFLICT||z===h.SUBSCRIPTION_INVALID||z===h.SUBSCRIPTION_NOT_FOUND||z===h.SUBSCRIPTION_ACL_DENIED?new a.SessionEvent(x,y.ResponseString,y.ResponseCode,z,null,null):new a.SessionEvent(x,y.ResponseString,y.ResponseCode,h.SUBSCRIPTION_ERROR_OTHER,null,null);r.sendEvent(v)}}})}}else{var F=a.ErrorResponseSubCodeMapper.getErrorSubCode(A.ResponseCode,
A.ResponseString);v=new a.SessionEvent(x,A.ResponseString,A.ResponseCode,F,p,null);r.sendEvent(v)}})}};a.Session.prototype.send=function(c){var g=this.allowOperation(5);if(g)throw new a.OperationError(g,h.INVALID_SESSION_OPERATION,null);if(!(c instanceof a.Message))throw new a.OperationError("Invalid parameter type for message",h.PARAMETER_INVALID_TYPE);this.handleSendMessage(c)};a.Session.prototype.sendRequest=function(c,g,n,p,q){var u=this.allowOperation(5);if(u)throw new a.OperationError(u,h.INVALID_SESSION_OPERATION,
null);if(!(c instanceof a.Message))throw new a.OperationError("Invalid parameter type for message.",h.PARAMETER_INVALID_TYPE);if(typeof g!=="undefined"&&g!==null){d.checkParamTypeOf(g,"number","timeout");if(g<100)throw new a.OperationError("Request timeout must be greater than or equal to 100.",h.PARAMETER_OUT_OF_RANGE);}if(typeof n==="undefined"||n===null||typeof n!=="function")throw new a.OperationError("Invalid parameter type for replyReceivedCBFunction.",h.PARAMETER_INVALID_TYPE);if(typeof p===
"undefined"||p===null||typeof p!=="function")throw new a.OperationError("Invalid parameter type for requestFailedCBFunction.",h.PARAMETER_INVALID_TYPE);c.setCorrelationId("#REQ"+k.NextId());u=a.SolclientFactory.createTopic(this.m_sessionProperties.p2pInboxInUse);c.setReplyTo(u);this.handleSendMessage(c);this.enqueueOutstandingDataReq(c.getCorrelationId(),p,g,n,q)};a.Session.prototype.sendReply=function(c,g){var n=this.allowOperation(5);if(n)throw new a.OperationError(n,h.INVALID_SESSION_OPERATION,
null);if(typeof c!=="undefined"&&c!==null&&!(c instanceof a.Message))throw new a.OperationError("Invalid parameter type for messageToReplyTo.",h.PARAMETER_INVALID_TYPE);if(!(g instanceof a.Message))throw new a.OperationError("Invalid parameter type for replyMessage.",h.PARAMETER_INVALID_TYPE);g.setAsReplyMessage(true);if(typeof c!=="undefined"&&c!==null){g.setCorrelationId(c.getCorrelationId());if(c.getReplyTo()===null)throw new a.OperationError("ReplyTo destination may not be null.",h.PARAMETER_OUT_OF_RANGE);
g.setDestination(c.getReplyTo())}this.handleSendMessage(g)};a.Session.prototype.getStat=function(c){var g=this.allowOperation(7);if(g)throw new a.OperationError(g,h.INVALID_SESSION_OPERATION,null);g=false;for(var n in j)if(j.hasOwnProperty(n))if(j[n]===c)g=true;if(!g)throw new a.OperationError("Invalid parameter value for statType.",h.PARAMETER_OUT_OF_RANGE);return this.m_sessionStatistics.getStat(c)};a.Session.prototype.resetStats=function(){var c=this.allowOperation(7);if(c)throw new a.OperationError(c,
h.INVALID_SESSION_OPERATION,null);this.m_sessionStatistics.resetStats()};a.Session.prototype.getSessionProperties=function(){var c=this.allowOperation(7);if(c)throw new a.OperationError(c,h.INVALID_SESSION_OPERATION,null);c=this.m_sessionProperties.clone();if(this.m_sessionState!==1&&this.m_transportProtocolHandler)c.transportProtocolInUse=this.m_transportProtocolHandler.getTransportProtocol();return c};a.Session.prototype.isCapable=function(c){var g=this.allowOperation(7);if(g)throw new a.OperationError(g,
h.INVALID_SESSION_OPERATION,null);if(typeof c!=="number")throw new a.OperationError("Invalid parameter type for capabilityType.",h.PARAMETER_INVALID_TYPE);g=this.m_capabilities;if(!g)return false;return typeof g[c]==="boolean"?g[c]:false};a.Session.prototype.getCapability=function(c){var g=this.allowOperation(7);if(g)throw new a.OperationError(g,h.INVALID_SESSION_OPERATION,null);if(typeof c!=="number")throw new a.OperationError("Invalid parameter type for capabilityType",h.PARAMETER_INVALID_TYPE);
g=this.m_capabilities;if(!g||typeof g[c]==="undefined")return null;c=g[c];return typeof c==="boolean"?a.SDTField.create(a.SDTFieldType.BOOL,c):typeof c==="number"?a.SDTField.create(a.SDTFieldType.INT64,c):typeof c==="string"?a.SDTField.create(a.SDTFieldType.STRING,c):null};a.Session.prototype.getSessionState=function(){var c=this.allowOperation(7);if(c)throw new a.OperationError(c,h.INVALID_SESSION_OPERATION,null);switch(this.m_sessionState){case 0:return f.NEW;case 8:return f.CONNECTED;case 10:return f.DISCONNECTING;
case 1:return f.DISCONNECTED;case 9:return f.SESSION_ERROR;default:return f.CONNECTING}};a.Session.prototype.createCacheSession=function(c){return new a.CacheSession(c,this)};a.Session.prototype.updateRxStats=function(c){var g=c.getSmfHeader?c.getSmfHeader():null;if(g){var n=g.m_messageLength;switch(g.m_smf_protocol){case 13:if(g.m_pm_respcode===0){this.m_sessionStatistics.incStat(j.RX_TOTAL_DATA_MSGS);this.m_sessionStatistics.incStat(j.RX_DIRECT_MSGS);this.m_sessionStatistics.incStat(j.RX_TOTAL_DATA_BYTES,
n);this.m_sessionStatistics.incStat(j.RX_DIRECT_BYTES,n);c.m_discardIndication&&this.m_sessionStatistics.incStat(j.RX_DISCARD_MSG_INDICATION)}break;case 12:case 15:case 10:case 11:this.m_sessionStatistics.incStat(j.RX_CONTROL_MSGS);this.m_sessionStatistics.incStat(j.RX_CONTROL_BYTES,n)}}};a.Session.prototype.updateTxStats=function(c){typeof c.getReplyTo!=="undefined"&&c.getReplyTo()&&this.m_sessionStatistics.incStat(j.TX_REQUEST_SENT);if(c=c.getSmfHeader?c.getSmfHeader():null){var g=c.m_messageLength;
switch(c.m_smf_protocol){case 13:this.m_sessionStatistics.incStat(j.TX_TOTAL_DATA_MSGS);this.m_sessionStatistics.incStat(j.TX_DIRECT_MSGS);this.m_sessionStatistics.incStat(j.TX_TOTAL_DATA_BYTES,g);this.m_sessionStatistics.incStat(j.TX_DIRECT_BYTES,g);break;case 12:case 15:case 10:case 11:this.m_sessionStatistics.incStat(j.TX_CONTROL_MSGS);this.m_sessionStatistics.incStat(j.TX_CONTROL_BYTES,g)}}};a.Session.prototype.sendEvent=function(c){if(c)if(this.m_eventCallbackInfo)this.m_eventCallbackInfo.userObject?
this.m_eventCallbackInfo.sessionEventCBFunction(this,c,this.m_eventCallbackInfo.userObject):this.m_eventCallbackInfo.sessionEventCBFunction(this,c)};a.Session.prototype.shallNotifyClient=function(){return this.m_sessionState!==9&&this.m_sessionState!==10&&this.m_sessionState!==1&&!this.m_disposed};a.Session.prototype.changeState=function(c){if(c&&this.m_sessionState!==c){var g=this.m_sessionState;if((g===10||g===1)&&c!==1){if(g===1&&this.m_inReconnect&&c===2)this.m_sessionState=c}else{this.m_sessionState=
c;c===9&&this.destroyTransportSession()}}};a.Session.prototype.allowOperation=function(c){var g=true;if(this.m_disposed)g=false;else if(typeof c!=="undefined"&&c!==null)switch(c){case 0:if(this.m_sessionState!==0&&this.m_sessionState!==1)g=false;break;case 1:if(this.m_sessionState===0)g=false;break;case 2:if(this.m_sessionState!==3)g=false;break;case 3:if(this.m_sessionState!==5)g=false;break;case 4:if(this.m_sessionState!==8)g=false;break;case 5:if(this.m_sessionState!==8)g=false;break;case 6:this.m_sessionProperties.reapplySubscriptions&&
this.m_sessionState===7||(g=false);break;case 7:g=true;break;default:g=false}else g=false;if(g)return null;else{g=new a.StringBuffer("Cannot perform operation ");g.append(a.SessionOperationDescription[c]||"");g.append(" while in state ").append(a.InternalSessionStateDescription[this.m_sessionState]);g.append(this.m_disposed?"(already disposed)":"");return g.toString()}};a.Session.prototype.updateReadonlySessionProps=function(c){this.m_sessionProperties.vpnNameInUse=c.getVpnNameInUseValue()||"";var g=
this.m_sessionProperties.virtualRouterName,n=c.getVridInUseValue()||"";this.m_sessionProperties.virtualRouterName=n;g!==""&&g!==n&&this.sendEvent(new a.SessionEvent(b.VIRTUALROUTER_NAME_CHANGED,"Virtual router name is changed from "+g+" to "+n,null,0,null,null));this.m_sessionProperties.p2pInboxBase=c.getP2PTopicValue()||"";this.m_sessionProperties.p2pInboxInUse=m.getP2PInboxTopic(this.m_sessionProperties.p2pInboxBase);this.m_capabilities=c.getRouterCapabilities()};a.Session.prototype.subscriptionUpdate=
function(c,g,n,p,q,u){var t;switch(q){case 2:case 4:t="Cannot add subscription";break;case 3:t="Cannot remove subscription";break;case 1:t="Cannot register P2P inbox subscripiton";break;case 7:case 8:t="Cannot update P2P inbox subscription";break;default:t="Subscription update failed"}var r;switch(q){case 2:case 4:r="Add subscription request timeout";break;case 3:r="Remove subscription request timeout";break;case 7:case 1:r="Add P2P inbox subscription timeout";break;case 8:r="Remove P2P inbox subscription timeout";
break;default:r="Request timeout"}var v=q===2||q===4||q===1||q===7,w=this.m_smfClient.nextCorrelationTag(),x=a.smf.SMPMessage.getSubscriptionMessage(w,c,v,g),B=this;v=this.m_smfClient.send(x);if(v!==0){if(v===2){c=h.INSUFFICIENT_SPACE;t+=" - no space in transport"}else c=h.INVALID_SESSION_OPERATION;switch(q){case 1:q=new a.SessionEvent(b.P2P_SUB_ERROR,t,null,c,null,null);break;case 7:case 8:q=new a.SessionEvent(b.PROPERTY_UPDATE_ERROR,t,null,c,null,null);break;default:throw new a.OperationError(t,
c,a.TransportReturnCodeDescription[v]);}this.changeState(9);this.sendEvent(q)}else{this.updateTxStats(x);if(g)this.enqueueOutstandingCtrlReq(w,function(){B.handleOperationTimeout(w,r)},p||this.m_sessionProperties.readTimeoutInMsecs,q,n,u);if(q===2&&this.m_sessionProperties.reapplySubscriptions)this.addToSubscriptionCache(c);else q===3&&this.m_sessionProperties.reapplySubscriptions&&this.removeFromSubscriptionCache(c)}};a.Session.prototype.handleSendMessage=function(c){var g=c.getDestination();if(!(g!==
null&&s.notEmpty(g.getName())))throw new a.OperationError("Message must have a valid Destination",h.TOPIC_MISSING);if(g=o.validateTopic(g.getName()))throw new a.OperationError(g,h.INVALID_TOPIC_SYNTAX,null);g=c.getDeliveryMode();if(g!==null&&g!==a.MessageDeliveryModeType.DIRECT)throw new a.OperationError("AD messages are not supported",h.AD_MESSAGING_NOT_SUPPORTED);if(this.m_sessionProperties.generateSendTimestamps&&(c.getSenderTimestamp()===null||c.hasAutoSenderTimestamp())){c.setSenderTimestamp((new Date).getTime());
c.setHasAutoSenderTimestamp(true)}if(this.m_sessionProperties.generateSequenceNumber&&(c.getSequenceNumber()===null||c.hasAutoSequenceNumber())){c.setSequenceNumber(this.m_seqNum++);c.setHasAutoSequenceNumber(true)}this.m_sessionProperties.includeSenderId&&c.getSenderId()===null&&c.setSenderId(this.m_sessionProperties.clientName);g=this.m_smfClient.send(c);if(g!==0)if(g===2)throw new a.OperationError("Cannot send message - no space in transport",h.INSUFFICIENT_SPACE,a.TransportReturnCodeDescription[g]);
else throw new a.OperationError("Cannot send message",h.INVALID_SESSION_OPERATION,a.TransportReturnCodeDescription[g]);else this.updateTxStats(c)};a.Session.prototype.enqueueOutstandingDataReq=function(c,g,n,p,q){if(typeof c!=="undefined"&&c!==null){var u=this;n=setTimeout(function(){u.m_sessionStatistics.incStat(j.TX_REQUEST_TIMEOUT);try{delete u.m_outstandingDataReqs[c]}catch(t){}if(typeof g!=="undefined"&&g!==null){var r=new a.SessionEvent(b.REQUEST_TIMEOUT,"Request timeout",null,h.TIMEOUT,null,
null);g(u,r,q)}},n||this.m_sessionProperties.readTimeoutInMsecs);p=new a.OutstandingDataRequest(c,n,p,g,q);this.m_outstandingDataReqs[c]=p}};a.Session.prototype.cancelOutstandingDataReq=function(c){if(this.m_outstandingDataReqs&&typeof c!=="undefined"&&c!==null){var g=this.m_outstandingDataReqs[c];if(typeof g!=="undefined"){if(typeof g.timer!=="undefined"&&g.timer!==null){clearTimeout(g.timer);g.timer=null}try{delete this.m_outstandingDataReqs[c]}catch(n){}return g}}return null};a.Session.prototype.enqueueOutstandingCtrlReq=
function(c,g,n,p,q,u){if(typeof c!=="undefined"&&c!==null){g=setTimeout(g,n||this.m_sessionProperties.readTimeoutInMsecs);p=new a.OutstandingCtrlRequest(c,g,p,q,u);this.m_outstandingCtrlReqs[c]=p}};a.Session.prototype.cancelOutstandingCtrlReq=function(c){if(this.m_outstandingCtrlReqs&&typeof c!=="undefined"&&c!==null){var g=this.m_outstandingCtrlReqs[c];if(typeof g!=="undefined"){if(typeof g.timer!=="undefined"&&g.timer!==null){clearTimeout(g.timer);g.timer=null}try{delete this.m_outstandingCtrlReqs[c]}catch(n){}return g}}return null};
a.Session.prototype.addToSubscriptionCache=function(c){if(this.m_subscriptionCache&&typeof c!=="undefined"&&c!==null){var g=c.getKey();if(typeof this.m_subscriptionCache[g]==="undefined"){this.m_subscriptionCache[g]=c;this.m_subscriptionCacheCount++}else this.m_subscriptionCache[g]=c}};a.Session.prototype.removeFromSubscriptionCache=function(c){if(this.m_subscriptionCache&&typeof c!=="undefined"&&c!==null){c=c instanceof a.Topic?c.getKey():c;var g=this.m_subscriptionCache[c];if(typeof g!=="undefined"){try{delete this.m_subscriptionCache[c]&&
this.m_subscriptionCacheCount--}catch(n){}return g}}return null};a.Session.prototype.resetKeepAliveCounter=function(){this.m_keepAliveCounter=0};a.Session.prototype.handleSmfMessage=function(c){if(this.shallNotifyClient()){var g,n;try{this.updateRxStats(c);var p=c.getSmfHeader(),q=p.m_pm_respcode,u=p.m_pm_respstr,t;switch(p.m_smf_protocol){case 13:if(q!==0){n=a.ErrorResponseSubCodeMapper.getErrorSubCode(q,u);g=new a.SessionEvent(b.REJECTED_MESSAGE_ERROR,u,q,n,null,null);this.sendEvent(g)}else this.handleDataMessage(c);
break;case 12:var r=p.m_pm_corrtag||"";t=this.cancelOutstandingCtrlReq(r);if(typeof t==="undefined"||t===null){this.changeState(9);g=new a.SessionEvent(b.INTERNAL_ERROR,"Cannot find matching request for response: "+u,q,h.INTERNAL_ERROR,null,null);this.sendEvent(g)}else t.respRecvdCallback&&t.respRecvdCallback(c);break;case 15:r=p.m_pm_corrtag||"";var v=a.Util.stripNullTerminate(c.EncodedUtf8Subscription);t=this.cancelOutstandingCtrlReq(r);if(this.m_sessionState===6)if(typeof t==="undefined"||t===
null){this.changeState(9);g=new a.SessionEvent(b.INTERNAL_ERROR,"Cannot find matching request for response: "+u,q,h.INTERNAL_ERROR,null,null);this.sendEvent(g)}else t.respRecvdCallback&&t.respRecvdCallback(c);else if(this.m_sessionState===11)if(typeof t==="undefined"||t===null){n=a.ErrorResponseSubCodeMapper.getErrorSubCode(q,u);if(!(n===h.SUBSCRIPTION_ALREADY_PRESENT&&this.m_sessionProperties.ignoreDuplicateSubscriptionError)){g=new a.SessionEvent(b.REAPPLY_SUBSCRIPTION_ERROR,u,q,n,null,"Topic: "+
v);this.sendEvent(g)}}else t.respRecvdCallback&&t.respRecvdCallback(c);else if(typeof t==="undefined"||t===null)this.handleSubscriptionUpdateError(q,u,v,null);else t.respRecvdCallback&&t.respRecvdCallback(c,t);break;case 10:case 11:break;default:this.changeState(9);if(p.m_smf_protocol===20){g=new a.SessionEvent(b.PARSE_FAILURE,"Received message with unknown protocol",null,h.DATA_ERROR_OTHER,null,null);this.sendEvent(g)}else this.m_sessionStatistics.incStat(j.RX_DISCARD_SMF_UNKNOWN_ELEMENT)}}catch(w){this.changeState(9);
g=new a.SessionEvent(b.INTERNAL_ERROR,"Exception in handleSmfMessage: "+w.message,0,h.INTERNAL_ERROR,null,null);this.sendEvent(g)}}};a.Session.prototype.handleDataMessage=function(c){var g,n;if(this.m_sessionProperties.generateReceiveTimestamps)c.m_receiverTimestamp=(new Date).getTime();if(c.isReplyMessage()){g=c.getCorrelationId();if(typeof g!=="undefined"&&g!==null){n=this.cancelOutstandingDataReq(g);if(n===null)if(g.indexOf("#REQ")===0){this.m_sessionStatistics.incStat(j.RX_REPLY_MSG_DISCARD);
return}else{if(g.indexOf(a.CacheRequestPrefix)===0&&!(a.CacheMessageRxCBInfo&&this.m_messageCallbackInfo instanceof a.CacheMessageRxCBInfo)){this.m_sessionStatistics.incStat(j.RX_REPLY_MSG_DISCARD);return}}else{this.m_sessionStatistics.incStat(j.RX_REPLY_MSG_RECVED);n.replyReceivedCBFunction(this,c,n.userObject);return}}}if(this.m_messageCallbackInfo)this.m_messageCallbackInfo.userObject?this.m_messageCallbackInfo.messageRxCBFunction(this,c,this.m_messageCallbackInfo.userObject):this.m_messageCallbackInfo.messageRxCBFunction(this,
c)};a.Session.prototype.handleSmfParseError=function(c){if(this.shallNotifyClient()){this.changeState(9);this.sendEvent(new a.SessionEvent(b.PARSE_FAILURE,c.message,null,c.subcode||h.DATA_ERROR_OTHER,null,null))}};a.Session.prototype.handleTransportEvent=function(c){var g,n=c.getInfoStr()||"",p=c.toString();if(!(c.getSessionEventCode()!==i.DESTROYED_NOTICE&&!this.shallNotifyClient()))switch(c.getSessionEventCode()){case i.UP_NOTICE:this.clearConnectTimer();this.m_lastKnownGoodTransport=this.m_transportProtocolHandler.getTransportProtocol();
this.changeState(3);this.m_sessionId=c.getSessionId()||"";this.sendClientCtrl();break;case i.DESTROYED_NOTICE:g=this.m_sessionState;this.changeState(1);this.cleanupSession();if(g===2||g===4)if(this.m_transportProtocolHandler.shouldRetry()){this.m_transportProtocolHandler.handleConnectFailed(c);this.connectInternal();break}g=b.DISCONNECTED;c=new a.SessionEvent(g,n,null,c.getResponseCode(),null,p);this.m_disposed||this.disconnectInternal();this.sendEvent(c);if(this.disposed)this.m_eventCallbackInfo=
this.m_messageCallbackInfo=null;break;case i.CONNECTING:this.m_sessionState!==2&&this.changeState(2);break;case i.CAN_ACCEPT_DATA:if(this.m_sessionState===11)this.reapplySubscriptions();else{g=b.CAN_ACCEPT_DATA;c=new a.SessionEvent(g,n,null,c.getResponseCode(),null,p);this.sendEvent(c)}break;case i.CONNECTION_ERROR:case i.DATA_DECODE_ERROR:case i.PARSE_FAILURE:this.destroyTransportSession(n,c.getResponseCode())}};a.Session.prototype.sendClientCtrl=function(){var c;if(c=this.allowOperation(2)){c=new a.SessionEvent(b.LOGIN_FAILURE,
c,null,h.INVALID_SESSION_OPERATION,null,null);this.sendEvent(c)}else{this.changeState(4);c=a.smf.ClientCtrlMessage.getLogin(this.m_sessionProperties);var g=c.getSmfHeader().m_pm_corrtag||"",n=this,p=this.m_smfClient.send(c);if(p!==0){this.changeState(9);c=p===2?new a.SessionEvent(b.LOGIN_FAILURE,"Cannot send client control - no space in transport",null,h.INSUFFICIENT_SPACE,null,null):new a.SessionEvent(b.LOGIN_FAILURE,"Cannot send client ctrl",null,h.INVALID_SESSION_OPERATION,null,null);this.sendEvent(c)}else{this.updateTxStats(c);
c=this.m_sessionProperties.readTimeoutInMsecs;if(this.m_sessionProperties.readTimeoutInMsecs-this.m_sessionProperties.transportDowngradeTimeoutInMsecs<20)c=this.m_sessionProperties.transportDowngradeTimeoutInMsecs+20;this.enqueueOutstandingCtrlReq(g,function(){n.handleOperationTimeout(g,"Login request timeout")},c,0,null,function(q){n.handleClientCtrlResponse(q)})}}};a.Session.prototype.handleClientCtrlResponse=function(c){var g=c.getResponse(),n=g.ResponseCode;g=g.ResponseString;if(n===200){if(this.m_sessionProperties.noLocal===
true){g=c.getRouterCapabilities();var p=true;p=g?typeof g[a.CapabilityType.NO_LOCAL]==="boolean"?g[a.CapabilityType.NO_LOCAL]:false:false;if(!p){this.m_inReconnect=false;this.changeState(9);n=new a.SessionEvent(b.LOGIN_FAILURE,"No Local is not supported by the appliance",n,h.NO_LOCAL_NOT_SUPPORTED,null,null);this.sendEvent(n);return}}this.changeState(5);this.updateReadonlySessionProps(c);this.sendP2PInboxReg()}else{this.m_inReconnect=false;this.changeState(9);c=a.ErrorResponseSubCodeMapper.getErrorSubCode(n,
g);n=new a.SessionEvent(b.LOGIN_FAILURE,g,n,c,null,null);this.sendEvent(n)}};a.Session.prototype.sendP2PInboxReg=function(){var c=this.allowOperation(3);if(c)this.sendEvent(new a.SessionEvent(b.P2P_SUB_ERROR,c,null,h.INVALID_SESSION_OPERATION,null,null));else{this.changeState(6);c=m.getP2PTopicSubscription(this.m_sessionProperties.p2pInboxBase);var g=this;this.subscriptionUpdate(new a.Topic(c),true,null,this.m_sessionProperties.readTimeoutInMsecs,1,function(n){g.handleP2PRegResponse(n)})}};a.Session.prototype.handleP2PRegResponse=
function(c){var g=c.getResponse();c=g.ResponseCode;g=g.ResponseString;var n;if(c===200)if(this.m_inReconnect&&this.m_sessionProperties.reapplySubscriptions&&this.m_subscriptionCache&&this.m_subscriptionCacheCount>0){this.changeState(7);this.clearSubscriptionCacheKeys();this.m_subscriptionCacheKeys=[];for(n in this.m_subscriptionCache)this.m_subscriptionCache.hasOwnProperty(n)&&this.m_subscriptionCacheKeys.push(n);this.reapplySubscriptions()}else{this.m_inReconnect=false;this.changeState(8);this.scheduleKeepAlive();
c=new a.SessionEvent(b.UP_NOTICE,l("Session is up (transport:{0})",this.m_transportProtocolHandler),c,0,null,null);this.sendEvent(c)}else{this.m_inReconnect=false;this.changeState(9);n=a.ErrorResponseSubCodeMapper.getErrorSubCode(c,g);c=new a.SessionEvent(b.P2P_SUB_ERROR,g,c,n,null,null);this.sendEvent(c)}};a.Session.prototype.sendUpdateP2PInboxReg=function(c,g,n,p){var q=this.allowOperation(4);q?this.sendEvent(new a.SessionEvent(b.PROPERTY_UPDATE_ERROR,q,null,h.INVALID_SESSION_OPERATION,n,null)):
this.subscriptionUpdate(new a.Topic(g),true,null,this.m_sessionProperties.readTimeoutInMsecs,c?7:8,p)};a.Session.prototype.handleOperationTimeout=function(c,g){this.m_inReconnect=false;try{delete this.m_outstandingCtrlReqs[c]}catch(n){}if(this.shallNotifyClient()){this.changeState(9);this.sendEvent(new a.SessionEvent(b.REQUEST_TIMEOUT,g,null,h.TIMEOUT,null,null))}};a.Session.prototype.scheduleKeepAlive=function(){var c=this;this.m_keepAliveTimer&&clearInterval(this.m_keepAliveTimer);this.m_kaWatchdog&&
clearInterval(this.m_kaWatchdog);c.m_kaWatchdog=0;c.m_kaWatchdogCount=0;this.m_keepAliveTimer=setInterval(function(){try{c.sendKeepAlive();c.m_kaWatchdogCount=0}catch(g){}},this.m_sessionProperties.keepAliveIntervalInMsecs);this.m_kaWatchdog=setInterval(function(){c.m_kaWatchdogCount++;c.m_kaWatchdogCount>=2&&c.scheduleKeepAlive()},this.m_sessionProperties.keepAliveIntervalInMsecs*3)};a.Session.prototype.sendKeepAlive=function(){var c;if(c=this.allowOperation(4)){if(this.shallNotifyClient()){c=new a.SessionEvent(b.KEEP_ALIVE_ERROR,
c,null,h.INVALID_SESSION_OPERATION,null,null);this.sendEvent(c)}}else if(this.m_keepAliveCounter>=this.m_sessionProperties.keepAliveIntervalsLimit){this.m_kaWatchdog&&clearInterval(this.m_kaWatchdog);this.m_keepAliveTimer&&clearInterval(this.m_keepAliveTimer);this.changeState(9);c=new a.SessionEvent(b.KEEP_ALIVE_ERROR,"Exceed maximum keep alive intervals limit",null,h.KEEP_ALIVE_FAILURE,null,null);this.sendEvent(c)}else{c=new a.smf.KeepAliveMessage;var g=this.m_smfClient,n=g.getClientStats().msgWritten,
p=g.getClientStats().bytesWritten;if(this.m_smfClient.send(c,true)!==0){if(this.shallNotifyClient()){this.changeState(9);c=new a.SessionEvent(b.KEEP_ALIVE_ERROR,"Cannot send keep alive message",null,h.COMMUNICATION_ERROR,null,null);this.sendEvent(c)}}else{this.updateTxStats(c);this.m_kaStats.lastMsgWritten===n&&this.m_kaStats.lastBytesWritten<p||this.m_keepAliveCounter++;this.m_kaStats.lastBytesWritten=g.getClientStats().bytesWritten;this.m_kaStats.lastMsgWritten=g.getClientStats().msgWritten}}};
a.Session.prototype.reapplySubscriptions=function(){if(this.m_sessionState!==11){var c=this.allowOperation(6);if(c){this.m_inReconnect=false;this.clearSubscriptionCacheKeys();this.sendEvent(new a.SessionEvent(b.SUBSCRIPTION_ERROR,c,null,h.INVALID_SESSION_OPERATION,null,null));return}this.changeState(11)}var g=this;c=function(q){g.handleApplySubscriptionResponse(q)};if(this.m_subscriptionCacheKeys){var n=null;try{for(;this.m_subscriptionCacheKeys.length>0;){n=this.m_subscriptionCacheKeys[0];this.m_subscriptionCacheKeys.length===
1?this.subscriptionUpdate(this.m_subscriptionCache[n],true,null,this.m_sessionProperties.readTimeoutInMsecs,4,c):this.subscriptionUpdate(this.m_subscriptionCache[n],false,null,this.m_sessionProperties.readTimeoutInMsecs,4,null);this.m_subscriptionCacheKeys.shift()}}catch(p){if(!(p.name&&p.name==="OperationError"&&p.subcode===h.INSUFFICIENT_SPACE))throw p;}}};a.Session.prototype.handleApplySubscriptionResponse=function(c){var g=c.getResponse(),n=g.ResponseCode;g=g.ResponseString;this.m_inReconnect=
false;this.clearSubscriptionCacheKeys();if(n!==200){var p=a.Util.stripNullTerminate(c.EncodedUtf8Subscription);c=a.ErrorResponseSubCodeMapper.getErrorSubCode(n,g);if(!(c===h.SUBSCRIPTION_ALREADY_PRESENT&&this.m_sessionProperties.ignoreDuplicateSubscriptionError)){g=new a.SessionEvent(b.REAPPLY_SUBSCRIPTION_ERROR,g,n,c,null,"Topic: "+p);this.sendEvent(g)}}this.changeState(8);this.scheduleKeepAlive();g=new a.SessionEvent(b.UP_NOTICE,l("Session is up (transport:{0})",this.m_transportProtocolHandler.getTransportProtocol()),
n,0,null,null);this.sendEvent(g)};a.Session.prototype.handleSubscriptionUpdateResponse=function(c,g){var n=c.getResponse(),p=n.ResponseCode;n=n.ResponseString;if(p===200){p=new a.SessionEvent(b.SUBSCRIPTION_OK,n,p,0,g.correlationKey,null);this.sendEvent(p)}else{var q=a.Util.stripNullTerminate(c.EncodedUtf8Subscription);this.handleSubscriptionUpdateError(p,n,q,g)}};a.Session.prototype.handleSubscriptionUpdateError=function(c,g,n,p){var q=a.ErrorResponseSubCodeMapper.getErrorSubCode(c,g),u=b.SUBSCRIPTION_ERROR,
t=null;if(p!==null)t=p.correlationKey;if(q===h.SUBSCRIPTION_ALREADY_PRESENT&&this.m_sessionProperties.ignoreDuplicateSubscriptionError||q===h.SUBSCRIPTION_NOT_FOUND&&this.m_sessionProperties.ignoreSubscriptionNotFoundError){if(p!==null){c=new a.SessionEvent(b.SUBSCRIPTION_OK,g,c,0,t,null);this.sendEvent(c)}}else{if(q===h.SUBSCRIPTION_ALREADY_PRESENT||q===h.SUBSCRIPTION_NOT_FOUND)c=new a.SessionEvent(u,g,c,q,t,"Topic: "+n);else if(q===h.SUBSCRIPTION_ATTRIBUTES_CONFLICT||q===h.SUBSCRIPTION_INVALID||
q===h.SUBSCRIPTION_ACL_DENIED||q===h.SUBSCRIPTION_TOO_MANY){this.removeFromSubscriptionCache(n);c=new a.SessionEvent(u,g,c,q,t,"Topic: "+n)}else{this.removeFromSubscriptionCache(n);c=new a.SessionEvent(u,g,c,h.SUBSCRIPTION_ERROR_OTHER,t,"Topic: "+n)}this.sendEvent(c)}};a.Session.prototype.getEventCBInfo=function(){return this.m_eventCallbackInfo};a.Session.prototype.setEventCBInfo=function(c){this.m_eventCallbackInfo=c};a.Session.prototype.getMessageCBInfo=function(){return this.m_messageCallbackInfo};
a.Session.prototype.setMessageCBInfo=function(c){this.m_messageCallbackInfo=c};a.Session.prototype.cleanupSession=function(){this.m_sessionId=null;this.m_inReconnect=false;if(typeof this.m_keepAliveTimer!=="undefined"&&this.m_keepAliveTimer!==null){clearInterval(this.m_keepAliveTimer);clearInterval(this.m_kaWatchdog);this.m_keepAliveTimer=null}this.resetKeepAliveCounter();var c;if(this.m_outstandingCtrlReqs)for(c in this.m_outstandingCtrlReqs)this.m_outstandingCtrlReqs.hasOwnProperty(c)&&this.cancelOutstandingCtrlReq(c);
if(this.m_outstandingDataReqs){var g;for(c in this.m_outstandingDataReqs)if(this.m_outstandingDataReqs.hasOwnProperty(c)){g=this.cancelOutstandingDataReq(c);if(g!==null&&typeof g.reqFailedCBFunction!=="undefined"&&g.reqFailedCBFunction!==null){var n=new a.SessionEvent(b.REQUEST_ABORTED,"Request aborted",null,h.SESSION_NOT_CONNECTED,null,null);g.reqFailedCBFunction(this,n,g.userObject)}}}};a.Session.prototype.destroyTransportSession=function(c,g){if(typeof this.m_smfClient!=="undefined"&&this.m_smfClient!==
null){var n=this.m_smfClient;this.m_smfClient=null;n.destroy(true,c,g)}};a.Session.prototype.clearSubscriptionCacheKeys=function(){if(this.m_subscriptionCacheKeys){try{for(;this.m_subscriptionCacheKeys.length>0;)this.m_subscriptionCacheKeys.shift()}catch(c){}this.m_subscriptionCacheKeys=null}};a.Session.prototype.getTransportInfo=function(){if(typeof this.m_smfClient==="undefined"||this.m_smfClient!==null)return"Not connected.";return this.m_smfClient.getTransportSessionInfoStr()};a.Session.prototype.getSessionIdForLogging=
function(){return" (sessionId="+(s.notEmpty(this.m_sessionId)?a.Util.formatHexString(this.m_sessionId):"N/A")+")"};a.ResponseErrorMap=function(c,g,n){this.respErrorCode=c;this.respErrorStr=g;this.errSubCode=n};a.ErrorResponseSubCodeMapper={};a.ErrorResponseSubCodeMapper.getErrorSubCode=function(c,g){if(c===a.ErrorResponseSubCodeMapper.ResponseCode.E200_OK)return 0;var n,p,q=a.ErrorResponseSubCodeMapper.ResponseErrorMapping,u=q.length;for(n=0;n<u;n++){p=q[n];if(p.respErrorCode===c)if(p.respErrorStr===
null||g.toLowerCase().indexOf(p.respErrorStr.toLowerCase())>=0)return p.errSubCode}n=new a.StringBuffer("Cannot find error subcode for response error code=");n.append(c).append(", response string");n.append(g);return h.UNKNOWN_ERROR};a.ErrorResponseSubCodeMapper.ResponseCode={E200_OK:200,E400:400,E401:401,E403:403,E404:404,E503:503,E507:507};a.ErrorResponseSubCodeMapper.ResponseErrorStr={ER_XML_PARSE_ERROR:"xml parse error",ER_DOC_TOO_LARGE:"document is too large",ER_MSG_TOO_LARGE:"message too long",
ER_TOO_MANY_CLIENTS:"too many clients",ER_SUB_DELETE_IN_PROGRESS:"subscriber delete in progress",ER_INVALID_VIRTUAL_IP:"invalid virtual router address",ER_SUB_ALREADY_PRESENT:"subscription already exists",ER_SUB_NOT_FOUND:"subscription not found",ER_SUB_PARSE_ERROR:"subscription parse error",ER_SUB_MAX_NUMBER_EXCEEDED:"max num subscriptions exceeded",ER_TOPIC_PARSE_ERROR:"topic parse error",ER_NOT_ENOUGH_SPACE:"not enough space",ER_MSG_VPN_NOT_ALLOWED:"message vpn not allowed",ER_MSG_VPN_UNAVAILABLE:"message vpn unavailable",
ER_CLIENT_USERNAME_IS_SHUTDOWN:"client username is shutdown",ER_DYNAMIC_CLIENTS_NOT_ALLOWED:"dynamic clients not allowed",ER_CLIENT_NAME_ALREADY_IN_USE:"client name already in use",ER_CLIENT_NAME_PARSE_ERROR:"client name parse error",ER_FORBIDDEN:"Forbidden",ER_SUBSCRIPTION_ACL_DENIED:"Subscription ACL Denied",ER_PUBLISH_ACL_DENIED:"Publish ACL Denied",ER_SUBSCRIPTION_ATTRIBUTES_CONFLICT_WITH_EXISTING_SUBSCRIPTION:"Subscription Attributes Conflict With Existing Subscription",ER_INACTIVITY_TIMEOUT:"Inactivity Timeout",
ER_UNKNOWN_TRANSPORT_SESSION_ID:"Unknown Transport Session Identifier",ER_REPLICATION_IS_STANDBY:"Replication Is Standby"};a.ErrorResponseSubCodeMapper.ResponseErrorMapping=function(){var c=a.ErrorResponseSubCodeMapper.ResponseCode,g=a.ErrorResponseSubCodeMapper.ResponseErrorStr;return[new a.ResponseErrorMap(c.E401,null,h.LOGIN_FAILURE),new a.ResponseErrorMap(c.E404,null,h.LOGIN_FAILURE),new a.ResponseErrorMap(c.E403,g.ER_INVALID_VIRTUAL_IP,h.INVALID_VIRTUAL_ADDRESS),new a.ResponseErrorMap(c.E403,
g.ER_MSG_VPN_NOT_ALLOWED,h.MESSAGE_VPN_NOT_ALLOWED),new a.ResponseErrorMap(c.E403,g.ER_CLIENT_USERNAME_IS_SHUTDOWN,h.CLIENT_USERNAME_IS_SHUTDOWN),new a.ResponseErrorMap(c.E403,g.ER_DYNAMIC_CLIENTS_NOT_ALLOWED,h.DYNAMIC_CLIENTS_NOT_ALLOWED),new a.ResponseErrorMap(c.E403,g.ER_CLIENT_NAME_ALREADY_IN_USE,h.CLIENT_NAME_ALREADY_IN_USE),new a.ResponseErrorMap(c.E503,g.ER_SUB_DELETE_IN_PROGRESS,h.CLIENT_DELETE_IN_PROGRESS),new a.ResponseErrorMap(c.E503,g.ER_TOO_MANY_CLIENTS,h.TOO_MANY_CLIENTS),new a.ResponseErrorMap(c.E503,
g.ER_MSG_VPN_UNAVAILABLE,h.MESSAGE_VPN_UNAVAILABLE),new a.ResponseErrorMap(c.E400,g.ER_CLIENT_NAME_PARSE_ERROR,h.CLIENT_NAME_INVALID),new a.ResponseErrorMap(c.E403,g.ER_FORBIDDEN,h.CLIENT_ACL_DENIED),new a.ResponseErrorMap(c.E400,g.ER_XML_PARSE_ERROR,h.XML_PARSE_ERROR),new a.ResponseErrorMap(c.E400,g.ER_DOC_TOO_LARGE,h.MESSAGE_TOO_LARGE),new a.ResponseErrorMap(c.E400,g.ER_MSG_TOO_LARGE,h.MESSAGE_TOO_LARGE),new a.ResponseErrorMap(c.E400,g.ER_TOPIC_PARSE_ERROR,h.INVALID_TOPIC_SYNTAX),new a.ResponseErrorMap(c.E403,
g.ER_PUBLISH_ACL_DENIED,h.PUBLISH_ACL_DENIED),new a.ResponseErrorMap(c.E400,g.ER_SUB_ALREADY_PRESENT,h.SUBSCRIPTION_ALREADY_PRESENT),new a.ResponseErrorMap(c.E400,g.ER_SUB_NOT_FOUND,h.SUBSCRIPTION_NOT_FOUND),new a.ResponseErrorMap(c.E400,g.ER_SUB_PARSE_ERROR,h.SUBSCRIPTION_INVALID),new a.ResponseErrorMap(c.E400,g.ER_SUB_MAX_NUMBER_EXCEEDED,h.SUBSCRIPTION_TOO_MANY),new a.ResponseErrorMap(c.E400,g.ER_NOT_ENOUGH_SPACE,h.OUT_OF_RESOURCES),new a.ResponseErrorMap(c.E403,g.ER_SUBSCRIPTION_ACL_DENIED,h.SUBSCRIPTION_ACL_DENIED),
new a.ResponseErrorMap(c.E400,g.ER_SUBSCRIPTION_ATTRIBUTES_CONFLICT_WITH_EXISTING_SUBSCRIPTION,h.SUBSCRIPTION_ATTRIBUTES_CONFLICT),new a.ResponseErrorMap(c.E400,g.ER_INACTIVITY_TIMEOUT,h.INACTIVITY_TIMEOUT),new a.ResponseErrorMap(c.E400,g.ER_UNKNOWN_TRANSPORT_SESSION_ID,h.UNKNOWN_TRANSPORT_SESSION_ID),new a.ResponseErrorMap(c.E403,g.ER_REPLICATION_IS_STANDBY,h.REPLICATION_IS_STANDBY)]}();a.OutstandingDataRequest=function(c,g,n,p,q){this.correlationId=c;this.timer=g;this.replyReceivedCBFunction=n;
this.reqFailedCBFunction=p;this.userObject=q};a.OutstandingCtrlRequest=function(c,g,n,p,q){this.correlationTag=c;this.timer=g;this.requestType=n;this.correlationKey=p;this.respRecvdCallback=q};a.CacheRequestPrefix="#CRQ"})(solace);
(function(a){function h(d,j,e){j=j;if(d.length-j<10)return false;var f=new a.TransportSmfMessage;f.setSmfHeader(e);var l=a.Convert.strToInt16(d.substr(j,2));j+=2;f.UH=k(l,15,1);f.MessageType=k(l,8,7);l=k(l,0,8);f.TsHeaderLength=l;f.SessionId=d.substr(j,8);j+=8;if(f.MessageType===1){var c=a.Convert.strToInt8(d.substr(j,1));j++;if(d.length-j<c)return false;f.RouterTag=d.substr(j,c)}f.PayloadLength=e.m_payloadLength===4294967295?e.m_payloadLength:e.m_payloadLength-l;return f}function b(d){function j(g,
n,p){p=p();typeof p!=="undefined"&&p!==null&&e.addField(g,a.SDTField.create(n,p))}var e=new a.SDTMapContainer;j("ci",a.SDTFieldType.STRING,function(){return d.getCorrelationId()});j("mi",a.SDTFieldType.STRING,function(){return d.getApplicationMessageId()});j("mt",a.SDTFieldType.STRING,function(){return d.getApplicationMessageType()});j("rt",a.SDTFieldType.DESTINATION,function(){return d.getReplyTo()});j("si",a.SDTFieldType.STRING,function(){return d.getSenderId()});j("sn",a.SDTFieldType.INT64,function(){return d.getSequenceNumber()});
j("ts",a.SDTFieldType.INT64,function(){return d.getSenderTimestamp()});var f=new a.SDTMapContainer;d.getUserPropertyMap()&&f.addField("p",a.SDTField.create(a.SDTFieldType.MAP,d.getUserPropertyMap()));e.getKeys().length>0&&f.addField("h",a.SDTField.create(a.SDTFieldType.MAP,e));var l=null,c=0;switch(d.getType()){case a.MessageType.BINARY:c|=128;break;case a.MessageType.MAP:c|=10;(l=a.sdt.Codec.encodeSdt(d.m_structuredContainer))&&d.setBinaryAttachment(l);break;case a.MessageType.STREAM:c|=11;(l=a.sdt.Codec.encodeSdt(d.m_structuredContainer))&&
d.setBinaryAttachment(l);break;case a.MessageType.TEXT:c|=7;(l=a.sdt.Codec.encodeSdt(d.m_structuredContainer))&&d.setBinaryAttachment(l)}l=0;if(d.isReplyMessage())l|=128;l=a.SDTField.create(a.SDTFieldType.BYTEARRAY,String.fromCharCode(c,l));c=new a.SDTStreamContainer;c.addField(l);c.addField(a.SDTField.create(a.SDTFieldType.MAP,f));f=new a.smf.BinaryMetaBlock;f.Type=0;f.Payload=a.sdt.Codec.encodeSdt(a.SDTField.create(a.SDTFieldType.STREAM,c));d.setBinaryMetadataChunk(f)}function i(d,j,e,f){if(typeof e!==
"undefined"&&e!==null&&e.length>0){var l=new a.smf.Codec.ParamParse.ContentSummaryElement;l.Type=f;l.Length=e.length;d.push(l);j.push(e)}}a.smf=a.smf||{};var k=function(d,j,e){return d>>>j&(1<<e)-1},m=function(d,j,e,f){f=(1<<f)-1;j=(j&f)<<e;d&=~(f<<e);return d|j};a.smf.Codec={bits:k,setBits:m};a.smf.Codec.isSmfHeaderAvailable=function(d,j){if(d.length-j<12)return false;return true};a.smf.Codec.isSmfHeaderValid=function(d,j){if(!a.smf.Codec.isSmfHeaderAvailable(d,j))return false;if((a.Convert.strToInt8(d.substr(j+
0,1))&7)!==3)return false;return true};a.smf.Codec.isSmfAvailable=function(d,j){if(!a.smf.Codec.isSmfHeaderValid(d,j))return false;var e=d.length-j;return a.Convert.strToUInt32(d.substr(j+8,4))<=e};a.smf.Codec.parseSmfAt=function(d,j,e){if(!this.isSmfHeaderValid(d,j))return false;var f=j,l=a.Convert.strToInt32(d.substr(f+0,4)),c=a.Convert.strToUInt32(d.substr(f+4,4)),g=a.Convert.strToUInt32(d.substr(f+8,4)),n=new a.smf.SMFHeader;n.m_smf_di=k(l,31,1);n.m_smf_elidingeligible=k(l,30,1);n.m_smf_dto=k(l,
29,1);n.m_smf_adf=k(l,28,1);n.m_smf_version=k(l,24,3);n.m_smf_uh=k(l,22,2);n.m_smf_protocol=k(l,16,6);n.m_smf_priority=k(l,12,4);n.m_smf_ttl=k(l,0,8);l=g-c;if(l<0)return false;n.setMessageSizes(c,l);if(e)return n;for(f+=12;f<j+c;){l=a.Convert.strToInt8(d.substr(f,1));f++;k(l,6,2);var p=g=0;e=0;if(k(l,5,1)!==0){g=k(l,2,3);p=k(l,0,2)+1;e=p-1;if(p<=0)return false;switch(g){case 0:n.m_pm_corrtag=a.Convert.strToInt24(d.substr(f,3));break;case 1:l=this.ParamParse.parseTopicQueueOffsets(d,f);n.m_pm_queue_offset=
l[0];n.m_pm_queue_len=l[1];break;case 2:l=this.ParamParse.parseTopicQueueOffsets(d,f);n.m_pm_topic_offset=l[0];n.m_pm_topic_len=l[1]}}else{g=k(l,0,5);if(g===0)break;p=a.Convert.strToInt8(d.substr(f,1));f++;if(p===0){p=a.Convert.strToUInt32(d.substr(f,4));f+=4;e=p-6}else e=p-2;if(p<=0)return false;switch(g){case 3:n.m_pm_msg_priority=a.Convert.strToInt8(d.substr(f,1));break;case 4:n.m_pm_userdata=d.substr(f,e);break;case 6:n.m_pm_username=a.base64_decode(d.substr(f,e));break;case 7:n.m_pm_password=
a.base64_decode(d.substr(f,e));break;case 8:l=this.ParamParse.parseResponseParam(d,f,e);n.m_pm_respcode=l[0];n.m_pm_respstr=l[1];break;case 16:n.m_pm_deliverymode=this.ParamParse.parseDeliveryMode(d,f);break;case 17:n.m_pm_ad_msgid=0;break;case 18:n.m_pm_ad_prevmsgid=0;break;case 19:n.m_pm_ad_redelflag=true;break;case 20:n.m_pm_ad_ttl=0;break;case 22:if(l=this.ParamParse.parseContentSummary(d,f,e))n.m_pm_content_summary=l;else return false;break;case 23:n.m_pm_ad_flowid=0;break;case 24:n.m_pm_tr_topicname_bytes=
d.substr(f,e-1);break;case 25:n.m_pm_ad_flowredelflag=true}}f+=e}return n};a.smf.Codec.ParamParse=function(){var d=function(){var e=[];e[0]=a.MessageDeliveryModeType.NON_PERSISTENT;e[1]=a.MessageDeliveryModeType.PERSISTENT;e[2]=a.MessageDeliveryModeType.DIRECT;return e}(),j=function(){var e=[];e[a.MessageDeliveryModeType.NON_PERSISTENT]=a.Convert.int8ToStr(0);e[a.MessageDeliveryModeType.PERSISTENT]=a.Convert.int8ToStr(1);e[a.MessageDeliveryModeType.DIRECT]=a.Convert.int8ToStr(2);return e}();return{parseTopicQueueOffsets:function(e,
f){var l=[];l[0]=a.Convert.strToInt8(e.substr(f,1));l[1]=a.Convert.strToInt8(e.substr(f+1,1));return l},parseResponseParam:function(e,f,l){var c=[];c[0]=a.Convert.strToInt32(e.substr(f,4));l=l-4;c[1]=l>0?e.substr(f+4,l):"";return c},parseDeliveryMode:function(e,f){var l=a.Convert.strToInt8(e.substr(f,1));return d[l]||a.MessageDeliveryModeType.DIRECT},encDeliveryMode:function(e){return j[e]||j[a.MessageDeliveryModeType.DIRECT]},ContentSummaryType:{XML_META:0,XML_PAYLOAD:1,BINARY_ATTACHMENT:2,CID_LIST:3,
BINARY_METADATA:4},ContentSummaryElement:function(){this.Type=null;this.Length=this.Position=0},parseContentSummary:function(e,f,l){for(var c=[],g=0,n=f;n<f+l;){var p=a.Convert.strToInt8(e.substr(n,1)),q=k(p,4,4),u=k(p,0,4);p=0;switch(u){case 2:p=a.Convert.strToInt8(e.substr(n+1,1));break;case 3:p=a.Convert.strToInt16(e.substr(n+1,2));break;case 4:p=a.Convert.strToInt24(e.substr(n+1,3));break;case 5:p=a.Convert.strToInt32(e.substr(n+1,4))}var t=n;n+=u;if(t===n)return null;u=new this.ContentSummaryElement;
u.Position=g;u.Length=p;g+=p;switch(q){case 0:u.Type=this.ContentSummaryType.XML_META;break;case 1:u.Type=this.ContentSummaryType.XML_PAYLOAD;break;case 2:u.Type=this.ContentSummaryType.BINARY_ATTACHMENT;break;case 3:u.Type=this.ContentSummaryType.CID_LIST;break;case 4:u.Type=this.ContentSummaryType.BINARY_METADATA}c.push(u)}return c},encContentSummary:function(e){for(var f=[],l=0;l<e.length;l++){var c=e[l],g="",n=0;n=m(n,c.Type,4,4);if(c.Length<=255){n=m(n,2,0,4);g=a.Convert.int8ToStr(c.Length)}else if(c.Length<=
65535){n=m(n,3,0,4);g=a.Convert.int16ToStr(c.Length)}else if(c.Length<=16777215){n=m(n,4,0,4);g=a.Convert.int24ToStr(c.Length)}else{n=m(n,5,0,4);g=a.Convert.int32ToStr(c.Length)}f.push(a.Convert.int8ToStr(n));f.push(g)}return f.join("")},encSmfParam:function(e,f,l){var c=[],g=0,n=0;g=m(g,e,6,2);g=m(g,f,0,5);c.push(a.Convert.int8ToStr(g));if(l.length<=253){n=l.length+2;c.push(a.Convert.int8ToStr(n))}else{n=0;c.push(a.Convert.int8ToStr(n));c.push(a.Convert.int32ToStr(l.length+6))}c.push(l);return c.join("")},
encLightSmfParam:function(e,f,l){var c=[],g=0;g=m(g,e,6,2);g=m(g,1,5,1);g=m(g,f,2,3);g=m(g,l.length,0,2);c.push(a.Convert.int8ToStr(g));c.push(l);return c.join("")}}}();a.smf.Codec.encSmf=function(d){var j=[],e=0;if(d.m_smf_di)e=m(e,d.m_smf_di,31,1);if(d.m_smf_elidingeligible)e=m(e,d.m_smf_elidingeligible,30,1);if(d.m_smf_dto)e=m(e,d.m_smf_dto,29,1);if(d.m_smf_adf)e=m(e,d.m_smf_adf,28,1);if(d.m_smf_version)e=m(e,d.m_smf_version,24,3);if(d.m_smf_uh)e=m(e,d.m_smf_uh,22,2);if(d.m_smf_protocol)e=m(e,
d.m_smf_protocol,16,6);if(d.m_smf_priority)e=m(e,d.m_smf_priority,12,4);if(d.m_smf_ttl)e=m(e,d.m_smf_ttl,0,8);var f=[];d.m_pm_tr_topicname_bytes&&f.push(a.smf.Codec.ParamParse.encSmfParam(2,24,d.m_pm_tr_topicname_bytes+"\u0000"));var l=0;if(d.m_pm_queue_len){l=0;l=m(l,d.m_pm_queue_offset,8,8);l=m(l,d.m_pm_queue_len,0,8);f.push(a.smf.Codec.ParamParse.encLightSmfParam(0,2,a.Convert.int16ToStr(l)))}if(d.m_pm_topic_len){l=0;l=m(l,d.m_pm_topic_offset,8,8);l=m(l,d.m_pm_topic_len,0,8);f.push(a.smf.Codec.ParamParse.encLightSmfParam(0,
1,a.Convert.int16ToStr(l)))}d.m_pm_corrtag!==null&&f.push(a.smf.Codec.ParamParse.encLightSmfParam(0,0,a.Convert.int24ToStr(d.m_pm_corrtag)));d.m_pm_msg_priority!==null&&f.push(a.smf.Codec.ParamParse.encSmfParam(0,3,a.Convert.int8ToStr(d.m_pm_msg_priority)));d.m_pm_userdata!==null&&d.m_pm_userdata!==""&&f.push(a.smf.Codec.ParamParse.encSmfParam(0,4,d.m_pm_userdata));if(d.m_pm_username){l=a.base64_encode(d.m_pm_username);f.push(a.smf.Codec.ParamParse.encSmfParam(0,6,l))}if(d.m_pm_password){l=a.base64_encode(d.m_pm_password);
f.push(a.smf.Codec.ParamParse.encSmfParam(0,7,l))}if(d.m_pm_respcode){l=a.Convert.int32ToStr(d.m_pm_respcode);l+=d.m_pm_respstr;f.push(a.smf.Codec.ParamParse.encSmfParam(0,8,l))}d.m_pm_deliverymode!==null&&f.push(a.smf.Codec.ParamParse.encSmfParam(0,16,a.smf.Codec.ParamParse.encDeliveryMode(d.m_pm_deliverymode)));d.m_pm_content_summary&&f.push(a.smf.Codec.ParamParse.encSmfParam(2,22,a.smf.Codec.ParamParse.encContentSummary(d.m_pm_content_summary)));f=f.join("");l=12+f.length;var c=l+d.m_payloadLength;
j.push(a.Convert.int32ToStr(e));j.push(a.Convert.int32ToStr(l));j.push(a.Convert.int32ToStr(c));j.push(f);d.setMessageSizes(l,d.m_payloadLength);return j.join("")};a.smf.Codec.Smp={parseSmpAt:function(d,j){if(j+6>d.length)return false;var e=j,f=a.Convert.strToInt8(d.substr(e,1));e++;k(f,7,1);f=k(f,0,7);var l=new a.smf.SMPMessage;if(f===0||f===1){var c=a.Convert.strToUInt32(d.substr(e,4));e+=4;if(j+c>d.length)return false;var g=a.Convert.strToInt8(d.substr(e,1));e++;l.MsgType=f;l.SmpFlags=g;l.EncodedUtf8Subscription=
d.substr(e,c-6);return l}else return false},encSmp:function(d){if(!(d.MsgType===0||d.MsgType===1))return false;var j=[],e=0;e=m(e,1,7,1);e=m(e,d.MsgType,0,7);j.push(a.Convert.int8ToStr(e));j.push(a.Convert.int32ToStr(6+d.EncodedUtf8Subscription.length));j.push(a.Convert.int8ToStr(d.SmpFlags));j.push(d.EncodedUtf8Subscription);return j.join("")}};a.smf.Codec.ClientCtrl={parseCCAt:function(d,j,e){var f=new a.smf.ClientCtrlMessage;if(e<6||j+6>d.length)return f;e=j;var l=a.Convert.strToInt16(d.substr(e,
2));e+=2;k(l,15,1);var c=k(l,8,3),g=k(l,0,8);l=a.Convert.strToUInt32(d.substr(e,4));e+=4;if(c!==1)return false;if(l<=0||j+l>d.length)return false;f.MsgType=g;for(f.Version=c;e<j+l;){g=a.Convert.strToInt8(d.substr(e,1));e++;c=k(g,7,1);g=k(g,0,7);var n=a.Convert.strToUInt32(d.substr(e,4));if(n<=0)return false;e+=4;n=n-5;var p=d.substr(e,n);f.addParameter(new a.smf.SMFParameter(c,g,p));e+=n}return f},encCC:function(d){for(var j=[],e=d.getParameterArray(),f=0;f<e.length;f++){var l=e[f];if(typeof l!==
"undefined"){var c=0;c=m(c,l.getUh(),7,1);c=m(c,l.getType(),0,7);j.push(a.Convert.int8ToStr(c));j.push(a.Convert.int32ToStr(l.getValue().length+5));j.push(l.getValue())}}j=j.join("");e=0;e=m(e,0,15,1);e=m(e,0,11,4);e=m(e,1,8,3);e=m(e,d.MsgType,0,8);d=[];d.push(a.Convert.int16ToStr(e));d.push(a.Convert.int32ToStr(6+j.length));d.push(j);return d.join("")}};a.smf.Codec.TsSmf={parseTsSmfMsgAt:function(d,j,e){e=h(d,j,e);if(!e)return false;j=j;j+=e.TsHeaderLength;if(d.length-j<e.PayloadLength)return false;
e.Payload=d.substr(j,e.PayloadLength);return e},parseTsSmfHdrAt:h};var o=function(){var d=[];d[0]=a.MessageUserCosType.COS1;d[1]=a.MessageUserCosType.COS2;d[2]=a.MessageUserCosType.COS3;return d}(),s=function(){var d=[];d[a.MessageUserCosType.COS1]=0;d[a.MessageUserCosType.COS2]=1;d[a.MessageUserCosType.COS3]=2;return d}();a.smf.Codec.decodeCompoundMessage=function(d,j){var e=a.smf.Codec.parseSmfAt(d,j);if(!e)return null;var f=j+e.m_headerLength,l=e.m_payloadLength;switch(e.m_smf_protocol){case 20:if(f=
a.smf.Codec.TsSmf.parseTsSmfMsgAt(d,f,e)){f.setSmfHeader(e);return f}break;case 13:f=new a.Message;f.m_smfHeader=e;f.setDeliverToOne(e.m_smf_dto?true:false);f.setDeliveryMode(e.m_pm_deliverymode||a.MessageDeliveryModeType.DIRECT);f.setDestination(new a.Topic(e.m_pm_tr_topicname_bytes));f.setDiscardIndication(e.m_smf_di?true:false);f.setElidingEligible(e.m_smf_elidingeligible?true:false);f.setUserCos(o[e.m_smf_priority]||a.MessageUserCosType.COS1);f.setUserData(e.m_pm_userdata?e.m_pm_userdata:null);
f.m_redelivered=e.m_pm_ad_redelflag?true:false;l=j+e.m_headerLength;var c=e.m_pm_content_summary,g=a.smf.Codec.ParamParse.ContentSummaryType;if(c&&c.length>0)for(e=0;e<c.length;e++){var n=c[e],p=d.substr(l+n.Position,n.Length);if(n.Type===g.BINARY_ATTACHMENT)f.setBinaryAttachment(p);else if(n.Type===g.BINARY_METADATA){p=a.smf.BinaryMetaBlock.fromEncodedSmf(p,0);f.setBinaryMetadataChunk(p);if(p.Type===0){n=f;if((p=a.sdt.Codec.parseSdt(p.Payload,0))&&p.getType()===a.SDTFieldType.STREAM){p=p.getValue();
var q=p.getNext();if(q&&q.getType()===a.SDTFieldType.BYTEARRAY){var u=q.getValue().charCodeAt(0)&255;if((u&128)===0)n.m_messageType={10:a.MessageType.MAP,11:a.MessageType.STREAM,7:a.MessageType.TEXT}[u&15]||a.MessageType.BINARY;if(q.getValue().length>=1){q=q.getValue().charCodeAt(1)&255;n.setAsReplyMessage((q&128)!==0)}}if((q=p.getNext())&&q.getType()===a.SDTFieldType.MAP){p=q.getValue();if(p.getField("p")){q=p.getField("p").getValue();n.setUserPropertyMap(q)}if(p.getField("h")){p=p.getField("h").getValue();
p.getField("ci")&&n.setCorrelationId(p.getField("ci").getValue());p.getField("mi")&&n.setApplicationMessageId(p.getField("mi").getValue());p.getField("mt")&&n.setApplicationMessageType(p.getField("mt").getValue());p.getField("rt")&&n.setReplyTo(p.getField("rt").getValue());p.getField("si")&&n.setSenderId(p.getField("si").getValue());p.getField("sn")&&n.setSequenceNumber(p.getField("sn").getValue());p.getField("ts")&&n.setSenderTimestamp(p.getField("ts").getValue())}}}}}else if(n.Type!==g.CID_LIST)if(n.Type===
g.XML_META)f.setXmlMetadata(p);else n.Type===g.XML_PAYLOAD&&f.setXmlContentInternal(p)}else f.setBinaryAttachment(e.m_payloadLength>0?d.substr(l,e.m_payloadLength):null);return f;case 12:if(f=a.smf.Codec.ClientCtrl.parseCCAt(d,f,l)){f.setSmfHeader(e);return f}break;case 15:if(f=a.smf.Codec.Smp.parseSmpAt(d,f)){f.setSmfHeader(e);return f}break;case 10:case 11:f=new a.smf.KeepAliveMessage;f.setSmfHeader(e);return f}return null};a.smf.Codec.encodeCompoundMessage=function(d){var j=[],e=[];if(d instanceof
a.smf.ClientCtrlMessage){j=a.smf.Codec.ClientCtrl.encCC(d);d.getSmfHeader().setPayloadSize(j.length);e=a.smf.Codec.encSmf(d.getSmfHeader())}else if(d instanceof a.smf.SMPMessage){j=a.smf.Codec.Smp.encSmp(d);d.getSmfHeader().setPayloadSize(j.length);e=a.smf.Codec.encSmf(d.getSmfHeader())}else if(d instanceof a.smf.KeepAliveMessage){d.getSmfHeader().setPayloadSize(0);e=a.smf.Codec.encSmf(d.getSmfHeader())}else if(d instanceof a.Message){if(d.m_smfHeader===null){j=new a.smf.SMFHeader;j.m_smf_protocol=
13;j.m_smf_ttl=255;d.m_smfHeader=j}j=d.m_smfHeader;j.m_smf_dto=d.isDeliverToOne()?true:false;j.m_pm_deliverymode=d.getDeliveryMode();j.m_smf_di=d.isDiscardIndication()?true:false;j.m_smf_elidingeligible=d.isElidingEligible()?true:false;e=d.getDestination();if(e!==null&&e instanceof a.Topic)j.m_pm_tr_topicname_bytes=e.getName();if(d.getCorrelationId()||d.getApplicationMessageId()||d.getApplicationMessageType()||d.getReplyTo()||d.getSenderId()||d.getSequenceNumber()||d.getSenderTimestamp()||d.getUserPropertyMap()||
d.isReplyMessage()||d.getType()!==a.MessageType.BINARY)b(d);e=d.getUserCos();j.m_smf_priority=s[e]||0;j.m_pm_userdata=d.getUserData()===null?null:d.getUserData();e=a.smf.Codec.ParamParse.ContentSummaryType;var f=[],l=[];i(f,l,d.getXmlMetadata(),e.XML_META);i(f,l,d.getXmlContent(),e.XML_PAYLOAD);i(f,l,d.getBinaryAttachment(),e.BINARY_ATTACHMENT);var c=null;if((c=d.getBinaryMetadataChunk())!==null){c=c.asEncodedSmf();i(f,l,c,e.BINARY_METADATA)}if(!(f.length===0||f.length===1&&f[0].Type===e.BINARY_ATTACHMENT))j.m_pm_content_summary=
f;e=l.join("");j.m_payload=e;j.setPayloadSize(e.length);j=d.m_smfHeader.m_payload;e=a.smf.Codec.encSmf(d.m_smfHeader)}return e+j}})(solace);
(function(a){function h(){this.m_parameters=[];this.m_smfHeader=null}function b(){this.m_parameters=[];this.m_smf_version=3;this.m_smf_adf=this.m_smf_dto=this.m_smf_elidingeligible=this.m_smf_tqd=this.m_smf_di=this.m_smf_msgLen=this.m_smf_ttl=this.m_smf_priority=this.m_smf_protocol=this.m_smf_uh=0;this.m_pm_userdata=null;this.m_pm_respcode=0;this.m_pm_deliverymode=this.m_pm_tr_topicname_bytes=this.m_pm_password=this.m_pm_username=this.m_pm_respstr=null;this.m_pm_ad_ttl=this.m_pm_ad_flowredelflag=
this.m_pm_ad_redelflag=this.m_pm_ad_msgid=0;this.m_pm_corrtag=this.m_pm_content_summary=null;this.m_pm_ad_prevmsgid=this.m_pm_queue_len=this.m_pm_queue_offset=this.m_pm_topic_len=this.m_pm_topic_offset=0;this.m_pm_msg_priority=null;this.m_pm_ad_flowid=0;this.m_unknownProtoFlag=false;this.m_headerLength=this.m_payloadLength=this.m_messageLength=0;this.m_payload=null}function i(f,l,c){this.m_type=l;this.m_value=c;this.m_uh=f}function k(){this.Type=0;this.Payload=""}function m(){this.m_smfHeader=new a.smf.SMFHeader;
this.m_smfHeader.m_smf_protocol=15;this.m_smfHeader.m_smf_ttl=1;this.MsgType=0;this.EncodedUtf8Subscription=null;this.SmpFlags=4;this.m_encodedClientName=this.m_encodedQueueName=null}function o(){this.m_smfHeader=new a.smf.SMFHeader;this.m_smfHeader.m_smf_protocol=12;this.m_smfHeader.m_smf_ttl=1;this.m_parameters=[];this.MsgType=0;this.Version=1}function s(){var f=new a.smf.SMFHeader;f.m_smf_protocol=11;f.m_smf_uh=2;f.m_smf_ttl=1;this.m_smfHeader=f}function d(){this.UH=0;this.Payload=this.RouterTag=
this.SessionId=this.MessageType=null;this.TsHeaderLength=this.PayloadLength=0;this.m_parameters=this.m_smfHeader=null}a.smf=a.smf||{};var j=a.smf.Codec.bits;h.prototype.addParameter=function(f){this.m_parameters[f.getType()]=f};h.prototype.getParameter=function(f){return this.m_parameters[f]};h.prototype.getParameterArray=function(){if(typeof this.m_parameters==="undefined")return false;return this.m_parameters};h.prototype.getSmfHeader=function(){return this.m_smfHeader};h.prototype.setSmfHeader=
function(f){this.m_smfHeader=f};h.prototype.getResponse=function(){var f=this.getSmfHeader();return f&&f.m_pm_respcode&&f.m_pm_respstr?{ResponseCode:f.m_pm_respcode,ResponseString:f.m_pm_respstr}:null};b.prototype.setMessageSizes=function(f,l){this.m_headerLength=f;this.m_payloadLength=l;this.m_messageLength=f+l};b.prototype.setPayloadSize=function(f){this.m_payloadLength=f};a.smf.SMFHeader=b;i.prototype.getType=function(){return this.m_type};i.prototype.getValue=function(){return this.m_value};i.prototype.getUh=
function(){return this.m_uh};a.smf.SMFParameter=i;k.prototype.asEncodedSmf=function(){var f=[];f.push(a.Convert.int8ToStr(1));f.push(a.Convert.int8ToStr(this.Type));f.push(a.Convert.int24ToStr(this.Payload.length));f.push(this.Payload);return f.join("")};k.fromEncodedSmf=function(f,l){if(typeof l==="undefined")l=0;if(f.length-l<6)return null;var c=a.Convert.strToInt8(f.substr(l,1)),g=a.Convert.strToInt32(f.substr(l+1,4)),n=new k;n.Type=j(g,24,8);g=j(g,0,24);n.Payload=f.substr(l+(c*4+1),g);return n};
a.smf.BinaryMetaBlock=k;m.prototype=new h;m.prototype.isFlag=function(f){return this.SmpFlags&f};m.prototype.setFlag=function(f,l){if(l)this.SmpFlags|=f;else this.SmpFlags&=~f};m.prototype.encodeTopic=function(f){this.EncodedUtf8Subscription=a.Util.nullTerminate(f)};m.getSubscriptionMessage=function(f,l,c,g){var n="";if(typeof l==="string")n=l;else if(l instanceof a.Destination)n=l.getName();l=new m;l.MsgType=c?0:1;l.encodeTopic(n);l.setFlag(4,true);g&&l.setFlag(8,true);l.m_smfHeader.m_pm_corrtag=
f;return l};a.smf.SMPMessage=m;a.Convert.int8ToStr(0);var e=new h;o.prototype=e;e.getP2PTopicValue=function(){var f=null;return(f=this.getParameter(8))?a.Util.stripNullTerminate(f.getValue()):null};e.getVpnNameInUseValue=function(){var f=null;return(f=this.getParameter(6))?a.Util.stripNullTerminate(f.getValue()):null};e.getVridInUseValue=function(){var f=null;return(f=this.getParameter(10))?a.Util.stripNullTerminate(f.getValue()):null};e.getUserIdValue=function(){var f=null;return(f=this.getParameter(3))?
a.Util.stripNullTerminate(f.getValue()):null};e.prmGetDtoPriorityValue=function(f){if(typeof f.local==="undefined"||typeof f.network==="undefined")return false;var l=0;l=a.smf.Codec.setBits(l,f.local,8,8);l=a.smf.Codec.setBits(l,f.network,0,8);return a.Convert.int16ToStr(l)};e.prmParseDtoPriorityValue=function(f){var l={};f=a.Convert.strToInt16(f.substr(0,2));l.local=a.smf.Codec.bits(f,8,8);l.network=a.smf.Codec.bits(f,0,8);return l};e.prmParseCapabilitiesValue=function(f,l){if(!(f&&l))return false;
var c=a.CapabilityType,g=0,n=a.Convert.strToInt8(f.substr(g,1));g++;var p=0;if(n>=1){a.Convert.strToInt8(f.substr(g,1));g++}if(n>=9){p=a.Convert.strToInt8(f.substr(g,1));g++;l[c.MESSAGE_ELIDING]=j(p,3,1)?true:false;l[c.NO_LOCAL]=j(p,1,1)?true:false}if(n>16)g+=Math.ceil((n-16)/8);for(n=500;g<f.length&&n-- >0;){p=a.Convert.strToInt8(f.substr(g,1));g++;var q=a.Convert.strToInt32(f.substr(g,4));g+=4;q-=5;var u=f.substr(g,q);g+=q;switch(p){case 0:l[c.PEER_PORT_SPEED]=u.length===4?a.Convert.strToInt32(u):
0;break;case 1:l[c.PEER_PORT_TYPE]=u.length===1?a.Convert.strToInt8(u):0;break;case 3:l[c.MAX_DIRECT_MSG_SIZE]=u.length===4?a.Convert.strToInt32(u):0}}return l};e.getRouterCapabilities=function(){var f=[],l=null;if(l=this.getParameter(9))f=this.prmParseCapabilitiesValue(l.getValue(),f);if(l=this.getParameter(0))f[a.CapabilityType.PEER_SOFTWARE_VERSION]=a.Util.stripNullTerminate(l.getValue());if(l=this.getParameter(1))f[a.CapabilityType.PEER_SOFTWARE_DATE]=a.Util.stripNullTerminate(l.getValue());if(l=
this.getParameter(2))f[a.CapabilityType.PEER_PLATFORM]=a.Util.stripNullTerminate(l.getValue());if(l=this.getParameter(12))f[a.CapabilityType.PEER_ROUTER_NAME]=a.Util.stripNullTerminate(l.getValue());return f};o.getLogin=function(f,l){var c=new a.smf.ClientCtrlMessage;if(!(f instanceof a.SessionProperties))return false;c.MsgType=0;var g=c.m_smfHeader;g.m_pm_corrtag=l;var n=f.authenticationScheme===a.AuthenticationScheme.AUTHENTICATION_SCHEME_CLIENT_CERTIFICATE;if(f.password&&!n)g.m_pm_password=f.password;
if(f.userName)g.m_pm_username=f.userName;f.subscriberLocalPriority&&f.subscriberNetworkPriority&&c.addParameter(new i(0,7,this.prototype.prmGetDtoPriorityValue({local:f.subscriberLocalPriority,network:f.subscriberNetworkPriority})));f.vpnName&&f.vpnName.length>0&&c.addParameter(new i(1,6,a.Util.nullTerminate(f.vpnName)));f.applicationDescription&&f.applicationDescription.length>0&&c.addParameter(new i(0,4,a.Util.nullTerminate(f.applicationDescription)));f.userIdentification&&f.userIdentification.length>
0&&c.addParameter(new i(0,3,a.Util.nullTerminate(f.userIdentification)));c.addParameter(new i(0,5,a.Util.nullTerminate(f.clientName)));c.addParameter(new i(0,2,a.Util.nullTerminate(navigator.platform+" - JS API (Release)")));f.noLocal&&c.addParameter(new i(0,15,a.Convert.int8ToStr(1)));n&&c.addParameter(new i(1,17,a.Convert.int8ToStr(1)));var p="20170829-1148";g="20170829-1148".substring(0,8);n="20170829-1148".substring(9);if(g.length===8&&n.length===4){p=new a.StringBuffer;p.append(g.charAt(0)).append(g.charAt(1));
p.append(g.charAt(2)).append(g.charAt(3));p.append("/");p.append(g.charAt(4)).append(g.charAt(5));p.append("/");p.append(g.charAt(6)).append(g.charAt(7));p.append(" ");p.append(n.charAt(0)).append(n.charAt(1));p.append(":");p.append(n.charAt(2)).append(n.charAt(3));p=p.toString()}c.addParameter(new i(0,1,a.Util.nullTerminate(p)));c.addParameter(new i(0,0,a.Util.nullTerminate("7.2.1.43")));return c};o.getUpdate=function(f,l,c){var g=new o;g.MsgType=1;g.m_smfHeader.m_pm_corrtag=c;if(f===a.MutableSessionProperty.CLIENT_DESCRIPTION){l=
(l+"").substr(0,250);g.addParameter(new i(0,4,a.Util.nullTerminate(l)))}else if(f===a.MutableSessionProperty.CLIENT_NAME){if(f=o.validateClientName(l))throw new a.OperationError(f,a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);g.addParameter(new i(0,5,a.Util.nullTerminate(l)))}return g};o.validateClientName=function(f){var l=a.TopicUtil.validateTopic(f);if(l)return l;if(l=f.length<=160?null:"Client Name too long (max length: 160).")return l;return null};a.smf.ClientCtrlMessage=o;s.prototype=new h;a.smf.KeepAliveMessage=
s;d.prototype=new h;a.TransportSmfMessage=d})(solace);
(function(a){a.CacheCBInfo=function(h,b){this.cacheCBFunction=h;this.userObject=b};a.CacheCBInfo.prototype.getCallback=function(){return this.cacheCBFunction};a.CacheCBInfo.prototype.getUserObject=function(){return this.userObject};a.CacheLiveDataAction={FULFILL:1,QUEUE:2,FLOW_THRU:3};a.CacheGetResult=function(){this.messageID=null;this.version=0;this.responseCode=a.CacheGetResultCode.INVALID;this.matchTopic=this.responseString="";this.clusterNameStream=this.messageStream=this.replyTo=this.hasTimestamps=
this.hasMore=this.isSuspect=this.sessionID=null};a.CacheGetResult.prototype.readFromStream=function(h){this.messageID=h.getNext().getValue();this.version=h.getNext().getValue();this.responseCode=h.getNext().getValue();this.responseString=h.getNext().getValue();this.matchTopic=h.getNext().getValue();this.sessionID=h.getNext().getValue();this.isSuspect=h.getNext().getValue();this.hasMore=h.getNext().getValue();this.hasTimestamps=h.getNext().getValue();if(h.hasNext())this.messageStream=h.getNext().getValue();
if(h.hasNext()){this.clusterNameStream=this.messageStream;this.messageStream=h.getNext().getValue()}};a.CacheGetResultCode={INVALID:0,OK:1};a.CacheRequestCorrelationID=0;a.CacheRequest=function(h,b,i,k,m,o,s){this.cacheSession=h;this.cacheMessageType=b;this.requestID=i;this.cbInfo=k;this.liveDataAction=m;this.topic=o;this.cacheName=s;this.subscriptionWaiting=null;this.isSuspect=this.dataReceived=this.replyReceived=false;this.correlationID=a.CacheRequestPrefix+a.CacheRequestCorrelationID++;this.childRequests=
[];this.parentRequest=null;this.queuedLiveData=[];this.liveDataFulfilled=false;this.timeoutHandle=null};a.CacheRequest.VERSION=1;a.CacheRequest.DEFAULT_REPLY_SIZE_LIMIT=1E6;a.CacheRequest.REPLY_SIZE_LIMIT=a.CacheRequest.DEFAULT_REPLY_SIZE_LIMIT;a.CacheRequest.prototype.getRootRequest=function(){if(!this.parentRequest)return this;return this.parentRequest.getRootRequest()};a.CacheRequest.prototype.addChild=function(h){if(h===this)throw Error("Constructing circular child reference");h.parentRequest=
this;this.childRequests.push(h)};a.CacheRequest.prototype.removeChild=function(h){if(h===this)throw Error("Attempting to deconstruct invalid circular child reference");this.childRequests.splice(this.childRequests.indexOf(h),1);h.parentRequest=null};a.CacheRequest.prototype.collapse=function(){var h=this.parentRequest;h.isSuspect=h.isSuspect||this.isSuspect;h.dataReceived=h.dataReceived||this.dataReceived;h.removeChild(this)};a.CacheRequest.prototype.cancel=function(){this.parentRequest&&this.collapse();
for(var h,b=0;b<this.childRequests.length;b++){h=this.childRequests[b];h.childRequests&&h.cancel();this.removeChild(h)}this.clearRequestTimeout()};a.CacheRequest.prototype.getRequestID=function(){return this.requestID};a.CacheRequest.prototype.getCBInfo=function(){return this.cbInfo};a.CacheRequest.prototype.getTopic=function(){return this.topic};a.CacheRequest.prototype.getLiveDataAction=function(){return this.liveDataAction};a.CacheRequest.prototype.startRequestTimeout=function(h,b){var i=this;
this.timeoutHandle=setTimeout(function(){h(i)},b)};a.CacheRequest.prototype.clearRequestTimeout=function(){if(this.timeoutHandle!==null){clearTimeout(this.timeoutHandle);this.timeoutHandle=null}};a.CacheRequest.prototype.toString=function(){return"CacheRequest[correlationID="+this.correlationID+",requestID="+this.requestID+",cacheName="+this.cacheName+",topic="+this.topic.getName()+"]"};a.CacheRequestType={INVALID:0,BULK_MSG:1,REGISTER_REQUEST:2,REGISTER_RESPONSE:3,HEARTBEAT_REQUEST:4,HEARTBEAT_RESPONSE:5,
EVENT_NOTIFY:6,EVENT_ACK:7,ACTION_REQUEST:8,ACTION_RESPONSE:9,GET_REQUEST:10,GET_RESPONSE:11,GET_NEXT_REQUEST:12,GET_NEXT_RESPONSE:13,SET_REQUEST:14,SET_RESPONSE:15,GET_MSG_REQUEST:16,GET_MSG_RESPONSE:17,GET_NEXT_MSG_REQUEST:18,GET_NEXT_MSG_RESPONSE:19,UNREGISTER_IND:20,BULK_SET_REQUEST:21,BULK_SET_RESPONSE:22,PURGE_MSG_SEQUENCE_REQUEST:23,PURGE_MSG_SEQUENCE_RESPONSE:24,GET_MSG_SEQUENCE_REQUEST:25,GET_NEXT_MSG_SEQUENCE_REQUEST:26,GET_TOPIC_INFO_REQUEST:27,GET_TOPIC_INFO_RESPONSE:28,READY_MARKER:29,
GET_TOPIC_INFO_REQUEST_RANGE:30,SYNC_READY_MARKER:31,VACUUM_REQUEST:32,VACUUM_RESPONSE:33};a.CacheRequestResult=function(h,b,i,k){this.returnCode=h;this.subcode=b;this.topic=i;this.error=k};a.CacheRequestResult.prototype.getReturnCode=function(){return this.returnCode};a.CacheRequestResult.prototype.getReturnSubcode=function(){return this.subcode};a.CacheRequestResult.prototype.getTopic=function(){return this.topic};a.CacheRequestResult.prototype.getError=function(){return this.error};a.CacheReturnCode=
{OK:1,FAIL:2,INCOMPLETE:3};a.CacheReturnSubcode={REQUEST_COMPLETE:0,LIVE_DATA_FULFILL:1,ERROR_RESPONSE:2,INVALID_SESSION:3,REQUEST_TIMEOUT:4,REQUEST_ALREADY_IN_PROGRESS:5,NO_DATA:6,SUSPECT_DATA:7,CACHE_SESSION_DISPOSED:8,SUBSCRIPTION_ERROR:9};a.CacheSession=function(h,b){this.validateProps(h);this.properties=new a.CacheSessionProperties(h.cacheName,h.maxAgeSec,h.maxMessages,h.timeoutMsec);this.outstandingRequests={};this.outstandingIDs={};this.session=b;this.disposed=false;this.nextSessionEventCallbackInfo=
this.nextMessageCallbackInfo=null;this.connectToSession(b)};a.CacheSession.prototype.validateProps=function(h){if(typeof h.cacheName!=="string")throw new a.OperationError("Invalid parameter type for cacheName",a.ErrorSubcode.PARAMETER_INVALID_TYPE);var b=a.TopicUtil.validateTopic(h.cacheName);if(b)throw new a.OperationError(b,a.ErrorSubcode.INVALID_TOPIC_SYNTAX,null);if(typeof h.maxAgeSec!=="number")throw new a.OperationError("Invalid parameter type for maxAgeSec",a.ErrorSubcode.PARAMETER_INVALID_TYPE);
if(h.maxAgeSec<0)throw new a.OperationError("Invalid value for maxAgeSec; must be >= 0",a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);if(typeof h.maxMessages!=="number")throw new a.OperationError("Invalid parameter type for maxMessages",a.ErrorSubcode.PARAMETER_INVALID_TYPE);if(h.maxMessages<0)throw new a.OperationError("Invalid value for maxMessages; must be >= 0",a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);if(typeof h.timeoutMsec!=="number")throw new a.OperationError("Invalid parameter type for timeoutMsec",
a.ErrorSubcode.PARAMETER_INVALID_TYPE);if(h.timeoutMsec<3E3)throw new a.OperationError("Invalid value for timeoutMsec; must be >= 3000",a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);};a.CacheSession.prototype.connectToSession=function(h){this.nextSessionEventCallbackInfo=h.getEventCBInfo();this.nextMessageCallbackInfo=h.getMessageCBInfo();var b=this;h.setMessageCBInfo(new a.CacheMessageRxCBInfo(function(i,k){b.handleMessage(k)},null));h.setEventCBInfo(this.createCompoundEventCB(this.nextSessionEventCallbackInfo))};
a.CacheSession.prototype.createCompoundEventCB=function(h){var b=this;return new a.SessionEventCBInfo(function(i,k,m,o){b.handleSessionEvent(h,i,k,m,o)},null)};a.CacheSession.prototype.handleSessionEvent=function(h,b,i){if(this.processSessionEvent(b,i)){var k=h.userObject;k===null?h.sessionEventCBFunction(b,i):h.sessionEventCBFunction(b,i,k)}};a.CacheSession.prototype.sendToNextDelegate=function(h){var b=this.nextMessageCallbackInfo.userObject;b===null?this.nextMessageCallbackInfo.messageRxCBFunction(this.session,
h):this.nextMessageCallbackInfo.messageRxCBFunction(this.session,h,b)};a.CacheSession.prototype.processSessionEvent=function(h,b){switch(b.sessionEventCode){case a.SessionEventCode.SUBSCRIPTION_ERROR:case a.SessionEventCode.SUBSCRIPTION_OK:return this.checkSubscriptionStatus(b);case a.SessionEventCode.DOWN_ERROR:this.dispose();return true;default:return true}};a.CacheSession.prototype.checkSubscriptionStatus=function(h){if(h.correlationKey===null||!(h.correlationKey instanceof a.CacheSessionSubscribeInfo)||
h.correlationKey.cacheSession!==this)return true;var b=this.getOutstandingRequest(h.correlationKey.correlationID);if(!b)return true;h.sessionEventCode===a.SessionEventCode.SUBSCRIPTION_OK?this.handleSubscriptionSuccess(b,h.correlationKey.topic):this.handleSubscriptionError(b,h);return false};a.CacheSession.prototype.handleSubscriptionSuccess=function(h){h.subscriptionWaiting=null;this.startCacheRequest(h)};a.CacheSession.prototype.handleSubscriptionError=function(h){this.terminateRequest(h,a.CacheReturnCode.FAIL,
a.CacheReturnSubcode.SUBSCRIPTION_ERROR)};a.CacheSession.prototype.checkRequestCompletion=function(h){if(!h.childRequests.length)if(!h.subscriptionWaiting)if(!(h.timeoutHandle!==null&&!h.replyReceived))if(h.parentRequest){var b=h.parentRequest;h.cancel();this.unregisterRequest(h);this.checkRequestCompletion(b)}else{var i;if(h.isSuspect){b=a.CacheReturnCode.INCOMPLETE;i=a.CacheReturnSubcode.SUSPECT_DATA}else if(h.dataReceived){b=a.CacheReturnCode.OK;i=h.liveDataFulfilled?a.CacheReturnSubcode.LIVE_DATA_FULFILL:
a.CacheReturnSubcode.REQUEST_COMPLETE}else if(h.replyReceived){b=a.CacheReturnCode.INCOMPLETE;i=a.CacheReturnSubcode.NO_DATA}else throw Error("Sanity: should never happen");this.terminateRequest(h,b,i)}};a.CacheSession.prototype.sendSeeOther=function(h,b){var i=b.clusterNameStream.getNext().getValue();h.getRootRequest();i=new a.CacheRequest(this,a.CacheRequestType.GET_MSG_REQUEST,h.requestID,new a.CacheCBInfo(this.swallowChildReply,null),h.liveDataAction,h.topic,i);h.addChild(i);this.registerRequest(i);
i.startRequestTimeout(this.handleCacheRequestTimeout,this.properties.timeoutMsec);this.startCacheRequest(i,null,null,true)};a.CacheSession.prototype.sendGetNext=function(h,b){var i=new a.CacheRequest(this,a.CacheRequestType.GET_NEXT_MSG_REQUEST,h.requestID,new a.CacheCBInfo(this.swallowChildReply,null),h.liveDataAction,h.topic,h.cacheName);h.addChild(i);this.registerRequest(i);i.startRequestTimeout(this.handleCacheRequestTimeout,this.properties.timeoutMsec);this.startCacheRequest(i,b.sessionID,b.replyTo)};
a.CacheSession.prototype.decodeMessageStream=function(h,b){if(!b.messageStream)return[];for(var i,k=[];b.messageStream.hasNext();){h.dataReceived=true;i=b.messageStream.getNext().getValue();if(i=a.smf.Codec.decodeCompoundMessage(i,0)){i.setCacheStatus(b.isSuspect?a.MessageCacheStatus.SUSPECT:a.MessageCacheStatus.CACHED);i.setCacheRequestID(h.requestID);k.push(i)}}return k};a.CacheSession.prototype.handleMessage=function(h){var b=h.getCorrelationId();if(b=b?this.outstandingRequests[b]:null){b.clearRequestTimeout();
var i=h.getSdtContainer();(i=i&&i.getValue())||this.terminateRequest(b,a.CacheReturnCode.FAIL,a.CacheReturnSubcode.ERROR_RESPONSE);this.incStat(a.StatType.RX_REPLY_MSG_RECVED);b.replyReceived=true;if(b.getRootRequest().liveDataFulfilled){this.incStat(a.StatType.CACHE_REQUEST_FULFILL_DISCARD_RESPONSE);this.checkRequestCompletion(b)}else if(i)try{var k=new a.CacheGetResult;k.readFromStream(i);k.replyTo=h.getReplyTo();b.isSuspect=b.isSuspect||k.isSuspect;var m=this.decodeMessageStream(b,k);this.incStat(a.StatType.RX_CACHE_MSG,
m.length);k.hasMore&&this.sendGetNext(b,k);if(k.clusterNameStream)for(;k.clusterNameStream.hasNext();)this.sendSeeOther(b,k);if(m)for(h=0;h<m.length;h++)this.sendToNextDelegate(m[h]);this.checkRequestCompletion(b)}catch(o){this.terminateRequest(b,a.CacheReturnCode.FAIL,a.CacheReturnSubcode.ERROR_RESPONSE)}}else this.relevantLiveData(h)&&this.sendToNextDelegate(h)};a.CacheSession.prototype.relevantLiveData=function(h){if(h.getCorrelationId()&&h.getCorrelationId().indexOf(a.CacheRequestPrefix)===0&&
!(this.nextMessageCallbackInfo instanceof a.CacheMessageRxCBInfo)){this.incStat(a.StatType.RX_REPLY_MSG_DISCARD);return false}var b=true,i;for(i in this.outstandingRequests)if(typeof i==="string"){var k=this.outstandingRequests[i];if(k.topic.getName()===h.getDestination().getName())b=b&&this.performLiveDataAction(k,h)}return b};a.CacheSession.prototype.performLiveDataAction=function(h,b){h.dataReceived=true;switch(h.liveDataAction){case a.CacheLiveDataAction.QUEUE:h.queuedLiveData.push(b);return false;
case a.CacheLiveDataAction.FULFILL:h.liveDataFulfilled||this.fulfillRequest(h);return true;default:return true}};a.CacheSession.prototype.fulfillRequest=function(h){h.liveDataFulfilled=true;this.trackCompletionStats(a.CacheReturnCode.OK,a.CacheReturnSubcode.LIVE_DATA_FULFILL);var b=this;setTimeout(function(){b.notifyCallback(h,a.CacheReturnCode.OK,a.CacheReturnSubcode.LIVE_DATA_FULFILL,h.getTopic(),null)},0)};a.CacheSession.prototype.dispose=function(){var h=[],b;for(b in this.outstandingRequests)this.outstandingRequests[b]instanceof
a.CacheRequest&&h.push(this.outstandingRequests[b]);for(b=0;b<h.length;b++)this.terminateRequest(h[b],a.CacheReturnCode.INCOMPLETE,a.CacheReturnSubcode.CACHE_SESSION_DISPOSED);this.outstandingRequests=[];this.session.setEventCBInfo(this.nextSessionEventCallbackInfo);this.session.setMessageCBInfo(this.nextMessageCallbackInfo);this.disposed=true};a.CacheSession.prototype.getProperties=function(){return this.properties};a.CacheSession.prototype.sendCacheRequest=function(h,b,i,k,m){if(arguments.length!==
5)throw new a.OperationError("sendCacheRequest() invoked with an illegal argument count of "+arguments.length);if(typeof i!=="boolean")throw new a.OperationError("Invalid subscribe flag argument, should be a boolean but was "+typeof i);if(typeof h!=="number")throw new a.OperationError("Invalid requestID",a.ErrorSubcode.PARAMETER_INVALID_TYPE,null);if(this.outstandingIDs[h])throw new a.OperationError("Request already in progress with this requestID");if(!(b instanceof a.Topic))throw new a.OperationError("Invalid topic",
a.ErrorSubcode.PARAMETER_INVALID_TYPE,typeof b);var o=a.TopicUtil.validateTopic(b.getName());if(o)throw new a.OperationError(o,a.ErrorSubcode.INVALID_TOPIC_SYNTAX);if(!(k===a.CacheLiveDataAction.FLOW_THRU||k===a.CacheLiveDataAction.FULFILL||k===a.CacheLiveDataAction.QUEUE))throw new a.OperationError("Invalid live data action",a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);if(a.TopicUtil.isWildcarded(b.getName())&&k!==a.CacheLiveDataAction.FLOW_THRU)throw new a.OperationError("Wildcarded topic not supported for this live data action",
a.ErrorSubcode.PARAMETER_CONFLICT);if(!(m instanceof a.CacheCBInfo))throw new a.OperationError("Callback info was not an instance of solace.CacheCBInfo");if(this.disposed)m.cacheCBFunction(h,a.CacheReturnCode.FAIL,a.CacheReturnSubcode.CACHE_SESSION_DISPOSED);else{this.session.m_disposed&&m.cacheCBFunction(h,a.CacheReturnCode.FAIL,a.CacheReturnSubcode.INVALID_SESSION);o=new a.CacheRequest(this,a.CacheRequestType.GET_MSG_REQUEST,h,m,k,b,this.properties.cacheName);for(var s in this.outstandingRequests)if(this.outstandingRequests[s].topic.getName()===
b.getName())if(!(k===this.outstandingRequests[s].liveDataAction&&k===a.CacheLiveDataAction.FLOW_THRU)){this.registerRequest(o);this.terminateRequest(o,a.CacheReturnCode.FAIL,a.CacheReturnSubcode.REQUEST_ALREADY_IN_PROGRESS);return}this.registerRequest(o);o.startRequestTimeout(this.handleCacheRequestTimeout,this.properties.timeoutMsec);if(i){s=new a.CacheSessionSubscribeInfo(o.correlationID,b,this);o.subscriptionWaiting=s;this.session.subscribe(b,true,s)}else this.startCacheRequest(o)}};a.CacheSession.prototype.swallowChildReply=
function(){};a.CacheSession.prototype.handleCacheRequestFailed=function(h,b,i){this.terminateRequest(i.getRequestID(),a.CacheReturnCode.FAIL,a.CacheReturnSubcode.ERROR_RESPONSE)};a.CacheSession.prototype.registerRequest=function(h){this.outstandingRequests[h.correlationID]=h;h.parentRequest||(this.outstandingIDs[h.requestID]=h)};a.CacheSession.prototype.getOutstandingRequest=function(h){return this.outstandingRequests[h]};a.CacheSession.prototype.startCacheRequest=function(h,b,i,k){var m=a.SolclientFactory.createMessage();
h.getRequestID();m.setCorrelationId(h.correlationID);i?m.setDestination(i):m.setDestination(a.SolclientFactory.createTopic(this.properties.cachePrefix+h.cacheName));m.setReplyTo(a.SolclientFactory.createTopic(this.session.getSessionProperties().p2pInboxInUse));m.setDeliverToOne(h.cacheMessageType===a.CacheRequestType.GET_MSG_REQUEST);i=new a.SDTStreamContainer;i.addField(a.SDTFieldType.UINT32,h.cacheMessageType);i.addField(a.SDTFieldType.UINT32,a.CacheRequest.VERSION);i.addField(a.SDTFieldType.STRING,
h.topic.getName());i.addField(a.SDTFieldType.UINT32,a.CacheRequest.REPLY_SIZE_LIMIT);typeof b==="number"&&i.addField(a.SDTFieldType.UINT32,b);i.addField(a.SDTFieldType.UINT32,this.properties.maxMessages);i.addField(a.SDTFieldType.UINT32,this.properties.maxAgeSec);h.cacheMessageType===a.CacheRequestType.GET_MSG_REQUEST&&i.addField(a.SDTFieldType.BOOL,this.properties.includeOtherClusters&&!k);i.addField(a.SDTFieldType.BOOL,false);h.cacheMessageType===a.CacheRequestType.GET_MSG_REQUEST&&i.addField(a.SDTFieldType.UINT32,
Math.round(this.properties.timeoutMsec/1E3));m.setSdtContainer(a.SDTField.create(a.SDTFieldType.STREAM,i));try{this.session.send(m);h.parentRequest||this.incStat(a.StatType.CACHE_REQUEST_SENT)}catch(o){this.terminateRequest(h,a.CacheReturnCode.FAIL,a.CacheReturnSubcode.ERROR_RESPONSE,o)}};a.CacheSession.prototype.incStat=function(h,b){this.session&&this.session.m_sessionStatistics&&this.session.m_sessionStatistics.incStat(h,b)};a.CacheSession.prototype.handleCacheRequestTimeout=function(h){var b=
h.cacheSession;b.getOutstandingRequest(h.correlationID)&&b.terminateRequest(h.getRootRequest(),a.CacheReturnCode.INCOMPLETE,a.CacheReturnSubcode.REQUEST_TIMEOUT)};a.CacheSession.prototype.unregisterRequest=function(h){delete this.outstandingRequests[h.correlationID];delete this.outstandingIDs[h.requestID]};a.CacheSession.prototype.notifyCallback=function(h,b,i,k,m){var o=h.cbInfo;o.getCallback()(h.requestID,new a.CacheRequestResult(b,i,k,m),o.getUserObject())};a.CacheSession.prototype.trackCompletionStats=
function(h,b){switch(h){case a.CacheReturnCode.OK:this.incStat(a.StatType.CACHE_REQUEST_OK_RESPONSE);b===a.CacheReturnSubcode.LIVE_DATA_FULFILL&&this.incStat(a.StatType.CACHE_REQUEST_LIVE_DATA_FULFILL);break;case a.CacheReturnCode.INCOMPLETE:this.incStat(a.StatType.CACHE_REQUEST_INCOMPLETE_RESPONSE);break;case a.CacheReturnCode.FAIL:this.incStat(a.StatType.CACHE_REQUEST_FAIL_RESPONSE);break;default:throw Error("Sanity: no return code supplied");}};a.CacheSession.prototype.terminateRequest=function(h,
b,i,k){h=h.getRootRequest();if(this.outstandingRequests[h.correlationID]){var m=h.cbInfo;if(m)if(m.getCallback()){m=h.getTopic();for(var o=0;o<h.queuedLiveData.length;o++)this.sendToNextDelegate(h.queuedLiveData[o]);h.cancel();this.unregisterRequest(h);if(!h.liveDataFulfilled){this.trackCompletionStats(b,i);this.notifyCallback(h,b,i,m,k)}}}};a.CacheSessionProperties=function(h,b,i,k){this.cacheName=h;this.maxAgeSec=b||0;this.maxMessages=i===null||typeof i==="undefined"?1:i;this.timeoutMsec=k||1E4;
this.includeOtherClusters=true;this.cachePrefix="#P2P/CACHEINST/"};a.CacheSessionProperties.prototype.getCacheName=function(){return this.cacheName};a.CacheSessionProperties.prototype.setCacheName=function(h){this.cacheName=h};a.CacheSessionProperties.prototype.getMaxMessageAgeSec=function(){return this.maxAgeSec};a.CacheSessionProperties.prototype.setMaxMessageAgeSec=function(h){this.maxAgeSec=h};a.CacheSessionProperties.prototype.getMaxMessages=function(){return this.maxMessages};a.CacheSessionProperties.prototype.setMaxMessages=
function(h){this.maxMessages=h};a.CacheSessionProperties.prototype.getTimeoutMsec=function(){return this.timeoutMsec};a.CacheSessionProperties.prototype.setTimeoutMsec=function(h){this.timeoutMsec=h};a.CacheSessionSubscribeInfo=function(h,b,i){this.correlationID=h;this.topic=b;this.cacheSession=i};a.CacheMessageRxCBInfo=function(){a.MessageRxCBInfo.apply(this,arguments)}})(solace);
(function(a){a.TsSmf=function(){function h(){return a.Convert.int32ToStr(51642369)+a.Convert.int32ToStr(12)}return{genTsCreateHeader:function(){return h()+a.Convert.int32ToStr(22)+a.Convert.int16ToStr(32778)+a.Convert.int32ToStr(0)+a.Convert.int32ToStr(0)},genTsDestroyHeader:function(b){return h()+a.Convert.int32ToStr(22)+a.Convert.int16ToStr(33290)+b},genTsDataTokenMsg:function(b){return a.Convert.int32ToStr(60030977)+a.Convert.int32ToStr(12)+a.Convert.int32ToStr(22)+a.Convert.int16ToStr(34058)+
b},genTsDataStreamTokenMsg:function(b,i){return a.Convert.int32ToStr(60030977)+a.Convert.int32ToStr(12)+a.Convert.int32ToStr(24)+a.Convert.int16ToStr(34316)+b+(i&&i>0?a.Convert.int16ToStr(i):a.Convert.int16ToStr(0))},genTsDataMsgHeaderParts:function(b){return[a.Convert.int32ToStr(60030977)+a.Convert.int32ToStr(12),a.Convert.int16ToStr(33802)+b]}}}()})(solace);
(function(a){function h(){this.PacketReadState=s.SMF_NEW;this.TopSmfHeader=null;this.TotalPayloadToRead=0;this.TransportMessageCurrent=null;this.m_bytesRead=0;this.m_inputbuf="";this.remaining=function(){return this.m_inputbuf.length-this.m_bytesRead};this.enqueue=function(d){this.m_inputbuf+=d};this.getBuffer=function(){return this.m_inputbuf};this.advanceBuffer=function(d){this.m_bytesRead+=d;if(this.m_bytesRead===this.m_inputbuf.length){this.m_bytesRead=0;this.m_inputbuf=""}};this.position=function(){return this.m_bytesRead}}
function b(d,j){return d.m_queuedDataSize===0||j+d.m_queuedDataSize<=d.m_sendBufferMaxSize}function i(d){d.m_alertOnDequeue=true;return 2}function k(d){var j="",e=d.m_maxPayloadBytes;if(d.getBufferedAmount){e=d.m_maxPayloadBytes-d.getBufferedAmount();if(e<=0){if(d.m_bufferedAmountQueryIntervalInMsecs*d.m_bufferedAmountQueryIntervalDelayMultiplier<=4E3)d.m_bufferedAmountQueryIntervalDelayMultiplier*=2;return j}else d.m_bufferedAmountQueryIntervalDelayMultiplier=1}if(d.m_queuedDataSize>e){e=e;for(var f,
l;e&&d.m_queuedDataSize;){f=d.m_queuedData[0];l=f.length;if(l>e){j+=f.substr(0,e);d.m_queuedData[0]=f.substr(e);d.m_queuedDataSize-=e;e=0}else{j+=d.m_queuedData.shift();e-=l;d.m_queuedDataSize-=l;d.m_clientstats.msgWritten++}}}else{j=d.m_queuedData.join("");d.m_clientstats.msgWritten+=d.m_queuedData.length;d.m_queuedData=[];d.m_queuedDataSize=0}return j}function m(d,j,e,f,l){this.m_incomingBuffer="";this.m_rxSmfCB=j;this.m_rxMessageErrorCB=e;this.m_rxTransportEventCB=f;this.m_correlationCounter=0;
this.m_session=l;var c=this;switch(d.transportProtocol){case a.TransportProtocol.HTTP_BASE64:case a.TransportProtocol.HTTP_BINARY:case a.TransportProtocol.HTTP_BINARY_STREAMING:this.m_transportSession=new a.HTTPTransportSession(d.url,function(g){c.handleTransportEvent(g)},function(g){c.rxDataCB(g)},d);break;case a.TransportProtocol.WS_BINARY:this.m_transportSession=new a.WebSocketTransportSession(d.url,function(g){c.handleTransportEvent(g)},function(g){c.rxDataCB(g)},d);break;default:throw new a.OperationError("No transport session provider for scheme: "+
d.transportProtocol,a.ErrorSubcode.INTERNAL_CONNECTION_ERROR,d.transportProtocol);}}function o(d){function j(){this.m_ssl=false;this.m_transportProtocol=o.defaultTransportProtocol;this.m_transportFamily=a.TransportFamily.HTTP;this.m_unsupportedRuntimeMessage="not supported by this runtime: "+(window&&window.navigator?window.navigator.userAgent:"(unknown)");this.m_nextStateOnFail=null;this.m_name="PARENT";this.shouldRetry=function(){return this.m_nextStateOnFail!==null};this.getTransportProtocol=function(){return this.m_transportProtocol};
this.getTransportFamily=function(){return this.m_transportFamily};this.handleConnectFailed=function(p){this.m_nextStateOnFail&&g.switchState(this.m_nextStateOnFail,p)};this.validateLegal=function(){};this.toString=function(){return this.m_transportProtocol+(this.m_ssl?" (SSL)":"")};this.setUseSsl=function(p){this.m_ssl=!!p};this.getUseSsl=function(){return this.m_ssl}}function e(p){this.setUseSsl(p);this.m_transportProtocol=a.TransportProtocol.HTTP_BASE64;this.m_transportFamily=this.getUseSsl()?a.TransportFamily.HTTPS:
a.TransportFamily.HTTP;this.m_nextStateOnFail=null;this.m_name=this.m_transportProtocol.toString()}function f(p){this.setUseSsl(p);this.m_transportProtocol=a.TransportProtocol.HTTP_BINARY;this.m_transportFamily=this.getUseSsl()?a.TransportFamily.HTTPS:a.TransportFamily.HTTP;this.m_nextStateOnFail=new e(p);this.validateLegal=function(){a.HttpConnection.browserSupportsXhrBinary()||g.switchState(this.m_nextStateOnFail,this.m_unsupportedRuntimeMessage)}}function l(p){this.setUseSsl(p);this.m_transportProtocol=
a.TransportProtocol.HTTP_BINARY_STREAMING;this.m_transportFamily=this.getUseSsl()?a.TransportFamily.HTTPS:a.TransportFamily.HTTP;this.m_nextStateOnFail=new f(p);this.m_name=this.m_transportProtocol.toString();this.validateLegal=function(){a.HttpConnection.browserSupportsStreamingResponse()&&a.HttpConnection.browserSupportsXhrBinary()||g.switchState(this.m_nextStateOnFail,this.m_unsupportedRuntimeMessage)}}function c(p){this.setUseSsl(p);this.m_transportProtocol=a.TransportProtocol.WS_BINARY;this.m_transportFamily=
this.getUseSsl()?a.TransportFamily.WSS:a.TransportFamily.WS;this.m_nextStateOnFail=new l(p);this.m_name=this.m_transportProtocol.toString();this.validateLegal=function(){a.WebSocketConnection.browserSupportsBinaryWebSockets(p)||g.switchState(this.m_nextStateOnFail,this.m_unsupportedRuntimeMessage)}}var g=this;e.prototype=new j;f.prototype=new j;l.prototype=new j;c.prototype=new j;this.getTransportProtocol=function(){return g.m_state.getTransportProtocol()};this.getTransportFamily=function(){return g.m_state.getTransportFamily()};
this.handleConnectFailed=function(p){g.m_state.handleConnectFailed(p)};this.shouldRetry=function(){return g.m_state.shouldRetry()};this.useSsl=function(){return g.m_state.getUseSsl()};this.toString=function(){return g.m_state.toString()};this.switchState=function(p){g.m_state=p;p.validateLegal()};this.validateProperties=function(){var p=(d.url||"").split("://");if(!(p.length&&o.validSchemes.indexOf(p[0])>=0))throw new a.OperationError("Invalid parameter for url: Only ["+o.validSchemes.join(", ")+
"] URL schemes are supported",a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);};var n={};n[a.TransportProtocol.HTTP_BINARY_STREAMING]=l;n[a.TransportProtocol.HTTP_BINARY]=f;n[a.TransportProtocol.HTTP_BASE64]=e;n[a.TransportProtocol.WS_BINARY]=c;this.setProtocol=function(p){var q;q=d.url.toLowerCase().indexOf("s://")>1;this.m_state=new n[p](q);this.m_state.validateLegal()};this.setProtocol(d.transportProtocol||o.defaultProtocol)}a.TransportSessionEvent=function(d,j,e,f){this.m_sessionEventCode=d;this.m_infoStr=
j;this.m_responseCde=e;this.m_sid=f};a.TransportSessionEvent.prototype.getSessionEventCode=function(){return this.m_sessionEventCode};a.TransportSessionEvent.prototype.getInfoStr=function(){return this.m_infoStr};a.TransportSessionEvent.prototype.getResponseCode=function(){return this.m_responseCde};a.TransportSessionEvent.prototype.getSessionId=function(){return this.m_sid};a.TransportSessionEvent.prototype.toString=function(){var d=new a.StringBuffer("Transport session event: ");d.append("sessionEventCode=").append(this.m_sessionEventCode).append(", ");
d.append("infoStr=").append(this.m_infoStr||"").append(", ");d.append("responseCode=").append(this.m_responseCde||"").append(", ");d.append("sid=").append(this.m_sid?a.Util.formatHexString(this.m_sid):"N/A");return d.toString()};var s={SMF_NEW:0,SMF_HEADER_READ:1,TRANSPORT_HEADER_READ:2};a.TransportClientStats=function(){this.msgWritten=this.bytesWritten=0};a.TransportSessionBase=function(d,j,e){this.m_connectTimeout=e.transportDowngradeTimeoutInMsecs;this.m_connectTimer=null;this.m_clientstats=new a.TransportClientStats;
this.m_dataCB=j;this.m_eventCB=d;this.m_state=0;this.m_sendBufferMaxSize=e.sendBufferMaxSize;this.m_maxPayloadBytes=e.maxWebPayload;this.m_queuedData=[];this.m_queuedDataSize=0;this.m_alertOnDequeue=false;var f=this;this.createConnectTimeout=function(){if(this.m_connectTimeout>0)this.m_connectTimer=setTimeout(function(){f.connectTimerExpiry()},this.m_connectTimeout)};this.cancelConnectTimeout=function(){if(this.m_connectTimer){clearTimeout(this.m_connectTimer);this.m_connectTimer=null}};this.connectTimerExpiry=
function(){};this.getClientStats=function(){return this.m_clientstats}};a.WebSocketTransportSession=function(d,j,e,f){a.TransportSessionBase.apply(this,[j,e,f]);this.m_streamInputReadState=new h;this.m_url="ws"+d.match(/(ws|http)(s?:\/\/.+)/)[2];this.m_sessionId=this.m_webSocket=null;this.m_bufferedAmountQueryIntervalInMsecs=f.bufferedAmountQueryIntervalInMsecs;this.m_bufferedAmountQueryTimer=null;this.m_bufferedAmountQueryIntervalDelayMultiplier=1;this.connectTimerExpiry=function(){this.state=5;
this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.CONNECTION_ERROR,"timeout",null))}};a.WebSocketTransportSession.prototype.onClose=function(d){this.m_state=5;this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.CONNECTION_ERROR,"Connection closed"+(d.reason?": "+d.reason:""),null))};a.WebSocketTransportSession.prototype.onConnect=function(){this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.UP_NOTICE,"Connected",null,0,this.m_sessionId))};
a.WebSocketTransportSession.prototype.onError=function(){this.m_state=5;this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.CONNECTION_ERROR,"Connection error",null))};a.WebSocketTransportSession.prototype.onData=function(d){this.cancelConnectTimeout();var j=this.m_streamInputReadState;j.enqueue(d);var e;for(d=true;d;){d=false;switch(j.PacketReadState){case s.SMF_NEW:if(e=a.smf.Codec.parseSmfAt(j.getBuffer(),j.position(),true)){j.PacketReadState=s.SMF_HEADER_READ;j.TopSmfHeader=
e;d=true}else if(a.smf.Codec.isSmfHeaderAvailable(j.getBuffer(),j.position())&&!a.smf.Codec.isSmfHeaderValid(j.getBuffer(),j.position())){this.m_state=5;this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.PARSE_FAILURE,"Error parsing incoming message - invalid SMF header detected",a.ErrorSubcode.PROTOCOL_ERROR));return}break;case s.SMF_HEADER_READ:e=j.TopSmfHeader;e=e.m_headerLength+e.m_payloadLength;var f=j.remaining();if(this.m_dataCB&&f>=e){this.m_dataCB(j.getBuffer().substr(j.position(),
e));j.advanceBuffer(e);j.PacketReadState=s.SMF_NEW;d=f>e}}}};a.WebSocketTransportSession.prototype.connect=function(){var d=this;if(this.m_state!==0)return 4;if(!this.m_url)return 5;try{this.m_webSocket=new a.WebSocketConnection(this.m_url,function(){d.onConnect()},function(f){d.onData(f)},function(f){d.onError(f)},function(f){d.onClose(f)});this.m_webSocket.binaryType="arraybuffer"}catch(j){return this.m_state=5}this.createConnectTimeout();try{this.m_webSocket.connect();this.m_state=2;return 0}catch(e){this.m_state=
5;this.cancelConnectTimeout();throw e;}};a.WebSocketTransportSession.prototype.send=function(d,j){if(this.m_state!==2)return 4;if(this.m_queuedData.length>0)return this.enqueueData(d,j);var e=this.m_maxPayloadBytes-this.getBufferedAmount();if(e<=0)return this.enqueueData(d,j);var f=null;if(d.length>e){f=d.substr(e);d=d.substr(0,e);if(!b(this,f.length))return i(this)}this.m_webSocket.send(d);this.m_clientstats.bytesWritten+=d.length;if(f)return this.enqueueData(f,true);else{this.m_clientstats.msgWritten++;
return 0}};a.WebSocketTransportSession.prototype.getBufferedAmount=function(){if(this.m_webSocket)return this.m_webSocket.getBufferedAmount()};a.WebSocketTransportSession.prototype.enqueueData=function(d,j){var e=d.length;if(j||b(this,e)){this.m_queuedDataSize+=e;this.m_queuedData.push(d)}else return i(this);this.m_bufferedAmountQueryTimer||this.scheduleQuery();return 0};a.WebSocketTransportSession.prototype.scheduleQuery=function(){if(this.m_queuedDataSize>0&&this.m_bufferedAmountQueryIntervalInMsecs>
0){this.cancelQuery();var d=this;this.m_bufferedAmountQueryTimer=setTimeout(function(){try{d.cancelQuery();d.sendQueuedData()}catch(j){}},this.m_bufferedAmountQueryIntervalInMsecs*this.m_bufferedAmountQueryIntervalDelayMultiplier)}};a.WebSocketTransportSession.prototype.cancelQuery=function(){if(this.m_bufferedAmountQueryTimer){clearTimeout(this.m_bufferedAmountQueryTimer);this.m_bufferedAmountQueryTimer=null}};a.WebSocketTransportSession.prototype.sendQueuedData=function(){if(this.m_queuedDataSize!==
0){var d=k(this);if(d.length>0){this.m_clientstats.bytesWritten+=d.length;this.m_webSocket.send(d)}this.scheduleQuery();if(this.m_alertOnDequeue&&this.m_queuedDataSize<this.m_sendBufferMaxSize){this.m_alertOnDequeue=false;this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.CAN_ACCEPT_DATA,"",0,this.m_sessionId))}}};a.WebSocketTransportSession.prototype.destroy=function(){if(this.m_state===0&&!this.m_webSocket)return 0;this.m_webSocket.destroy();if(this.m_connectTimer){clearTimeout(this.m_connectTimer);
this.m_connectTimer=null}this.cancelQuery();this.m_webSocket=null;this.m_queuedData=[];this.m_queuedDataSize=0;this.m_alertOnDequeue=false;this.m_bufferedAmountQueryIntervalDelayMultiplier=1;this.m_state=0;if(this.m_eventCB){var d=this;setTimeout(function(){d.m_eventCB&&d.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.DESTROYED_NOTICE,"Session is destroyed",0,d.m_sessionId));d.m_dataCB=null;d.m_eventCB=null},0)}return 0};a.HTTPTransportSession=function(d,j,e,f){a.TransportSessionBase.apply(this,
[j,e,f]);this.m_haveToken=true;this.m_confMaxWebPayload=f.maxWebPayload;this.m_maxPayloadBytes=0;this.m_destroyTimer=null;this.m_destroyTimeout=f.connectTimeoutInMsecs;this.m_applianceUrl=this.m_createUrl="http"+d.match(/.+?(s?:\/\/.+)/)[1];this.m_smfDataTokenTSHeader=this.m_httpReceiveConn=this.m_httpSendConn=null;this.m_routerTag="";this.m_sid=null;this.m_streamInputReadState=new h;if(f.transportProtocol===null)throw new a.OperationError("transportProtocol is null",a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);
this.m_transportProtocol=f.transportProtocol;this.m_useStreamingTransport=this.m_useBinaryTransport=false;this.m_streamingTransportPadding=0;this.m_useBinaryTransport=f.transportProtocol!==a.TransportProtocol.HTTP_BASE64;this.m_useStreamingTransport=f.transportProtocol===a.TransportProtocol.HTTP_BINARY_STREAMING;if(navigator){d=navigator.userAgent||"";if(d.match(/trident/i)||d.match(/msie/i))this.m_streamingTransportPadding=257}if(f.transportContentType===null)throw new a.OperationError("transportContentType is null",
a.ErrorSubcode.PARAMETER_OUT_OF_RANGE);this.m_contentType=f.transportContentType;this.connectTimerExpiry=function(){this.destroyCleanup(true,"Timeout during connection create",a.ErrorSubcode.INTERNAL_CONNECTION_ERROR)}};a.HTTPTransportSession.prototype.getSessionIdForLogging=function(){return" (sessionId="+(this.m_sid?a.Util.formatHexString(this.m_sid):"")+")"};a.HTTPTransportSession.prototype.updateMaxWebPayload=function(){var d=this.m_confMaxWebPayload-22;this.m_maxPayloadBytes=this.m_useBinaryTransport?
d:Math.floor(d*0.75)};a.HTTPTransportSession.prototype.connect=function(){if(this.m_state!==0)return 4;this.connectInternal();return 0};a.HTTPTransportSession.prototype.connectInternal=function(){var d=this;try{this.m_createConn=new a.HttpConnection(this.m_createUrl,!this.m_useBinaryTransport,false,function(l,c){d.handleCreateResponse(l,c)},function(l,c){d.handleCreateConnFailure(l,c)},this.m_contentType)}catch(j){return 5}if(typeof this.m_createConn==="undefined"||this.m_createConn===null)return 5;
var e=a.TsSmf.genTsCreateHeader();if(this.m_state!==1){this.createConnectTimeout();this.m_state=1;this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.CONNECTING,"Connection in progress",0,0))}try{this.m_createConn.send(e)}catch(f){this.m_state=5;this.cancelConnectTimeout();throw f;}};a.HTTPTransportSession.prototype.destroy=function(d,j,e){if(this.m_state===4||this.m_state===0)return 0;if(this.m_state===5||this.m_state===1){this.destroyCleanup(true,j,e,true);return 0}if(d||this.m_haveToken){this.m_state=
4;this.m_httpSendConn!==null&&this.m_httpSendConn.abort();this.m_httpReceiveConn!==null&&this.m_httpReceiveConn.abort();var f=this;this.m_destroyTimer=setTimeout(function(){f.destroyTimerExpiry()},this.m_destroyTimeout);this.m_httpSendConn!==null&&this.m_httpSendConn.send(a.TsSmf.genTsDestroyHeader(this.m_sid))}else this.m_state=3;return 0};a.HTTPTransportSession.prototype.send=function(d,j){if(this.m_state!==2)return 4;if(this.m_queuedData.length>0||!this.m_haveToken)return this.enqueueData(d,j);
var e=null;if(d.length>this.m_maxPayloadBytes){e=d.substr(this.m_maxPayloadBytes);d=d.substr(0,this.m_maxPayloadBytes);if(!b(this,e.length))return i(this)}this.m_haveToken=false;this.m_httpSendConn.send(this.m_smfDataTSHeaderParts[0]+a.Convert.int32ToStr(this.m_smfDataTSHeaderParts[0].length+4+this.m_smfDataTSHeaderParts[1].length+d.length)+this.m_smfDataTSHeaderParts[1]+d);this.m_clientstats.bytesWritten+=d.length;if(e)return this.enqueueData(e);else{this.m_clientstats.msgWritten++;return 0}};a.HTTPTransportSession.prototype.enqueueData=
function(d,j){var e=d.length;if(j||b(this,e)){this.m_queuedDataSize+=e;this.m_queuedData.push(d)}else return i(this);return 0};a.HTTPTransportSession.prototype.initPreformattedHeaders=function(d){this.m_smfDataTSHeaderParts=a.TsSmf.genTsDataMsgHeaderParts(d);this.m_smfDataTokenTSHeader=this.m_useStreamingTransport?a.TsSmf.genTsDataStreamTokenMsg(d,this.m_streamingTransportPadding):a.TsSmf.genTsDataTokenMsg(d)};a.HTTPTransportSession.prototype.sendQueuedData=function(){if(this.m_queuedDataSize===0)this.m_state===
3&&this.destroy(false);else{this.m_haveToken=false;var d=k(this);this.m_httpSendConn.send(this.m_smfDataTSHeaderParts[0]+a.Convert.int32ToStr(this.m_smfDataTSHeaderParts[0].length+4+this.m_smfDataTSHeaderParts[1].length+d.length)+this.m_smfDataTSHeaderParts[1]+d);this.m_clientstats.bytesWritten+=d.length;if(this.m_alertOnDequeue){this.m_alertOnDequeue=false;this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.CAN_ACCEPT_DATA,"",0,this.m_sid))}}};a.HTTPTransportSession.prototype.handleCreateResponse=
function(d,j){if(!(this.m_state===4||this.m_state===0)){this.updateMaxWebPayload();if(d!==0)d===3?this.destroyCleanup(true,"Received data decode error on create session response",a.ErrorSubcode.DATA_DECODE_ERROR):this.destroyCleanup(true,"Failed to handle create session response",a.ErrorSubcode.INTERNAL_CONNECTION_ERROR);else if(j.length!==0){var e=a.smf.Codec.decodeCompoundMessage(j,0);if(e){var f=e.getResponse();if(f.ResponseCode!==200)this.destroyCleanup(true,"Transport create request failed: response code - "+
f.ResponseCode+", "+f.ResponseCode,a.ErrorSubcode.INTERNAL_CONNECTION_ERROR);else{this.m_createConn.abort();this.m_createConn=null;this.m_state=2;this.m_sid=e.SessionId;this.m_routerTag=e.RouterTag;this.m_applianceUrl=this.m_createUrl.replace(/\?.*/,"");if(this.m_routerTag!=="")this.m_applianceUrl+=this.m_routerTag;this.initPreformattedHeaders(this.m_sid);var l=this;this.m_httpSendConn=new a.HttpConnection(this.m_applianceUrl,!this.m_useBinaryTransport,false,function(c,g){l.handleRxDataToken(c,g)},
function(c,g){l.handleConnFailure(c,g)},this.m_contentType);this.m_httpReceiveConn=new a.HttpConnection(this.m_applianceUrl,!this.m_useBinaryTransport,this.m_useStreamingTransport,function(c,g){l.handleRxData(c,g)},function(c,g){l.handleConnFailure(c,g)},this.m_contentType);this.m_httpReceiveConn.send(this.m_smfDataTokenTSHeader);this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.UP_NOTICE,f.ResponseString,0,e.SessionId))}}else this.destroyCleanup(true,"Failed to parse create response message",
a.ErrorSubcode.INTERNAL_CONNECTION_ERROR)}}};a.HTTPTransportSession.prototype.handleDestroyResponse=function(d){this.cancelDestroyTimeout();var j=d.getResponse().ResponseString||"";j+=" Handled Destroy Response addressed to session "+a.Util.formatHexString(d.SessionId)+", on session "+a.Util.formatHexString(this.m_sid);this.destroyCleanup(true,j)};a.HTTPTransportSession.prototype.handleRxData=function(d,j){if(this.m_httpReceiveConn!==null){this.cancelConnectTimeout();this.m_httpReceiveConn.recStat("GotData");
if(d!==0)return this.handleRxError(d,j);if(j.length===0){this.m_streamInputReadState.PacketReadState=s.SMF_NEW;this.m_httpReceiveConn.send(this.m_smfDataTokenTSHeader)}else{var e=this.m_streamInputReadState;e.enqueue(j);for(var f=true;f;)switch(e.PacketReadState){case s.SMF_NEW:var l=a.smf.Codec.parseSmfAt(e.getBuffer(),e.position());if(l){e.advanceBuffer(l.m_headerLength);e.TopSmfHeader=l;e.TotalPayloadToRead=l.m_payloadLength;e.PacketReadState=s.SMF_HEADER_READ}else if(a.smf.Codec.isSmfHeaderAvailable(e.getBuffer(),
e.position())&&!a.smf.Codec.isSmfHeaderValid(e.getBuffer(),e.position())){this.m_state=5;this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.PARSE_FAILURE,"Error parsing incoming message - invalid SMF header detected",a.ErrorSubcode.PROTOCOL_ERROR));return}else f=false;break;case s.SMF_HEADER_READ:if(l=a.smf.Codec.TsSmf.parseTsSmfHdrAt(e.getBuffer(),e.position(),e.TopSmfHeader)){e.advanceBuffer(l.TsHeaderLength);e.TransportMessageCurrent=l;e.TotalPayloadToRead-=l.TsHeaderLength;
e.PacketReadState=s.TRANSPORT_HEADER_READ}else f=false;break;case s.TRANSPORT_HEADER_READ:l=e.TransportMessageCurrent;switch(e.TransportMessageCurrent.MessageType){case 3:this.handleDestroyResponse(l);return;case 4:if(l.SessionId!==this.m_sid){e=(e=l.getResponse())?" ("+e.ResponseCode+" "+e.ResponseString+")":"";this.m_state=5;this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.PARSE_FAILURE,"Session ID mismatch in data message, expected: "+a.Util.formatHexString(this.m_sid)+", got: "+
a.Util.formatHexString(l.SessionId)+", "+e,a.ErrorSubcode.PROTOCOL_ERROR,this.m_sid));return}if(e.remaining()>0){l=Math.min(e.remaining(),e.TotalPayloadToRead);var c=e.getBuffer().substr(e.position(),l);e.advanceBuffer(l);e.TotalPayloadToRead-=l;this.m_dataCB(c);if(e.TotalPayloadToRead===0){e.PacketReadState=s.SMF_NEW;if(e.remaining()===0)break}}else f=false;break;default:throw new a.TransportError("Unexpected message type ("+l.MessageType+") on ReceiveData connection",0);}}}}};a.HTTPTransportSession.prototype.handleRxDataToken=
function(d,j){if(d!==0)return this.handleRxError(d,j);if(j.length!==0){var e=a.smf.Codec.decodeCompoundMessage(j,0);if(e)if(e.MessageType===3)this.handleDestroyResponse(e);else if(e.SessionId!==this.m_sid){var f=e.getResponse();f=f?" ("+f.ResponseCode+" "+f.ResponseString+")":"";if(this.m_state!==4){this.m_state=5;this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.PARSE_FAILURE,"Session ID mismatch in response message, expected: "+a.Util.formatHexString(this.m_sid)+", got: "+a.Util.formatHexString(e.SessionId)+
", "+f,a.ErrorSubcode.PROTOCOL_ERROR,this.m_sid))}else this.destroyCleanup(true,"Session ID mismatch in response message",a.ErrorSubcode.PROTOCOL_ERROR)}else if(e.MessageType===5||e.MessageType===6){this.m_haveToken=true;this.m_httpSendConn.recStat("GotToken");this.sendQueuedData()}else throw new a.TransportError("Unexpected message type ("+e.MessageType+") on SendData connection",0);else if(this.m_state!==4){this.m_state=5;this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.PARSE_FAILURE,
"Failed to parse received data message",a.ErrorSubcode.PROTOCOL_ERROR,this.m_sid))}else this.destroyCleanup(true)}};a.HTTPTransportSession.prototype.handleRxError=function(d){this.m_state=5;d===3?this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.DATA_DECODE_ERROR,"Received data decode error",a.ErrorSubcode.DATA_DECODE_ERROR,this.m_sid)):this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.CONNECTION_ERROR,"Connection error",a.ErrorSubcode.INTERNAL_CONNECTION_ERROR,
this.m_sid))};a.HTTPTransportSession.prototype.handleConnFailure=function(d,j){if(this.m_state===2){this.m_state=5;this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.CONNECTION_ERROR,"Connection error: "+j,a.ErrorSubcode.INTERNAL_CONNECTION_ERROR,this.m_sid))}else this.destroyCleanup(true,"Connection error: "+j,a.ErrorSubcode.INTERNAL_CONNECTION_ERROR)};a.HTTPTransportSession.prototype.handleCreateConnFailure=function(d,j){this.m_state!==0&&this.destroyCleanup(true,"Connection create failure: "+
j,a.ErrorSubcode.INTERNAL_CONNECTION_ERROR)};a.HTTPTransportSession.prototype.destroyTimerExpiry=function(){this.destroyCleanup(true,"Destroy request timeout")};a.HTTPTransportSession.prototype.cancelDestroyTimeout=function(){if(this.m_destroyTimer){clearTimeout(this.m_destroyTimer);this.m_destroyTimer=null}};a.HTTPTransportSession.prototype.destroyCleanup=function(d,j,e,f){this.m_state=4;this.m_createConn&&this.m_createConn.abort();this.m_httpSendConn&&this.m_httpSendConn.abort();this.m_httpReceiveConn&&
this.m_httpReceiveConn.abort();this.m_smfDataTokenTSHeader=this.m_httpReceiveConn=this.m_httpSendConn=this.m_createConn=this.m_applianceUrl=this.m_createUrl=null;this.m_routerTag="";this.m_queuedData=[];this.m_queuedDataSize=0;this.m_alertOnDequeue=false;this.cancelDestroyTimeout();this.cancelConnectTimeout();this.m_state=0;if(f){var l=this;setTimeout(function(){if(d){if(typeof e==="undefined")e=0;if(l.m_eventCB)l.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.DESTROYED_NOTICE,
typeof j==="undefined"||j===null||j===""?"Session is destroyed":j,e,l.m_sid))}l.m_dataCB=null;l.m_eventCB=null},0)}else{if(d){if(typeof e==="undefined")e=0;if(this.m_eventCB)this.m_eventCB(new a.TransportSessionEvent(a.TransportSessionEventCode.DESTROYED_NOTICE,typeof j==="undefined"||j===null||j===""?"Session is destroyed":j,e,this.m_sid))}this.m_eventCB=this.m_dataCB=null}};a.HTTPTransportSession.prototype.getInfoStr=function(){return"HttpTransportSession; sid="+a.Util.formatHexString(this.m_sid)+
"; routerTag="+this.m_routerTag};m.prototype={handleTransportEvent:function(d){this.m_rxTransportEventCB&&this.m_rxTransportEventCB(d)},rxDataCB:function(d){this.m_session&&this.m_session.resetKeepAliveCounter();if(this.m_incomingBuffer.length===0)this.m_incomingBuffer=d;else{this.m_incomingBuffer+=d;if(this.m_incomingBuffer.length>8E7){this.m_rxMessageErrorCB("Buffer overflow (length: "+this.m_incomingBuffer.length+")");this.m_incomingBuffer=""}}for(d=0;d<this.m_incomingBuffer.length&&a.smf.Codec.isSmfAvailable(this.m_incomingBuffer,
d);){var j=a.smf.Codec.decodeCompoundMessage(this.m_incomingBuffer,d);if(j&&j.getSmfHeader()){d+=j.getSmfHeader().m_messageLength;this.m_rxSmfCB(j)}else{this.m_incomingBuffer="";this.m_rxMessageErrorCB("Error parsing incoming SMF at position "+d);return}}if(d<this.m_incomingBuffer.length)if(a.smf.Codec.isSmfHeaderAvailable(this.m_incomingBuffer,d)&&!a.smf.Codec.isSmfHeaderValid(this.m_incomingBuffer,d)){this.m_incomingBuffer="";this.m_rxMessageErrorCB("Error parsing incoming SMF at position "+d+" - invalid SMF header detected")}else{j=
this.m_incomingBuffer;this.m_incomingBuffer=j.substr(d,j.length-d)}else this.m_incomingBuffer=""},connect:function(){return this.m_transportSession.connect()},cancelConnectTimeout:function(){this.m_transportSession.cancelConnectTimeout()},destroy:function(d,j,e){return this.m_transportSession.destroy(d,j,e)},send:function(d,j){return this.m_transportSession.send(a.smf.Codec.encodeCompoundMessage(d),j)},getTransportSession:function(){return this.m_transportSession},getClientStats:function(){return this.m_transportSession.getClientStats()},
getTransportSessionInfoStr:function(){return this.m_transportSession.getInfoStr()},nextCorrelationTag:function(){return++this.m_correlationCounter}};a.SMFClient=m;o.defaultProtocol=a.TransportProtocol.WS_BINARY;o.validSchemes=["http","https","ws","wss"];a.TransportProtocolHandler=o})(solace);
(function(a){function h(b,i,k,m,o){this.url=b;this.socket=null;this.rxDataCb=k;this.connectionErrorCb=m;this.onCloseCB=o;this.onConnectCB=i}h.prototype.onOpen=function(){this.connCTS=true;this.onConnectCB()};h.prototype.onMessage=function(b){this.rxDataCb(this.arrayBufferToString(b.data))};h.prototype.onClose=function(b){this.onCloseCB(b)};h.prototype.onError=function(b){this.connectionErrorCb(b)};h.prototype.connect=function(){this.socket&&this.connectionErrorCb("Socket already connected");var b=
this;try{this.socket=new WebSocket(this.url,"smf.solacesystems.com");this.socket.binaryType="arraybuffer";this.socket.onopen=function(k){b.onOpen(k)};this.socket.onmessage=function(k){b.onMessage(k)};this.socket.onclose=function(k){b.onClose(k)};this.socket.onerror=function(k){b.onError(k)}}catch(i){throw new a.TransportError("Could not create WebSocket: "+i.message,a.ErrorSubcode.CREATE_WEBSOCKET_FAILED);}};h.prototype.send=function(b){this.socket&&this.socket.send(this.stringToArrayBuffer(b))};
h.prototype.destroy=function(){if(this.socket){this.socket.close();this.socket.onopen=null;this.socket.onmessage=null;this.socket.onclose=null;this.socket=this.socket.onerror=null}this.onConnectCB=this.onCloseCB=this.connectionErrorCb=this.rxDataCb=null};h.prototype.getBufferedAmount=function(){if(this.socket)return this.socket.bufferedAmount;return 0};h.prototype.arrayBufferToString=function(b){var i=b.byteLength;b=new Uint8Array(b);if(i<32768)return String.fromCharCode.apply(null,b);else{for(var k=
0,m="";k<i;){m+=String.fromCharCode.apply(null,b.subarray(k,k+32768));k+=32768}return m}};h.prototype.stringToArrayBuffer=function(b){for(var i=new Uint8Array(new ArrayBuffer(b.length)),k=0;k<b.length;k++)i[k]=b.charCodeAt(k);return i.buffer};h.browserSupportsBinaryWebSockets=function(b){if(typeof WebSocket==="undefined"||typeof ArrayBuffer==="undefined"||typeof Uint8Array==="undefined")return false;return"binaryType"in WebSocket.prototype?true:!!(window.WebSocket&&(new WebSocket(b?"wss://.":"ws://.")).binaryType)};
a.WebSocketConnection=h})(solace);